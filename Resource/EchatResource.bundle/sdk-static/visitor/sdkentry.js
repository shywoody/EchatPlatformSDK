!function(e){function t(t){for(var a,o,r=t[0],l=t[1],c=t[2],d=0,f=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&f.push(i[o][0]),i[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(t);f.length;)f.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,o=1;o<n.length;o++){var l=n[o];0!==i[l]&&(a=!1)}a&&(s.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},o={3:0},i={3:0},s=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.e=function(e){var t=[];o[e]?t.push(o[e]):0!==o[e]&&{1:1}[e]&&t.push(o[e]=new Promise((function(t,n){for(var a=({1:"emoji"}[e]||e)+".css",i=r.p+a,s=document.getElementsByTagName("link"),l=0;l<s.length;l++){var c=(u=s[l]).getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(c===a||c===i))return t()}var d=document.getElementsByTagName("style");for(l=0;l<d.length;l++){var u;if((c=(u=d[l]).getAttribute("data-href"))===a||c===i)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var a=t&&t.target&&t.target.src||i,s=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=a,delete o[e],f.parentNode.removeChild(f),n(s)},f.href=i,document.getElementsByTagName("head")[0].appendChild(f)})).then((function(){o[e]=0})));var n=i[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,a){n=i[e]=[t,a]}));t.push(n[2]=a);var s,l=document.createElement("script");l.charset="utf-8",l.timeout=120,r.nc&&l.setAttribute("nonce",r.nc),l.src=function(e){return r.p+""+({1:"emoji"}[e]||e)+".chunk.js"}(e);var c=new Error;s=function(t){l.onerror=l.onload=null,clearTimeout(d);var n=i[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",c.name="ChunkLoadError",c.type=a,c.request=o,n[1](c)}i[e]=void 0}};var d=setTimeout((function(){s({type:"timeout",target:l})}),12e4);l.onerror=l.onload=s,document.head.appendChild(l)}return Promise.all(t)},r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="../",r.oe=function(e){throw console.error(e),e};var l=window.webpackJsonp=window.webpackJsonp||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var u=c;s.push([172,0,4]),n()}({118:function(e,t,n){"use strict";n(38),n(26),n(42),n(18),n(50),n(27),n(51),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(3),n(9);var a=c(n(4)),o=c(n(32)),i=c(n(6)),s=c(n(13)),r=c(n(52)),l=["sendStatus"];function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function p(e,t,n){var c=(new Date).getTime(),d=e.sendStatus==o.default.sendStatus.error,u=e.id||"msg"+c;if(e.id=u,e.tm=e.tm||c,e.data.bridgeMsgId||(e.bridgeMsgId=e.data.bridgeMsgId=i.default.getNextBridgeMsgId()),e.data.isResend=d?1:0,e.sendStatus=e.data.sendStatus=o.default.sendStatus.sending,e.hide||(d&&function(e){var t,n=_$(s.default.getMsgDomId(e));i.default.updateMsgList(e,"remove"),(t=n.previousElementSibling)&&t.childNodes[0]&&-1!=(t.childNodes[0].className+"").indexOf("color1")&&$(t).remove(),$(n).remove()}(e),i.default.updateMsgList(e,"push"),r.default.showMsg($.extend(e,e.data))),!t){var p=e.data,h=(p.sendStatus,f(p,l));a.default.publish("sendMessage",h,(function(t,a){var s;if(t.successful){if(s=i.default.getStatusByKey("lasMid"),e.sendStatus=e.data.sendStatus=o.default.sendStatus.success,e.mid=t.mid,s<e.mid&&i.default.setStatusByKey("lasMid",e.mid),!e.hide&&r.default.updateMsg(e,(function(t){e.mid&&$(t).attr("id",e.mid),$(".msg-error",t).remove(),$("img",t).each((function(){$(this).attr("src",$(this).attr("src"))}))})),n)try{n()}catch(e){}e=null}else e.sendStatus=e.data.sendStatus=o.default.sendStatus.error,!e.hide&&r.default.updateMsg(e),a&&a()}))}}var h=function(e,t,n){e&&!e.data&&(e.data=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e));var i=t||e.data.content,s=i&&i.replace(o.default.regEmo,"[face]");t&&(e.data.img=1,e.data.content=t),e.filterMsg&&i&&!e.localMsg?(e.localMsg=i,e.data.content=i+"过滤后的消息"):p(e,t,!1),!i||105!=e.data.et&&130!=e.data.et||a.default.publish("__visitorSendMsg",s),105==e.data.et&&a.default.publish("_addSendMsgNum",e)};t.default=h},119:function(e,t,n){},120:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(10),n(43),n(3),n(9),n(28),n(20);var a=r(n(44)),o=r(n(4)),i=r(n(6)),s=n(13);function r(e){return e&&e.__esModule?e:{default:e}}n(119);var l,c,d,u,f,p,h,m,g,v,y=a.default.callEchatNative,b=0;v=function(){var e=0;function t(){e&&clearTimeout(e),e=null,g().showNum<=0?$("#chatText").addClass("enter-show"):$("#chatText").removeClass("enter-show")}return function(){e&&clearTimeout(e),e=setTimeout(t,60)}}(),o.default.subscribe("triggerFile",(function(e,t){console.log("triggerFile",t);var n,a,o=2;if("record"==t?o=4:"gallery"==t?o=2:"voice"==t&&(o=3),n=document.getElementById("uploadInput"),$(n).attr("filetype",o),document.createEvent)try{(a=document.createEvent("mouseEvent")).initEvent("click",!0,!0),n.dispatchEvent(a)}catch(e){n.click(),console.log(e)}else n.click()})),o.default.subscribe("setUrlList",(function(e,t){var n,a,s=i.default.getStatusConfig(),r=s.sdkUrlList||s.phoneUrlList,l="",d="",u=['<li class="dot-list-li hover">0</li>'],f=_$("url_dot_list"),m=$(".tool-menu-item").length,g=0;if("string"==typeof r&&(r=JSON.parse(r)),$(".list-url-item").remove(),$(".url-list-pagemore").remove(),!r||0==r.length)return p&&p(0),void i.default.setConfig("urlListConfig",new Array(m));for(r=new Array(m).concat(r),i.default.setConfig("urlListConfig",r),a=m;a<r.length;a++)o.default.needHttps&&(r[a].url=r[a].url.replace(/^http:/i,o.default.needHttps),r[a].icon=r[a].icon.replace(/^http:/i,o.default.needHttps)),d='<li class="list-url-item" data-index="'+a+'"><div class="list-url-img"><div class="menu-item-icon border0"><img src="'+r[a].icon+'" class="list-url-icon" /></div></div><div class="list-url-title">'+r[a].title+"</div></li>",7==a?($("#urlListPage1").append(l+d),l=""):a>7&&(a+1)%8==0?l+=d+"</ul>":a%8==0?(l+='<ul class="clearfix url-list-page flex1 url-list-pagemore">'+d,g++,u.push("<li class='dot-list-li'>"+g+"</li>")):l+=d;$("#urlListWrap").css({width:100*(g+1)+"%",transform:"translate(0px, 0px)"}).attr("x2","0").attr("x2","0"),a<8?$("#urlListPage1").append(l):a>8&&(l+="</ul></div>",$("#urlListWrap").append(l)),!h||g>0?(b=0,n=function(){b<0&&(b=0),$($(".dot-list-li",f).removeClass("hover").results[b]).addClass("hover")},p=function(e){$("#urlListWrap").css({transform:"translate(-"+window.innerWidth*e+"px, 0px)"}).attr("x2","0").attr("x","-"+window.innerWidth*e),b=e,n()},h=function(e){0!=e&&((b+=e)>g&&(b=g),n())},0==g?$(f).hide():($(f).html(u.join("")).show(),o.default.pageSlide("#urlListWrap",h))):($(f).hide(),p&&p(0)),v(),c()})),o.default.subscribe("setCustomList",(function(e,t){var n,a,r=i.default.getStatusConfig().customUrlList,l=null,c=$("#urlSetList"),d=$("#urlSetListBox"),u=document.createElement("div");if(c.hide(),d.results&&d.results[0].children.length&&(d.html(""),o.default.publish("changeDom",{name:"#urlSetList",cls:"hide"})),"string"==typeof r&&(r=JSON.parse(r)),r&&0!=r.length){if(a=r.length,0!=o.default.queryParams.businessUrl&&a){for(c.show(),o.default.publish("changeDom",{name:"#urlSetList",removeCls:"hide"}),n=0;n<a;n+=1)u.innerHTML='<span class="uslSetSpan">{title}</span>'.replace("{title}",r[n].title),(l=u.children[0]).onclick=f(n),d.append(l);!function(){if(!I)return;I=!0;var e=$("#urlSetList"),t=$("#urlSetListBox"),n={minLeft:e.width()-t.width()-12,in:!1,left0:0,x0:0,x1:0};function a(e){e=e.touches&&e.touches[0]||e,n.in=!0,n.x0=e.clientX;var t=window.getComputedStyle(_$("urlSetListBox"));n.left0=parseInt(t.getPropertyValue("left"))||0,$(document).on("touchmove",o),$(document).on("touchend",i),$("#urlSetListBox").addClass("transition-none")}function o(e){if(n.in){e=e.touches&&e.touches[0]||e,n.x1=e.clientX;var t=n.left0+n.x1-n.x0;t<n.minLeft?t=n.minLeft:t>12&&(t=12),t==n.minLeft?($(".left-reg").show(),$(".right-reg").hide()):12==t&&($(".left-reg").hide(),$(".right-reg").show()),_$("urlSetListBox").style.left=t+"px"}}function i(){n.in=!1,e.ontouchstart=null,$(document).off("touchmove",o),$(document).off("touchend",i),$("#urlSetListBox").removeClass("transition-none")}function s(e){var t=$("#urlSetListBox").results[0],n=2*$("#chat").width()/3,a=t.offsetLeft,o=$("#urlSetListBox"),i=$("#urlSetList").width()-24,s=-(o.width()-i-12);switch(e){case"left":$(".right-reg").show(),(r=a+n)>=12?(o.css("left","12px"),$(".left-reg").hide()):o.css("left",r+"px");break;case"right":var r;$(".left-reg").show(),(r=a-n)<=s?($(".right-reg").hide(),o.css("left",s+"px")):o.css("left",r+"px")}}$("#urlSetList").on("touchstart",".left-reg",(function(){s("left")})).on("touchstart",".right-reg",(function(){s("right")})),t.width()>e.width()-24?($(".right-reg").show(),$(e).off("touchstart"),$(e).on("touchstart",a)):$(e).off("touchstart",a)}()}}else i.default.setConfig("customListConfig",[]);function f(e){return function(t){var n=r[e];if(2==n.type)return 2!=i.default.getStatusByKey("chatStatus")?void o.default.showTip(lanRes.visitor172):void(n.msgContent&&o.default.triggerEventOnPoint("_sendMsg",n.msgContent));var a=(0,s.getADURL)(!0,n.openWindowParamList,n.url,1==n.appendType);o.default.publish("showURLLink",n.title,a,{openType:1==n.openType?"default":"half"})}}}));var I=!0;f=function(e){function t(e,t){y(e,t),c()}function n(e){var n=i.default.getVisitorInfo();t("uploadMedia",{visitorId:n.visitorId,companyId:n.companyId,type:e,maxNum:9})}u=e,$(".tool-menu-item").addClass("hide"),$(".menu-emo").addClass("hide"),$(".url-list-item").addClass("hide"),$("#menu_emotion").on("touchend",(function(e){return d(e,"emotion",this)})),$("#menu_more").on("touchend",(function(e){return d(e,"urlList",this)})),$(".menu-satisfy").on("click",(function(){o.default.publish("showSatisfy",3)})),$(".menu-file").on("click",(function(){n("gallery")})),$(".menu-camera").on("click",(function(){n("camera")})),$(".menu-map").on("click",(function(){t("map")})),1!=o.default.getQueryString("isMapExist")&&$(".menu-map").addClass("style-tool-hide")},d=function(e,t,n){return u.inputFocus?(setTimeout((function(){l(t)}),550),u.inputBlur()):$(n).hasClass("open")?c():l(t),e&&e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1},l=function(e){m&&clearTimeout(m);var t,n,a,i=$("#"+e);"emotion"==e?(t=206,a="urlList",$("#chatText").removeClass("recording")):"urlList"==e&&(t=g().height,a="emotion"),n=$("#"+(a||"")),$("#chat").off("click",c),setTimeout((function(){$("#chat").on("click",c)}),20),$("#footer").css("bottom",t+"px"),o.default.publish("changeDom",{name:"#footer",bottom:t,scrollTime:550}),"urlList"==e?($(".menu-more").addClass("open"),$(".menu-more-i").addClass("color0"),$(".menu-emo").removeClass("open").removeClass("color0")):($(".menu-more").removeClass("open"),$(".menu-more-i").removeClass("color0"),$(".menu-emo").addClass("open").addClass("color0")),i.removeClass("ani-hide"),n.addClass("ani-hide"),setTimeout((function(){i.removeClass("hide")})),m=setTimeout((function(){n.addClass("hide").removeClass("ani-hide")}),200)},g=function(){var e,t,n,a,o,s,r,l=0,c=0,d=i.default.getConfig("urlListConfig").length,u=$(".tool-menu-item"),f=$(".list-url-item").length;return $(".url-list-page").each((function(e,t){$(t).hasClass("hide")||c++})),u.each((function(e,t){t.className.match(/hide/g)&&l++})),u=u.results.concat($(".list-url-item").results),t=d-l,e=u.length-8-l,s=$(".url-list-page"),r=s.results.length,e<0&&f?(e=0-e,s.each((function(t,n){var a,o;if(t>0&&(a=$(".list-url-item",n).results).length)for(o=0;o<e;o++)a[o]&&s.results[t-1].appendChild(a[o])}))):e>0&&s.each((function(t,n){var a,o,i;if(t<r-1)for($(s.results[t+1]).removeClass("hide"),a=$(".list-url-item",n).results,o=$(".list-url-item",s.results[t+1]).results[0],i=0;i<e;i++)o?a[a.length-1-i]&&s.results[t+1].insertBefore(a[a.length-1-i],null):a[a.length-1-i]&&s.results[t+1].appendChild(a[a.length-1-i])})),t<1?o=0:t<5?o=114:t&&(o=232),$("#urlList").css({height:o+"px",bottom:-o+"px"}),n=parseInt(d/8)+(d%8>0?1:0),a=parseInt(t/8)+(t%8>0?1:0),c==a&&n==a||($("#urlListWrap").css({width:100*a+"%",transform:"translate(0px, 0px)"}).attr("x","").attr("x2",""),$(".url-list-page").removeClass("hide").each((function(e,t){e+1>a?$(t).addClass("hide"):$(t).removeClass("hide")})),1==a?$("#url_dot_list").hide():$("#url_dot_list").show(),$(".dot-list-li",_$("url_dot_list")).removeClass("hide").removeClass("hover").each((function(e,t){e+1>a?$(t).addClass("hide"):$(t).removeClass("hide")}))),{height:o,hideNum:l,pageNum:a,showNum:t}};var k={init:f,checkMenuNums:v,hideMenus:c=function(e,t){var n=window.getComputedStyle(_$("footer"));if(parseInt(n.getPropertyValue("bottom")||0)){var a,i,s;if(m&&clearTimeout(m),!t&&e&&(a=e&&e.target?e.target:window.event?window.event.srcElement:null))for(i=[_$("menu_emotion"),_$("emotion"),_$("menu_more"),_$("urlList")],s=0;s<i.length;s++)if(a==i[s]||$.fn.contains(i[s],a))return;$("#chat").off("click",c),u.inputFocus&&(console.log('$("#footer").addClass("transition-none");'),$("#footer").addClass("transition-none"),$("#footer").css("bottom","0px")),setTimeout((function(){$("#footer").css("bottom","0px"),$("#footer").removeClass("transition-none"),o.default.publish("changeDom",{name:"#footer",bottom:0,scrollTime:550})}),100),$("#emotion").hasClass("hide")?$("#emotion").addClass("ani-hide"):$("#urlList").hasClass("hide")&&$("#urlList").addClass("ani-hide"),m=setTimeout((function(){$("#emotion").addClass("hide").removeClass("ani-hide"),$("#urlList").removeClass("ani-hide")}),500),$(".menu-more").removeClass("open"),$(".menu-more-i").removeClass("color0"),$(".menu-emo").removeClass("open").removeClass("color0")}}};t.default=k},13:function(e,t,n){"use strict";n(38),n(26),n(42),n(18),n(50),n(27),n(51),Object.defineProperty(t,"__esModule",{value:!0}),t.addEchatInnerFrameParam=function(e){if(!e)return"";if(-1!=e.indexOf("&echatInnerFrame=1")||-1!=e.indexOf("?echatInnerFrame=1"))return e;var t=e.split("#"),n=t[1]||"",a=t[0],o=-1==a.indexOf("?")?0:1;return a+(o?"&":"?")+"echatInnerFrame=1"+(n?"#":"")+n},t.addFixedParam=function(e){if(!e||!o.default.getConfig("echatSourceTagEnable")||e.match(/^(mailto|tel|javascript):/i))return e||"";var t,n=new RegExp("(^|&)echatSourceTag=([^&]*)(&|$)","i"),i=h(e,"?"),s="echatSourceTag="+encodeURIComponent((r=c(),l=o.default.getStaff(),a.default.addMapParams({staffId:l.staffId,staffName:l.name,media:r.media||6,companyId:r.companyId,talkId:r.talkId,echatTag:r.echatTag,visitorId:r.visitorId,country:r.country,province:r.province,keyword:r.keyword})||""));var r,l;if(t=h(i[1]||i[0],"#"),t[0].match(n))return e;e=i.length>1?i[0]+"?"+t[0]+"&"+s+(t.length>1?"#"+t[1]:""):t[0]+"?"+s+(t.length>1?"#"+t[1]:"");return e},t.checkHistory=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];a.default.unSubscribe("checkHistory",e);var n,i,s,r,l,c=t.concat(o.default.getMsgList()),d=o.default.getStatusData(),u=d.talkId,f={105:1,864:1,865:1,866:1,127:1},p=0;for(l=c.length-1;l>=0;l--)if(i=c[l].data,r=i.talkId,s=parseInt(i.mt||i.et),r||f[s]&&p++,r==u)673!=s||0!=i.isForward||n||(n=i);else if(r)break;return o.default.setStatusByKey("sendMsgNum",p),a.default.publish("initEvaluate",i),{noLimit:o.default.getEvaluateAndLimit().limit<=p,last673:n}},t.default=void 0,t.getADURL=m,t.getMsgByDom=function(e){var t=$(e).parents(".msgli").attr("id"),n=t&&o.default.getMsgFromHistory(t);if(!n)return void console.log("出错 没有找消息");return n.msg},t.getMsgDomId=p,t.getParamChat=c,t.handOpenWs=u,t.handleNetwork=f,t.hasConnect=d,t.networkStatusChange=function(e){if(o.default.getDataByName("netConnected")==e)return;o.default.setDataByName("netConnected",e),a.default.publish("changeNetStatus",e)},t.plainTextToSendMsg=function(e){var t={"<":"&lt;",">":"&gt;",'"':"&quot;"};return e.replace(/\[#([^#]+)#\]/g,(function(e,t){return"[#"+(o.default.getDataByName("emoLanToCode")[t]||t)+"#]"})).replace(/[<">]/g,(function(e){return t[e]}))},t.throttle=function(e,t){var n,a=Date.now();return function o(){var i=this,s=arguments,r=Date.now();n&&clearTimeout(n),r-a>=t?(e.apply(i,s),a=Date.now()):n=setTimeout(o,t)}},n(3),n(31),n(24),n(20),n(45),n(47),n(49),n(37),n(9),n(10),n(43);var a=i(n(4)),o=i(n(6));function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(){return r(r({},o.default.getVisitorInfo()),o.default.getStatusData())}function d(){var e=o.default.getDataByName("websocketStatus");return e==a.default.Constants.websocketConnected||e==a.default.Constants.websocketConnecting}function u(e){if(e&&!(e>3)){var t=o.default.getStatusByKey("chatStatus"),n=o.default.getDataByName("netConnected"),i=d();n&&!i&&(2==t&&(1==e||2==e)||0==t&&3==e)&&a.default.publish("__openWebsocket")}}function f(e){var t=o.default.getDataByName("netConnected"),n=d();return!t&&!n&&(e&&t&&!n&&u(e),t?n?void 0:(a.default.showDialog({tip:"当前无正常连接，待产品确认流程，才能发消息"}),!0):(a.default.showTip("网络已断开,请检查网络后重试"),!0))}function p(e){return e.clientFileId||e.bridgeMsgId||e.id||e.mid}function h(e,t){var n=e,a=[],o=n.indexOf(t);return o>=0?(a[0]=n.substring(0,o),n.substring(o+1)&&(a[1]=n.substring(o+1))):a[0]=n,a}function m(e,t,n,o){if(!n)return"";if(!e||"0"==e||!t)return n;var i,s,r,l,d,u="",f="",p="",h=n.split("#"),m=h[1]||"",g=h[0],v=-1==g.indexOf("?")?0:1,y=c(),b=a.default.Constants.ADParams,I=0,k="?";if("string"==typeof t&&(t=JSON.parse(t)),a.default.isArray(t)&&t.length){for(i=t.length,r=0;r<b.length&&("staffId"==(l=b[r])&&(f=u,u="",o&&(k="",v=m?1:0)),"staffId"!=l||y.staffId);r++)for(s=0;s<i;s++)if("metaData"!=(d=t[s].paramName)&&"metadata"!=d||(d="metaData"),d==l){"metaData"==d?(I=1,u+=(0!=v?"&":k)+d+"="+encodeURIComponent(y[d]||""),u+=(0!=++v?"&":k)+(d="myData")+"="+encodeURIComponent(y[d]||""),v++,y[d="info"]&&(u+=(0!=v?"&":k)+d+"="+encodeURIComponent(y[d]||""),v++)):"myData"==d?I||(u+=(0!=v?"&":k)+d+"="+encodeURIComponent(y[d]||""),v++):"staffId"==d?(u+=(0!=v?"&":k)+d+"="+("-1"==encodeURIComponent(y[d]||"")?"":encodeURIComponent(y[d]||"")),v++):(u+=(0!=v?"&":k)+d+"="+encodeURIComponent(y[d]||""),v++);break}b.length==r&&(p=u,u="")}return o?g+f+(m?"#"+m+p:"#"+p):g+f+p+(m?"#"+m:"")}var g={handleNetwork:f,getMsgDomId:p,getADURL:m};t.default=g},154:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(10),n(3),n(9),n(207);var a=s(n(208)),o=s(n(6)),i=s(n(4));function s(e){return e&&e.__esModule?e:{default:e}}var r,l,c="textInput",d=window.innerHeight;function u(e){var t=_$("fakeInput"),n=_$(c),a=_$(c).clientHeight,o=t.clientHeight;parseInt(n.style.height)>90&&o>92||(o>92?o=93:o<33&&(o=33),n.style.height=o+"px",n.setAttribute("height",o),n.style.width="auto",n=t=null,(a-o>3||a-o<-3)&&i.default.publish("changeDom",{name:"#footer"}))}r=new function(){var e=this;a.default.call(this);var t=this,n=this.textInputChange;t.SENDCTRL=!1,t.plainText=!0,t.editorType=1,t.isMobile=!0,t.textRange=null,t.inputFocus=!1,this.init=function(a){e.Menu=a,t.bindPlainTextEvent(),$("#"+c).on("propertychange change input paste drop",(function(e){setTimeout(n,20)})),$("#enter_btn").on("touchend",(function(e){t.sendMsg({from:"enter"})}))},this.setInput=function(e){e&&(e=e.replace(/<img[^>]+code="([^"]+)"[^>]*>/gi,"[#$1#]").replace(/<(?!br|\/br)(?:.|\s)*?>/gi,"").replace(/&nbsp;/gi," ").replace(/^((<\/?br\/?>)|[\r\n\s]+)+|((<\/?br\/?>)|[\r\n\s]+)+$/gi,""),$("#"+c).val(e))},this.getInput=function(e){var n=$("#"+c).val();return n?(e&&$("#"+c).val(""),t.filterPasteData(n,!0)):(n.length>5e3&&(n=n.substring(0,5e3)),n)},this.inputBlur=function(e,n){n&&_$("sa_advise").blur(),!0!==t.inputFocus||e&&e.target&&"textInput"==e.target.id||(_$("textInput").blur(),setTimeout((function(){_$("textInput").blur(),window.scrollTo(0,0)}),10),window.blur())},this.bindPlainTextEvent=function(e){$("#"+c).off("keydown").on("keydown",(function(e){var a,o,i,s,r,l=e||window.event,d=l.keyCode||l.which||l.charCode||0;if(13==d&&void 0!==t.SENDCTRL&&t.SENDCTRL==!!l.ctrlKey)return t.sendMsg({from:"input"}),l.preventDefault&&l.preventDefault(),!1;8==d&&(o=(a=_$(c)).value,a.createTextRange?console.log("手机端IE?"):(i=a.selectionStart,s=-1,r=0,i>0&&o.replace(/\[#([^#]+)#\]/g,(function(e,t,n,a){return n<i&&n+e.length>=i&&(s=n,r=n+e.length),e})),-1!=s&&a.setSelectionRange(s,r))),t.getPos(),setTimeout(n,50)})).on("change input",(function(){t.getPos()})).on("paste",(function(e){return t.filterPasteText(e,void 0,window,document)})).on("drop",t.getPos).on("focus",t.getPos),setTimeout((function(){_$(c)&&_$(c).scrollIntoView()}),400),t.textRange=null},this.getPos=function(e){var n,a,o=_$(c);if(window.getSelection){a=window.getSelection();try{n=a.getRangeAt(0)}catch(e){(n=document.createRange()).selectNodeContents(o),n.collapse(!0)}}else n=document.selection.createRange();return t.textRange=n,n},this.insertImg=function(e){var t=o.default.getDataByName("emoCodeTolan"),a=_$(c),i=!1,s="[#"+t[e]+"#]";a.selectionStart&&a.selectionEnd?(a.setRangeText(s,a.selectionStart,a.selectionEnd,"end"),a.selectionEnd==a.value.length&&(i=!0)):(a.value+=s,a.innerHTML+=s,i=!0),i&&setTimeout((function(e){var t=_$(c);t.scrollTop=t.scrollHeight,t.scrollTo(0,t.scrollHeight),a=null})),n({from:"insertImg"}),a=null}},i.default.subscribe("textInputChangeEvt",(function(){var e=_$(c),t=_$("fakeInput"),n=e.value;t.innerText=n||" ",setTimeout(u,10),function(e){e=e||_$(c);var t=$("#menu_more"),n=$("#enter_btn");e.value?(n.removeClass("hide"),t.addClass("hide")):(n.addClass("hide"),t.removeClass("hide"))}(e)})),i.default.subscribe("keyboardHeight",(function(e,t){var n,a,o=window.innerHeight+t-d;t,r.inputFocus&&(o<3&&o>-3||window.innerHeight==_$("footer").getBoundingClientRect().bottom?window.scrollTo(0,d):(l&&clearTimeout(l),l=setTimeout((function(){l=null;var e=_$("footer").getBoundingClientRect().bottom;if(window.innerHeight==e)return console.log(d,t,window.innerHeight,"**innerHeight change"),void window.scrollTo(0,d);n=parseInt(window.getComputedStyle(_$("footer")).getPropertyValue("margin-bottom"))||0,((a=t-d+e+n)<3&&a>-3||window.innerHeight==e)&&(a=0),console.log(d,e,t,n,"**500ms**",window.innerHeight,a),r.inputFocus&&(_$("footer").style.marginBottom=a+"px"),i.default.publish("changeDom",{name:"#footer",bottom:0})}),600)))})),i.default.subscribe("inputBlur",(function(e,t){r.inputBlur()}));var f=r;t.default=f},155:function(e,t,n){},156:function(e,t,n){},157:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElementByFieldType=function(e,t,n,o){var i,s,r=a.default.Constants.validRule,l="",c={type1:'<input autocomplete="off" type="text" class="entry2-input {{req}}" maxlength="{{length}}" placeholder="{{wordDesc}}" lb="{{configDesc}}" name="{{configName}}" value="{{value}}"/>',type6b:'<input type="date" class="entry2-input {{req}}" placeholder="{{wordDesc}}" lb="{{configDesc}}" name="{{configName}}" value="{{value}}"/>',type6:'<div class="date-input-box"><input autocomplete="off" type="text" lb="{{configDesc}}" placeholder="{{wordDesc}}" class="entry2-input date-show"/><input type="date" lb="{{configDesc}}" placeholder="{{wordDesc}}" name="{{configName}}" value="{{value}}" class="entry2-input date-input"/><span class="date-select-icon echat-vs color0">&#xe638;</span></div>',type2:'<textarea autocomplete="off" class="entry2-textarea {{req}}" maxlength="{{length}}" rows="4" placeholder="{{wordDesc}}" lb="{{configDesc}}" name="{{configName}}" autoHeight="true">{{value}}</textarea>',type4:'<div class="entry2-checkbox"><label><input name="{{configName}}" value="{{configs.value}}" inputvalue="{{configs.item}}" lb="{{configDesc}}" type="radio" {{check}} /><span class="entry2-checkicon color0"></span><span>{{configs.item}}</span></label></div>',type5:'<div class="entry2-checkbox"><label><input name="{{configName}}" value="{{configs.value}}" inputvalue="{{configs.item}}" lb="{{configDesc}}" type="checkbox" {{check}} /><span class="entry2-checkicon color0"></span><span>{{configs.item}}</span></label></div>',type3:'<option value="{{configs.value}}" inputvalue="{{configs.item}}" {{check}} >{{configs.item}}</option>',type7:'<option value="{{configs.value}}" inputvalue="{{configs.item}}" {{check}} >{{configs.item}}</option>'};function d(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1}if(l=c["type"+t],6==t&&(window.ltIE10||a.default.isMobile))l=c.type6b;else if(4==t||5==t||3==t||7==t){if(i=e[n.configName].configs,l=[],e[n.configName].valueOverlength&&!i)l.push('<select class="entry2-select {{req}}" name="{{configName}}" lb="{{configDesc}}"><option value="">{{wordDesc}}</option>');else{if(o=o?o.split(","):o,3==t||7==t){if(7==t){var u,f=[];for(u=i.start;u<=i.end&&(f.push({item:u,value:u}),150!=f.length);u+=i.stepSize);i=f}l.push('<select class="entry2-select {{req}}" name="{{configName}}" lb="{{configDesc}}"><option value="">{{wordDesc}}</option>')}for(s=0;s<i.length;s++)l.push(c["type"+t].replace(/\{\{configs.item\}\}/g,i[s].item).replace("{{configs.value}}",i[s].value).replace("{{check}}",o&&d(o,i[s].value)?3==t||7==t?"selected":"checked":""))}3!=t&&7!=t||l.push("</select>"),l=l.join("")}else 1!=t&&2!=t||(l=l.replace("{{length}}",(r[n.configName]||r[1==t?"text":"textarea"]).length));return l},t.getFormItemValue=function(e,t,n){e=e||_$("entryForm");var a,o,i="",s="",r="",l="";n?t=e[n]:t&&(n=t.name);if(1!=t.nodeType){for(i=[],r=[],l=[],a=0;a<t.length;a++)t[a].checked&&(i.push(t[a].value),r.push($(t[a]).attr("lb")),l.push($(t[a]).attr("inputvalue")));s=$(t[0]).parents(".entry2-typeline").attr("lb"),i=i.join(","),r=r.join(","),l=l.join(",")}else if(s=$(t).attr("lb"),i=t.value.replace(/^[\s]+|[\s]+$/gi,""),"SELECT"==t.tagName)for(o=0;o<t.length;o++)if(t[o].value==i||t[o].getAttribute("value")==i){l=t[o].getAttribute("inputvalue"),r=$(t[o]).text();break}return{val:i,ipt:t,label:s,labelVal:r||i,inputValue:l}},t.resetOptionField=function(e,t,n,i){var s={},r={},l=[],c=[],d=[],u="workorder"===n?"/chatapi/jobh/dfd":"/chatapi/bfc/df",f=o.default.getApiDomain(),p=o.default.getVisitorInfo(),h=p.companyId,m=p.visitorId,g={companyId:h,requesterVisitorId:m};i&&(g.token=i.token,g.nonce=i.nonce);for(var v=0;v<e.length;v++)s[e[v].configName]=e[v].lan||"default";for(var y=0;y<t.length;y++)t[y].valueOverlength&&(r[t[y].field]=t[y],d.push(t[y].fieldId));d.length>0&&(g.fieldIds=d.join(","),$.ajax({url:f+u+"?"+a.default.addMapParams1(g),type:"jsonp",jsonpCB:"jsonpCallback",success:function(e){for(var t=0;t<e.length;t++){l=e[t].settings;for(var n=0;n<l.length;n++)if(s[e[t].field]===l[n].lan)for(var a in c=l[n].configs){var o="<option value='{{value}}' inputvalue='{{inputvalue}}'>{{inputvalue}}</option>";o=o.replace(/\{\{value\}\}/g,c[a].value).replace(/\{\{inputvalue\}\}/g,c[a].item),$("select[name="+e[t].field+"]").append(o)}}},error:function(){}}))},n(3),n(31),n(9),n(28),n(24);var a=i(n(4)),o=i(n(6));function i(e){return e&&e.__esModule?e:{default:e}}},158:function(e,t,n){"use strict";var a;n(10),n(24),n(39),function(e){var t,n,o,i={length:0,max:5},s=0,r=1;function l(e){var t=e.allExtra.nativeExtra||{};return{clientFileId:e.clientFileId,identityKey:e.identityKey,localFile:e.localFile||e.localVideoPath,fileType:e.fileType,sendStatus:e.sendStatus,progress:e.progress||0,fileUrl:t.sourceUrl||t.fileUrl||e.remoteVideoPath,fileSize:t.fileSize||100,fileName:t.fileName||(4==e.fileType?e.clientFileId+".mp4":e.clientFileId+".jpeg"),bucket:t.bucket,key:t.key,bigUrl:t.bigUrl,smallUrl:t.smallUrl,remoteThumbnailPath:t.videoThumbUrl||e.remoteThumbnailPath,localThumbnailPath:e.localThumbnailPath}}a={orderUploadData:i,resetOrderUploadData:function(){a.orderUploadData=i={length:0,max:5}},uploadSelector:"",paramData:{token:"",nonce:"",visitorId:"",companyId:"",apiServerDomain:""},setParamData:function(e){for(var t in e)a.paramData[t]=e[t]},setUtil:function(e){n=e},setNative:function(e){t=e},getOrderParam:function(){return{token:a.paramData.token||"",nonce:a.paramData.nonce||"",companyId:a.paramData.companyId,visitorId:a.paramData.visitorId,apiServerDomain:a.paramData.apiServerDomain}},prepareAddOrderFile:(o=0,function(e){var t,n=l(e);i[n.clientFileId]||i.length++,i[n.clientFileId]=n,n.index=++o,t=4==n.fileType?'<img src="'+n.localThumbnailPath+'" alt="" onerror="this.className=\'video-img-err\'"/><span class="file-prev-video"><i>&#xe69a;</i><i>VIDEO</i></span>':'<img onerror="this.className=\'file-prev-img\'" src="'+n.localFile+'" alt=""/>',$("#orderUpload"+n.index).remove(),$(".order-fileslist").append('<div class="orderUpload-item orderUpload-item-'+(4==n.fileType?"video":"img")+'" clientFileId="'+n.clientFileId+'" id="orderUpload'+o+'">'+t+'<span class="file-progress">'+(n.progress||0)+"%</span></div>"),i.length>=i.max&&$(a.uploadSelector||".order-button").addClass("limit-hide")}),updateOrderFile:function(e){var t=l(e);if(t.sendStatus==r)return a.successOrderFile(t);var o=t.clientFileId,c=i[o];c&&t.sendStatus==s?(n.showTip(lanRes.uploadError||lanRes.visitor181),setTimeout((function(){a.removeOrderFile(t)}),2e3)):c&&(i[t.clientFileId]=$.extend(c,t),$(".file-progress",document.getElementById("orderUpload"+c.index)).html(t.progress+"%"))},successOrderFile:function(e){var t,o,r=l(e),c=r.clientFileId,d=i[c];if(d&&r.sendStatus==s)return n.showTip(lanRes.uploadError||lanRes.visitor181),void setTimeout((function(){a.removeOrderFile(r)}),2e3);d&&(i[c]=$.extend(d,r),t=document.getElementById("orderUpload"+d.index),$(".file-progress",t).remove(),4!=r.fileType?(o=$("img",t)).hasClass("file-prev-img")&&o.removeClass("file-prev-img").attr("src",r.fileUrl):(o=$("img",t)).hasClass("video-img-err")&&o.removeClass("video-img-err").attr("src",r.remoteThumbnailPath),$("#orderUpload"+d.index).append('<a class="file-remove"></a>'))},removeOrderFile:function(e){var t=e.clientFileId,n=i[t];n&&(i.length--,$("#orderUpload"+n.index).remove(),i.length<i.max&&$(a.uploadSelector||".order-button").removeClass("limit-hide"),delete i[t])},getSubmitItems:function(e,t){var n,a,o=!0;if(t=t||[],e){for(n in i)if((a=i[n])&&a.index&&a.sendStatus==r){var s={type:1,fileValue:{url:a.fileUrl,name:a.fileName,size:a.fileSize,videoThumbUrl:a.remoteThumbnailPath,fileType:4==a.fileType?2:4,key:a.key,bucket:a.bucket}};e.push(s),t.push({type:s.fileValue.fileType,name:s.fileValue.name,fileType:s.fileValue.fileType,fileValue:s.fileValue})}else!a.fileUrl&&a.index&&(o=!1);return o}},bindOrderUpload:function(e,o){function s(e){var t=$(this.parentNode).attr("clientfileid"),o=i[t];o&&o.fileUrl?(n.showDialog({tip:lanRes.IsDel||lanRes.visitor191||"",ok:function(){var e=a.getOrderParam(),s={requesterVisitorId:e.visitorId,token:e.token||"",nonce:e.nonce||"",keys:JSON.stringify([o.key]),bucket:o.bucket};($._ajax||$.ajax)({url:e.apiServerDomain+"/chatapi/jobh/bdf?companyId="+e.companyId+n.addMapParams(s),type:$._ajax?"jsonp":"get",jsonpCB:"jsonpCallback",success:function(e){e&&e.successful?(n.showTip(lanRes.delSuccess||lanRes.visitor182||""),a.removeOrderFile(i[t])):n.showTip(e&&e.errorMsg||"删除失败")}})}}),e.preventDefault(),e.stopPropagation()):console.log("错误 没有文件可删除")}a.uploadSelector=e,$(o||"#orderUpload").hide(),$("#orderFileMenu").off("click").remove(),$("body").append('<div id="orderFileMenu" class="file-menu hide"><div class="file-menu-item" type="camera"><i class="color0">&#xe6fc;</i><span>相机</span></div><div class="file-menu-item" type="gallery"><i class="color0">&#xe65e;</i><span>相册</span></div></div>'),$(e||".order-button").off("click").on("click",(function(){i.length>=i.max?n.showDialog({tip:lanRes.MaxFileNum||lanRes.visitor179,cancel:!1}):($("#orderFileMenu").removeClass("hide"),$("#orderMask").length||($("body").append('<div class="mask" id="orderMask" style="display:block;"></div>'),$("#orderMask").on("click",(function(){$("#orderFileMenu").addClass("hide"),$("#orderMask").off("click").remove()}))))})),$("#orderFileMenu").on("click",".file-menu-item",(function(e){var n=$(this).attr("type"),o=a.getOrderParam();t("uploadMedia",{visitorId:o.visitorId,companyId:o.companyId,token:o.token,nonce:o.nonce,type:n,maxNum:i.max-i.length}),$("#orderFileMenu").addClass("hide"),$("#orderMask").off("click").remove()})),$(".order-fileslist").on("click",".orderUpload-item-img",(function(e){var n=e.srcElement||e.target||{};if(-1!=n.className.indexOf("file-remove"))return s.call(n,e);var a=0,o=this,r=[];$(".orderUpload-item-img").each((function(e,t){var n=$(t).attr("clientfileid"),s=i[n],l=s.fileUrl,c=0;s.fileUrl||(c=1,l=s.localFile),s&&(r.push({bigImg:s.bigUrl||l,smallImg:s.smallUrl||l,sourceImg:s.fileUrl||l,fileName:s.fileName,identityKey:s.identityKey,clientFileId:s.clientFileId,localFile:s.localFile,isOrignal:c}),o==t&&(a=r.length))})),t("previewImage",{urls:r,current:a}),e.preventDefault(),e.stopPropagation()})),$(".order-fileslist").on("click",".orderUpload-item-video",(function(e){var n=e.srcElement||e.target||{};if(-1!=n.className.indexOf("file-remove"))return s.call(n,e);var a,o=$(this).attr("clientfileid"),r=i[o];t("video",{type:"play",clientFileId:r.clientFileId,url:r.fileUrl,localVideoPath:r.localFile,thumbUrl:r.localThumbnailPath||r.remoteThumbnailPath,downloadUrl:(a=r.fileUrl,a?a+(-1==a.indexOf("?")?"?":"&")+"attname="+encodeURIComponent(r.fileName):""),fileName:r.fileName})}))},__playVideo:function(e,n,a,o,i){t("video",{type:"play",identityKey:i||"",clientFileId:i||"",url:e,localVideoPath:msg.localFile,thumbUrl:n,downloadUrl:a,fileName:o||""})}}}(),window.fileUtil=a},172:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(173);i(n(174));var a=i(n(220)),o=i(n(93));function i(e){return e&&e.__esModule?e:{default:e}}window.addEventListener("load",(function(){o.default.init(),a.default.pageReady()}));t.default={}},173:function(e,t,n){},174:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(133),n(3),n(20),n(10);var a=f(n(4)),o=f(n(32)),i=f(n(6)),s=n(13),r=f(n(52)),l=f(n(93)),c=f(n(118)),d=f(n(218)),u=f(n(219));function f(e){return e&&e.__esModule?e:{default:e}}var p,h={};function m(e){(0,s.handleNetwork)(1);var t=i.default.getStatusData(),n=i.default.getConfig("busyCanSend");if(t.talkType!=o.default.talkTypeQueue||2!=t.chatStatus||n)return 0!=i.default.getStatusByKey("chatStatus")||(a.default.showTip("请先接入会话"),!1);a.default.publish("changeDom",{name:"#busyTipLine",removeCls:"hide"})}function g(e,t){var n=i.default.getStatusByKey("talkType");p==a.default.Constants.talkTypeQueue&&n==a.default.Constants.talkTypeChat||a.default.publish("setTheme",t),n!=a.default.Constants.talkTypeRobot&&a.default.publish("endRobot"),a.default.publish("setUrlList"),a.default.publish("setCustomList"),a.default.publish("_changeCloseBtn","1"),p=n}a.default.subscriber.call(h,"handle"),h.setSub("connect"),d.default.init(h),u.default.init(h),a.default.publish("_checkNetworkStatus"),a.default.addEventPoint("registChat",{once:!1,check:function(e){var t=i.default.getStatusData();return 0===t.chatStatus||1===t.chatStatus||-1===t.chatStatus||(!(2!=t.chatStatus||t.talkType!=a.default.Constants.talkTypeRobot||!e||!e.robotToHumanKey)||void 0)},callback:function(e){var t,n=i.default.getVisitorInfo(),o=n.visEvt,s=n.routeEntranceId;t={et:109,media:6,osName:a.default.queryParams.osName||a.default.Device.OS,osVersion:a.default.queryParams.osVersion||"1",browserName:a.default.queryParams.browserName||"webview",browserVersion:"1",myData:n.myData,screenResolution:window.screen.width+"x"+window.screen.height,routeId:n.routeId,echatTag:n.echatTag,chatLaunchFrom:n.chatLaunchFrom,acdType:n.acdType,acdStaffId:n.acdStaffId,fm:n.fm,visEvt:o},s&&(t.routeEntranceId=s,i.default.setVisitorInfo({routeEntranceId:void 0,lastRouteEntranceId:s})),e&&$.extend(t,e),console.log("注册对话了"),h.publish("sendMessage",t),a.default.publish("_changeCloseBtn","0")}}),a.default.subscribe("visitorClose",(function(e,t){function n(){i.default.setStatusData({visitorClose:!0}),2==i.default.getStatusData().chatStatus?a.default.publish("_endChat"):a.default.publish("chatEnded")}if(1===t||i.default.getStatusData().chatStatus<1)return n();a.default.showDialog({tip:i.default.getStatusData().isInWorkOrder?lanRes.visitor188:lanRes.closeTip,ok:n,cancel:function(){i.default.setStatusData({visitorClose:!1})}})})),a.default.addEventPoint("_sendMsgLocation",{once:!1,check:m,callback:c.default}),a.default.addEventPoint("_sendMsg",{once:!1,check:m,callback:function(e){var t,n,a=i.default.getStatusData(),r=2==a.chatStatus&&a.talkType==o.default.talkTypeRobot;(n=e||l.default.input.getInput(!0)).trim()&&(n.match(/^\[#echat::lihong#\]$/),l.default.input.plainText&&(n=(0,s.plainTextToSendMsg)(n)),t={data:{content:n,et:r?130:105},filterMsg:!1},(0,c.default)(t))}}),h.subscribe("displayRouter",(function(e,t){var n=i.default.formatRouteList();if(n){var o=n.chatBoxTitle||lanRes.onlineService;i.default.setConfig("pageTitle",o),a.default.publish("__setTitle",o),i.default.setStatusByKey("statusName","router"),a.default.publish("__chatStatus","router"),a.default.publish("displayRouterDom",n)}else a.default.triggerEventOnPoint("registChat")})),h.subscribe("waitingChat",(function(e,t){var n,o,r={isInWorkOrder:!1,isInEntryOrCode:!1},l=i.default.getStatusData();if(4==l.status&&t.jobWindowInfo)r.isInWorkOrder=!0,a.default.publish("enterWorkorder",t),i.default.setStatusByKey("statusName","workorder"),a.default.publish("__chatStatus","workorder");else if(i.default.getEntryInfo(t))a.default.publish("displayEntryDom",t),r.isInEntryOrCode=!0,i.default.setStatusByKey("statusName","entry"),a.default.publish("__chatStatus","entry"),a.default.publish("setChatStatus",1);else if(i.default.getStatusByKey("captChaToken"))a.default.publish("displayCode",{captChaToken:i.default.getStatusByKey("captChaToken")}),r.isInEntryOrCode=!0,i.default.setStatusByKey("statusName","entry"),a.default.publish("__chatStatus","entry"),a.default.publish("setChatStatus",1);else if(1!=l.canChatNow){var c=i.default.getLeaveConfig(t);2===i.default.getStatusData().status&&c&&(o=(n=c).thirdPartyUrl,n&&2==n.enable&&o?(a.default.publish("__chatStatus","leaveToUrl"),i.default.setStatusByKey("statusName","end"),o=(0,s.getADURL)(1==n.enableThirdPartyParams,n.thirdPartyParams,o),a.default.publish("__jumpToUrl",o),$("body").html("")):(2==n.enable&&!o||0==n.enable)&&(a.default.publish("__chatStatus","leaveDisabled"),i.default.setStatusByKey("statusName","end"),a.default.publish("leaveDisabled",n)))}i.default.setStatusData(r)})),h.subscribe("startLeave",(function(e){a.default.publish("__setTitle",lanRes.leaveWord),i.default.setStatusByKey("statusName","leaveService"),a.default.publish("__chatStatus","leaveService");var t=i.default.getStatusByKey("visitorEntryInput");t.entryVisitorMsg&&h.publish("sendMessage",{et:105,isSave:0,content:t.entryVisitorMsg}),t.entryLeaveContent&&(h.publish("sendMessage",{et:105,isSave:0,content:t.entryLeaveContent}),setTimeout((function(){a.default.publish("_endChat")}),100))})),h.subscribe("_endChat",(function(e,t){h.publish("sendMessage",{et:107})})),h.subscribe("startRobot",g),h.subscribe("startLeave",g),h.subscribe("startChat",g),h.subscribe("startQueue",g),h.subscribe("chatEnded",(function(e,t,n){var o=t?1==t.closeReason:i.default.getStatusByKey("visitorClose"),s=n||i.default.getStatusData(),l=i.default.getVisitorInfo(),c=t||{},d=1==c.changeRoute||1==c.closeTag,u=2==s.chatStatus&&s.talkType==a.default.Constants.talkTypeChat,f=!d&&u&&s.satisfySubmited!=s.talkId;p=0,a.default.publish("clearSendingMsg","endchat"),a.default.publish("endRobot"),h.unSubscribe("getMsgTyping"),h.unSubscribe("clearMsgTyping"),h.unSubscribe("textInputChangeEvt"),r.default.removeMsg({id:"restartChat"}),!c.unreadCount&&r.default.showMsg({id:"restartChat",mt:20,tm:(new Date).getTime(),content:'<span class="btn-restart">'+lanRes.toContinueChat+"</span>"}),1!=c.changeRoute&&a.default.publish("_changeCloseBtn","0"),f&&(f=a.default.publish("showSatisfy",1)),a.default.publish("__chatStatus","end-"+(c.closeReason||"0")+"-"+(f?1:0)),i.default.setStatusByKey("statusName","end"),i.default.setStatusData({visitorClose:o,sendMsgNum:0,chatStatus:0,staffId:""}),l.lastRouteEntranceId&&i.default.setVisitorInfo({routeEntranceId:l.lastRouteEntranceId}),l.fm&&i.default.setVisitorInfo({fm:void 0}),!o||d||f||a.default.publish("_closeWin"),delete a.default.queryParams.autoPop,delete a.default.queryParams.autoChat,a.default.publish("__setTitle","")})),a.default.subscribe("restartChat",(function(e,t){if((0,s.handleNetwork)())return!1;if((0,s.hasConnect)()){var n=i.default.getConfig("config672")||{};i.default.getStatusByKey("chatStatus")>=2||a.default.triggerEventOnPoint("registChat",{nonce:n.nonce,reChatTag:n.reChatTag})}else a.default.publish("__openWebsocket")})),a.default.subscribe("_addSendMsgNum",(function(e,t){var n=i.default.getStatusByKey("sendMsgNum");i.default.setStatusByKey("sendMsgNum",n+1),a.default.publish("initEvaluate",t)}));var v=h;t.default=v},180:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(142),n(45),n(47),n(3),n(49),n(37),n(9),n(18),n(63),n(39),n(10),n(20),n(181),n(28),n(31),n(182),n(144),n(43);var a=function(){var e,t,n,a,o,i,s,r,l,c,d,u,f,p,h,m,g,v,y,b=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,I=/^[^{]+\{\s*\[native \w/,k=/[\t\r\n\f]/g,S=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,w=/\S+/g,T={find:{},filter:{}},C=window.document,x=window.document,$="echatQuery"+1*new Date,E={},M=[],P=M.slice,D=M.push,_=new RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),B=function(e,t,n){var a="0x"+t-65536;return a!==a||n?t:a<0?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,1023&a|56320)},N=function(){a()},O=1,L={},R={},F="onfocusin"in window,A={focus:"focusin",blur:"focusout"},j={mouseenter:"mouseover",mouseleave:"mouseout"},U=/^-ms-/,H=/-([\da-z])/gi,V=function(e){return e.replace(U,"ms-").replace(H,(function(e,t){return t.toUpperCase()}))},W={},K=W.toString,q=0,z=/(\=)\?(&|$)|\?\?/i,Y=function(){return!0},X=function(){return!1},J=/^([A-Z]|returnValue$|layer[XY]$)/,Q={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function Z(e){return e._zid||(e._zid=O++)}function G(e){x.createElement;var t=x.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ee(e,t,n){var i=t&&t.ownerDocument;return n=n||[],e?e.nodeType||e==window.document||e==window?(this.context=e,this.results=[e],this.length=1,this):r(e)?void 0!==f?this.readyList.push(e):e():e instanceof ee?e:((t?t.ownerDocument||t:C)!==x&&a(t),t=t||x,this.selector=e,this.context=t,this.results=o(e,t,n,i),void(this.length=this.results.length)):(this.length=0,this.results=this.results||n,this)}function te(e){return null==e?String(e):W[K.call(e)]||"object"}function ne(e){return"object"==te(e)}function ae(e,t,n){for(var a in t)n&&(d(t[a])||l(t[a]))?(d(t[a])&&!d(e[a])&&(e[a]={}),l(t[a])&&!l(e[a])&&(e[a]=[]),ae(e[a],t[a],n)):void 0!==t[a]&&(e[a]=t[a])}function oe(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function ie(e,t,n,a){t=oe(t);var o,i,s,r,l,c=L[Z(e)]||[];for(t.ns&&(r=t.ns,o=new RegExp("(?:^| )"+r.replace(" "," .* ?")+"(?: |$)")),i=[],s=0;s<c.length;s++)!(l=c[s])||t.e&&l.e!=t.e||t.ns&&!o.test(l.ns)||n&&Z(l.fn)!==Z(n)||a&&l.sel!=a||i.push(c[s]);return i}function se(e,t){return e.del&&!F&&e.e in A||!!t}function re(e){return j[e]||F&&A[e]||e}function le(t,n,a,o,i,s,r){var l,c=Z(t),d=L[c]||(L[c]=[]);e.fn.each(n.split(/\s/),(function(n,c){if("ready"==c)return e(x).ready(h);var u=oe(c);u.fn=a,u.sel=i,u.e in j&&(a=function(t){var n=t.relatedTarget;if(!n||n!==this&&!e.contains(this,n))return u.fn.apply(this,arguments)}),u.del=s,l=s||a,u.proxy=function(e){if(!(e=m(e)).isImmediatePropagationStopped()){o&&(e.data=o);var n=l.apply(t,null==e._args?[e]:[e].concat(e._args));return!1===n&&(e.preventDefault(),e.stopPropagation()),n}},u.i=d.length,d.push(u),"addEventListener"in t?t.addEventListener(re(u.e),u.proxy,se(u,r)):t.attachEvent("on"+re(u.e),u.proxy)}))}function ce(t,n,a,o,i){var s=Z(t);e.fn.each((n||"").split(/\s/),(function(n,r){e.fn.each(ie(t,r,a,o),(function(e,n){delete L[s][n.i],"removeEventListener"in t?t.removeEventListener(re(n.e),n.proxy,se(n,i)):t.detachEvent("on"+re(n.e),n.proxy)}))}))}function de(e){var t,n={originalEvent:e};for(t in e)J.test(t)||void 0===e[t]||(n[t]=e[t]);return m(n,e)}function ue(){}return i={TAG:function(e){var t=e.replace(_,B).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+e+"([\\x20\\t\\r\\n\\f]|$)");return function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}}},E.getElementsByTagName=G((function(e){return e.appendChild(x.createComment("")),!e.getElementsByTagName("*").length})),(a=function(e){var a,o,i=e?e.ownerDocument||e:C;return i===x||9!==i.nodeType||i.documentElement,t=(x=i).documentElement,(o=x.defaultView)&&o.top!==o&&(o.addEventListener?o.addEventListener("unload",N,!1):o.attachEvent&&o.attachEvent("onunload",N)),E.attributes=G((function(e){return e.className="i",!e.getAttribute("className")})),E.getElementsByTagName=G((function(e){return e.appendChild(x.createComment("")),!e.getElementsByTagName("*").length})),E.getElementsByClassName=I.test(i.getElementsByClassName),E.getById=G((function(e){return t.appendChild(e).id=$,!x.getElementsByName||!x.getElementsByName($).length})),E.getById?(T.find.ID=function(e,t){if(void 0!==t.getElementById){var n=t.getElementById(e);return n?[n]:[]}},T.filter.ID=function(e){var t=e.replace(_,B);return function(e){return e.getAttribute("id")===t}}):(delete T.find.ID,T.filter.ID=function(e){var t=e.replace(_,B);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),E.qsa=I.test(i.querySelectorAll),T.find.TAG=E.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):E.qsa?t.querySelectorAll(e):void 0}:function(e,t){for(var a,o=[],i=0,s=C.getElementsByTagName(e);a=s[i++];)1===a.nodeType&&n(t,a)&&o.push(a);return o},T.find.CLASS=E.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&documentIsHTML)return t.getElementsByClassName(e)},a=I.test(t.compareDocumentPosition),n=a||I.test(t.contains)?function(e,t){if(!e||!t)return!1;var n=9===e.nodeType?e.documentElement:e,a=t&&t.parentNode;return e===a||!(!a||1!==a.nodeType||!(n.contains?n.contains(a):e.compareDocumentPosition&&16&e.compareDocumentPosition(a)))}:function(e,t){if(!e)return!1;if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},i})(),o=function(e,t,a,o){if(!e)return a;var s,r,l,c,d,u,f,p,h,m=t?t.nodeType:9;if(c=b.exec(e),11!==m&&(c=b.exec(e)))if(s=c[1]){if(9===m){if(!(l=t.getElementById(s)))return a;if(l.id===s)return a.push(l),a}else if(t.ownerDocument&&(l=t.ownerDocument.getElementById(s))&&n(t,l)&&l.id===s)return a.push(l),a}else{if(s=c[2])return(u=T.find.TAG(s,t))&&D.apply(a,u),a;if((s=c[3])&&E.getElementsByClassName&&t.getElementsByClassName)return D.apply(a,t.getElementsByClassName(s)),a}if(1!==m&&(o=t,d=e),d)try{return D.apply(a,o.querySelectorAll(d)),a}catch(e){}if(f=(u=T.find.TAG("*",t)).length,r=0,p=c[2]){if(h=[],a=t.getElementsByTagName(p),l=void 0,"*"===p){for(;l=a[r++];)1===l.nodeType&&h.push(l);return h}return a}for(matches=(0,i.CLASS)(c[3]),r=0;r!==f&&null!=(l=u[r]);r++)l&&1===l.nodeType&&matches(l)&&a.push(l);return a},(e=function(e,t,n){return new ee(e,t)}).ajaxJSONP=function(t,n){if(!("type"in t))return e.ajax(t);var a,o,i,s,l,c,d=t.jsonpCallback,u=(r(d)?d():d)||"jsonp"+ ++q,f=x.createElement("script"),p=window[u],h=function(n){t.errorSwitch?t.errorSwitch():o({type:"error",timeout:1}),e(script).triggerHandler("error",n||"abort")},m={abort:h};if(n&&n.promise(m),o=function(o,i){e(f).remove(),o&&"error"==o.type||!a?t.error&&t.error(null,i||"error",m,t,n):t.success&&t.success(a[0],m,t,n),window[u]=p,a&&r(p)&&p(a[0]),p=a=void 0},window[u]=function(){a=arguments},i="$1"+u+"$2",t.url=t.url.replace(z,i),s="",t.data){for(l in t.data)c="string"==typeof t.data[l]?t.data[l]:JSON.stringify(t.data[l]),s="&"+l+"="+encodeURIComponent(c);s&&(s=s.substring(1),s+="&")}return t.url+=(/\?/.test(t.url)?"&":"?")+s+(t.jsonpCB||"jsonp")+"="+u,"onload"in f?(f.onload=o,f.onerror=function(){o({type:"error"})}):f.onreadystatechange=function(){/loaded|complete/.test(f.readyState)&&o()},t.beforeSend&&!1===t.beforeSend(m)?(console.log("abort",t),m):(f.src=t.url,x.getElementsByTagName("head")[0].appendChild(f),t.timeout>0&&(abortTimeout=setTimeout((function(){h("timeout"),m.isTimeout=1}),t.timeout)),m)},e.ajax=e._ajax=function(t){if("jsonp"==t.jsonp||"JSONP"==t.jsonp||"jsonp"==t.type||"JSONP"==t.type)return e.ajaxJSONP(t,t.deferred);var n,a,o,i=function(){var e,t,n;try{e=new XMLHttpRequest}catch(a){for(t=["Msxml3.XMLHTTP","Msxml2.XMLHTTP","Microsoft.XMLHTTP"],n=0,len=t.length;n<len;n++)try{e=new ActiveXObject(t[n]);break}catch(e){continue}}return e}(),s=t.data,r="";if(i.onreadystatechange=function(){4==i.readyState&&(200==i.status?t.success&&t.success(i.responseText):0==i.status&&t.errorSwitch?t.errorSwitch():t.error&&t.error(i,i.responseText))},s&&"[object object]"==Object.prototype.toString.apply(s).toLowerCase())for(n in s)r+="&"+n+"="+encodeURIComponent(s[n]);r&&t.type.match(/get/i)&&(-1!=t.url.indexOf("?")?t.url+=r:t.url+="?"+r.substring(1),r="",s=null),window.XMLHttpRequest?s||(s=null):s||(s=void 0),i.open(t.type.toUpperCase(),t.url,!0),t.timeout&&(i.timeout=t.timeout);try{if(t.xhrFields)for(a in t.xhrFields)i[a]=t.xhrFields[a]}catch(e){}if(t.header)for(o in t.header)i.setRequestHeader(o,t.header[o]);t.header&&(t.header["Content-Type"]||t.header["Content-type"]||t.header["content-type"])&&!1===t.contentType||i.setRequestHeader("Content-type",t.contentType||"application/json;charset=UTF-8;"),t.beforeSend&&t.beforeSend(i),i.send(r?r.substring(1):s)},(g=x.createElement("div")).innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",v=(v=(y=g.getElementsByTagName("a")[0])&&y.style).cssText="float:left;opacity:.5",s={float:v.cssFloat?"cssFloat":"styleFloat"},g=null,y=null,r=function(e){return null!=e&&("function"==typeof e||"[object Function]"===Object.prototype.toString.call(e))},l=function(e){return"[object Array]"===Object.prototype.toString.apply(e)},c=function(e){return"string"==typeof e},d=function(e){return ne(e)&&!function(e){return null!=e&&e==e.window}(e)&&Object.getPrototypeOf(e)==Object.prototype},u=function(e){return null==e?"":(e+"").replace(S,"")},e.extend=function(e,t,n){for(var a in t)n&&(d(t[a])||l(t[a]))?(d(t[a])&&!d(e[a])&&(e[a]={}),l(t[a])&&!l(e[a])&&(e[a]=[]),ae(e[a],t[a],n)):void 0!==t[a]&&(e[a]=t[a]);return e},e.cookie=function(t,n,a){var o,i,s,r,l,c;if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(n))||null==n))return a=e.extend({},a),null==n&&(a.expires=-1),"number"==typeof a.expires&&(o=a.expires,(i=a.expires=new Date).setDate(i.getDate()+o)),n=String(n),x.cookie=[encodeURIComponent(t),"=",a.raw?n:encodeURIComponent(n),a.expires?"; expires="+a.expires.toUTCString():"","; path="+(a.path||"/"),a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("");for(s=(a=n||{}).raw?function(e){return e}:decodeURIComponent,r=x.cookie.split("; "),c=0;l=r[c]&&r[c].split("=");c++)if(s(l[0])===t)return s(l[1]||"");return null},e.toJSON=JSON.stringify,p={src:!0,href:!0},h={isFunction:r,isArray:l,isString:c,isObject:ne,isPlainObject:d,trim:u,contains:n,readyList:[],find:function(e){var t={};return this.each((function(n,a){ee.call(t,e,a,t.results)})),t},match:function(e,t){var a=new ee(t),o=null;return a.each((function(t,a){if(a==e||n(a,e))return o=a,!0})),o},parents:function(e){var t,n,a,o,i,s;if(e&&this.results&&this.results.length>0&&(t=b.exec(e))&&((i=t[1])?n=function(e){return e.id==i}:(i=t[2])?(i=i.toUpperCase(),n=function(e){return e.tagName==i}):(i=t[3])&&(n=function(e){if(e.className){var t=e.className.split(" ");for(s=0;s<t.length;s++)if(t[s]==i)return!0;return!1}}),n))for(a=this.results[0];o=a.parentNode;){if(n(o))return new ee(o,this.context,[]);a=o}return new ee(null,this.context,[])},html:function(e){return e||""===e?this.each((function(t,n){n.innerHTML=e})):this.results&&this.results[0]?this.results[0].innerHTML:null},text:function(e){return"string"==typeof e?this.each((function(t,n){"string"==typeof n.textContent?n.textContent=e:n.innerText=e})):this.results&&this.results[0]?this.results[0].textContent||this.results[0].innerText:null},append:function(e){if(e){if(c(e)){var t,n=x.createElement("div");n.innerHTML=e,t=n.childNodes,this.each((function(e,n){for(var a,o=0;a=t[o++];)1==a.nodeType&&(a=a.cloneNode(!0),n.appendChild(a))}))}else this.each((function(t,n){n.appendChild(e)}));return this}},insertBefore:function(e,t){var n,a,o;if(e)return c(e)?((a=x.createElement("div")).innerHTML=e,o=a.childNodes,this.each((function(e,a){for(var i,s=0;i=o[s++];)1==i.nodeType&&(i=i.cloneNode(!0),(n=t||a.childNodes[0])?a.insertBefore(i,n):a.appendChild(i))}))):this.each((function(a,o){(n=t||o.childNodes[0])?o.insertBefore(e,n):o.appendChild(e)})),this},show:function(){return this.each((function(e,t){t.style.display="block"})),this},hide:function(){return this.each((function(e,t){t.style.display="none"})),this},removeClass:function(e){for(var t,n,a,o,i=this.results.length,s=0,r=0,l=(e||"").match(w)||[];r<i;r++)if(n=1===(t=this.results[r]).nodeType&&(t.className?(" "+t.className+" ").replace(k," "):"")){for(s=0;a=l[s++];)for(;n.indexOf(" "+a+" ")>=0;)n=n.replace(" "+a+" "," ");o=e?u(n):"",t.className!==o&&(t.className=o)}else t.className="";return this},addClass:function(e){for(var t,n,a,o,i=this.results.length,s=0,r=0,l=(e||"").match(w)||[];r<i;r++)if(n=1===(t=this.results[r]).nodeType&&(t.className?(" "+t.className+" ").replace(k," "):"")){for(s=0;a=l[s++];)for(;n.indexOf(" "+a+" ")<0;)n+=a+" ";o=e?u(n):"",t.className!==o&&(t.className=o)}else t.className=e;return this},attr:function(e,t){if(!e)return this;var n,a,o,i;if(void 0===t){if("string"==typeof e)return this.results&&this.results.length>0?this.getAttr(this.results[0],e):"";for(n in a=this.results?this.results.length:0,e)for(i=0;i<a;i++)o=this.results[i],p[n]?o[n]=e[n]:o.setAttribute(n+"",e[n])}else for(a=this.results?this.results.length:0,i=0;i<a;i++)(o=this.results[i]).setAttribute(e,t),p[e]?o[e]=t:o.setAttribute(e,t);return this},css:function(e,t){if(!e)return this;var n,a,o,i,r;if(void 0===t)if("string"==typeof e)this.css(e,0===t?"0":"inherit");else for(a=this.results?this.results.length:0,i=0;i<a;i++)for(n in e){r=V(n),r=s[r]||r,o=this.results[i];try{o.style[r]=e[n]}catch(e){console.log(e.message),console.log("css:"+r+":"+n)}}else try{for(a=this.results?this.results.length:0,i=0;i<a;i++)r=V(e),r=s[r]||r,(o=this.results[i]).style[r]=t}catch(e){return this}return this},remove:function(){var e,t,n=this.results?this.results.length:0;for(t=0;t<n;t++)(e=this.results[t]).parentNode.removeChild(e);return this.length=0,this.results=[],this},removeAttr:function(e){return this.each((function(t,n){n.setAttribute(e,""),n.removeAttribute(e)}))},ready:function(e){for(var t=0;this.readyList&&this.readyList[t];)h.call(window),t++;return this},hasClass:function(e){var t,n,a=this.results?this.results.length:0,o=[],s=i.CLASS(e);for(t=0;t<a;t++)s(n=this.results[t])&&o.push(n);return o.length},max:function(e,t){return e>t?e:t},width:function(){return this.results&&this.results[0]?h.max(this.results[0].offsetWidth,this.results[0].clientWidth):null},height:function(){return this.results&&this.results[0]?h.max(this.results[0].offsetHeight,this.results[0].clientHeight):null},val:function(e){return void 0===e?this.results&&this.results[0]?this.results[0].value:null:(this.results&&this.results[0]&&(this.results[0].value=e+""),this)},getAttr:function(e,t){return e.getAttribute(t)},each:function(e,t){var n=0;if(l(e))for(n=0;n<e.length&&!t.call(e[n],n,e[n]);n++);else if(r(e))for(t=e,e=this.results||[],n=0;n<e.length&&!t.call(e[n],n,e[n]);n++);else for(n in e)if(t.call(e[n],n,e[n]))break;return this}},(f=function(){var e,t=function(){f&&(h.ready(),f=void 0)};function n(){x.removeEventListener("DOMContentLoaded",n,!1),x.removeEventListener("load",n,!1),t()}function a(){"complete"==x.readyState&&(x.detachEvent("onreadystatechange",a),x.detachEvent("onload",e),t())}if(e=function(){x.detachEvent("onreadystatechange",a),x.detachEvent("onload",e),t()},x.addEventListener)x.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(x.attachEvent)x.attachEvent("onreadystatechange",a),window.attachEvent("onload",e);else if(x.lastChild==x.body)return t();(x.getElementsByTagName("body")||[]).length>0&&t()})(),e.fn=h,e.each=h.each,R.click=R.mousedown=R.mouseup=R.mousemove="MouseEvents",e.event={add:le,remove:ce},e.proxy=function(t,n){var a,o=2 in arguments&&P.call(arguments,2);if(r(t))return(a=function(){return t.apply(n,o?o.concat(P.call(arguments)):arguments)})._zid=Z(t),a;if(c(n))return o?(o.unshift(t[n],t),e.proxy.apply(null,o)):e.proxy(t[n],t);throw new TypeError("expected function")},e.fn.bind=function(e,t,n){return this.on(e,t,n)},e.fn.unbind=function(e,t){return this.off(e,t)},e.fn.one=function(e,t,n,a){return this.on(e,t,n,a,1)},m=function(t,n){return!n&&t.isDefaultPrevented||(n||(n=t),e.each(Q,(function(e,a){var o=n[e];t[e]=function(){return this[a]=Y,o&&o.apply(n,arguments)},t[a]=X})),(void 0!==n.defaultPrevented?n.defaultPrevented:"returnValue"in n?!1===n.returnValue:n.getPreventDefault&&n.getPreventDefault())&&(t.isDefaultPrevented=Y)),t},e.fn.delegate=function(e,t,n){return this.on(t,e,n)},e.fn.undelegate=function(e,t,n){return this.off(t,e,n)},e.fn.live=function(t,n){return e(x.getElementsByTagName("body")[0]).delegate(this.selector,t,n),this},e.fn.die=function(t,n){return e(x.getElementsByTagName("body")[0]).undelegate(this.selector,t,n),this},e.fn.on=function(t,n,a,o,i){var s,l,d=this;return t&&!c(t)?(e.each(t,(function(e,t){d.on(e,n,a,t,i)})),d):(c(n)||r(o)||!1===o||(o=a,a=n,n=void 0),void 0!==o&&!1!==a||(o=a,a=void 0),!1===o&&(o=X),d.each((function(r,c){i&&(s=function(e){return ce(c,e.type,o),o.apply(this,arguments)}),n&&(l=function(t){var a,i=(t=t||window.event).target||t.srcElement,r=h.match(i,n);if(r&&r!==c)return a=e.extend(de(t),{currentTarget:r,liveFired:c}),(s||o).apply(r,[a].concat(P.call(arguments,1)))}),le(c,t,o,a,n,l||s)})))},e.fn.off=function(t,n,a){var o=this;return t&&!c(t)?(e.each(t,(function(e,t){o.off(e,n,t)})),o):(c(n)||r(a)||!1===a||(a=n,n=void 0),!1===a&&(a=X),o.each((function(){ce(this,t,a,n)})))},e.fn.trigger=function(t,n){return(t=c(t)||d(t)?e.Event(t):m(t))._args=n,this.each((function(){t.type in A&&"function"==typeof this[t.type]?this[t.type]():"dispatchEvent"in this?this.dispatchEvent(t):e(this).triggerHandler(t,n)}))},e.fn.triggerHandler=function(t,n){var a,o;return this.each((function(i,s){(a=de(c(t)?e.Event(t):t))._args=n,a.target=s,e.each(ie(s,t.type||t),(function(e,t){if(o=t.proxy(a),a.isImmediatePropagationStopped())return!1}))})),o},e.fn.each("focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" "),(function(t,n){e.fn[n]=function(e){return 0 in arguments?this.bind(n,e):this.trigger(n)}})),e.Event=function(e,t){c(te)||(t=te).type;var n,a=x.createEvent(R[te]||"Events"),o=!0;if(t)for(n in t)"bubbles"==n?o=!!t[n]:a[n]=t[n];return a.initEvent(te,o,!0),m(a)},e.fn.autoHeight=function(){this.each((function(){e(this).on("keyup",(function(){var e;(e=this).style.height="auto",e.style.height=e.scrollHeight+"px"}))}))},e.isBoolean=ue,e.isDate=ue,e.isFunction=ue,e.isNaN=ue,e.isNumber=ue,e.isObject=ue,e.isRegExp=ue,e.isString=ue,e.isUndefined=ue,function(){var t,n,a=e,o="Array Boolean Date NaN Number Function Object RegExp Undefined".split(" ");for(t=0;t<o.length;t++)a["is"+(n=o[t])]=function(e){return function(t){return t!=t?"NaN"===e:RegExp(e).test(Object.prototype.toString.call(t))}}(n)}(),ee.prototype=e.fn,e}();t.default=a},187:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(3),n(9),n(18),n(37),n(31),n(66),n(39),n(10);var a=i(n(32)),o=i(n(4));function i(e){return e&&e.__esModule?e:{default:e}}var s={parseMsgByRule:function(e,t,n){if(t&&e){var i=a.default.regFace,s=a.default.regEmo,r=1;return content=t[e.mt||0],content?content=content.replace(/\$\{([^,]+),?([^,]+)?,?([^,]+)?,?([^,]+)?\}/g,(function(t,n,a,o,i){if(r="1"==i?1:0,!a&&!o)return e[n];o=parseInt(o);var s=e[n];return s?(o>0&&s.replace(/\[#([^#]+)#\]/g,(function(e,t,n,a){return(n<o&&n+e.length>=o||n<o)&&(o+=e.length-1),e})),e[n].substring(a,o)):""})):(content=e.content)||(content=t[0]),(r||n&&n.notPlainText)&&(content=function(e,t){return e&&(e+"").replace(/<(?:.|\s)*?>/gi,"").substring(0,t||100)}(content)),i?content&&(content=function(e,t){if(!e)return e;var n=o.default.emo;return n&&(e=e.replace(i,(function(e){var t=e.charCodeAt(0),a=e.charCodeAt(1),o=(a-56320+(t-55296<<10)+65536).toString(16);return n[o]?'<img class="img-emo" src="/res/emoji/32/'+o+'.png" />':n[t+"_"+a]?'<img class="img-emo" src="/res/emoji/32/'+t+"_"+a+'.png" />':e}))),e=e.replace(s,(function(e){var t=e.replace(/^\[#([\d\w_]+)#\]/g,"$1");return n&&n[t]||!n?'<img class="img-emo" src="/res/emoji/32/'+t+'.png" />':e}))}(content)):content&&(content=content.replace(s,"[face]")),content}},formatUnreadMsg:function(e){var t;return e.lastMsgContent?(t=a.default.lastMsgRule,o.default.needHttps&&e.companyLogo&&(e.companyLogo=e.companyLogo.replace(/^http:/,o.default.needHttps)),void 0!==e.unreadMsgNumber&&(e.unreadMsgCount=e.unreadMsgNumber),e.lastMsg=JSON.parse(e.lastMsgContent),e.msgContent=this.parseMsgByRule(e.lastMsg,t),{chatUrl:(this.loaderHost||location.origin)+"/visitor/mobile/chat.html?companyId="+e.companyId+"&platformSign="+encodeURIComponent(e.signature)+(this.queryParams.fvMsg?"&fvMsg="+encodeURIComponent(this.queryParams.fvMsg):"")+"&metaData="+encodeURIComponent(this.queryParams.metaData)+"&myData="+encodeURIComponent(this.queryParams.myData),msgId:e.mid,platformId:e.platformId||void 0,companyId:e.companyId,companyLogo:e.companyLogo,companyName:e.companyName,msgContent:e.msgContent,unreadMsgCount:e.unreadMsgCount}):{unreadMsgCount:e.unreadMsgNumber||e.unreadMsgCount||0}},sendMsgboxUnread:function(){var e,t={cookieName:"",cookieValue:"",readySendName:"",readySend:{lastMid:"",order:[123],123:{}},queue:[],pageTag:(new Date).getTime(),checkTimer:null,timeoutTimer:null},n=null;function a(){t.readySend=$.store(t.readySendName),t.readySend=t.readySend?JSON.parse(t.readySend):{order:[]}}function o(e,n){a();var o,i=t.readySend.order;if(0===n){if(e.mid&&(t.readySend.lastMid=e.mid),i.length>0)for(t.readySend[e.mid]=void 0,delete t.readySend[e.mid],o=0;o<i.length;o++)i[o]==e.mid&&i.splice(o,1)}else if(!t.readySend[e.mid]&&(t.readySend[e.mid]=e,t.readySend.order.unshift(e.mid),t.readySend.order.length>10)){for(o=10;o<i.length;o++)t.readySend[i[o]]=void 0,delete t.readySend[i[o]];t.readySend.order.length=10}$.store(t.readySendName,JSON.stringify(t.readySend))}function i(n){if(n&&(t.queue.push(n),o(n,1)),0!=t.queue.length){var a=$.cookie(t.cookieName);a&&(t.checkTimer||t.timeoutTimer)?t.checkTimer||t.timeoutTimer||(t.timeoutTimer=setTimeout((function(){t.timeoutTimer=null,i()}),300)):(!a&&t.checkTimer&&clearTimeout(t.checkTimer),!a&&t.timeoutTimer&&clearTimeout(t.timeoutTimer),e(t.queue.shift()))}}return e=function(e){if(e){if(a(),t.readySend.lastMid&&t.readySend.lastMid>=e.mid)return i();t.cookieValue=e.mid+"_"+t.pageTag,$.cookie(t.cookieName,t.cookieValue),t.checkTimer=setTimeout((function(){t.checkTimer=null,$.cookie(t.cookieName)==t.cookieValue&&(n(e),$.cookie(t.cookieName,""),o(e,0)),$.cookie(t.cookieName)?t.timeoutTimer=setTimeout((function(){t.timeoutTimer=null,i()}),300):i()}),200)}},{send:i,queue:t.queue,init:function(a){var o;!n&&_self.visitorId&&(t.cookieName="unreadNewMsg_"+_self.visitorId,t.readySendName="unreadNewMsgMap_"+_self.visitorId,$.cookie(t.readySendName,""),t.cookieValue=$.cookie(t.cookieName),t.readySend=$.store(t.readySendName),t.readySend?t.readySend=JSON.parse(t.readySend):(t.readySend={order:[]},$.store(t.readySendName,'{ "order": [] }')),t.cookieValue&&(o=t.cookieValue.split("_")[0],t.readySend[o]&&e(t.readySend[o])),n=a)}}}()};t.default=s},199:function(e,t,n){},200:function(e,t,n){"use strict";var a,o,i;function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(201),n(202),n(65),n(3),n(63),n(153),n(31),n(10),n(66),n(18),n(27),n(38),n(39),n(24),n(28),n(144),n(26),n(67),n(90),n(68),n(91),n(92),function(n,r){"object"==s(t)&&void 0!==e?r(t):(o=[t],void 0===(i="function"==typeof(a=r)?a.apply(t,o):a)||(e.exports=i))}(0,(function(e){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,n)};function n(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}var a=function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,r=i.length;s<r;s++,o++)a[o]=i[s];return a}var i=[{sourceKey:"scroller.scrollBehaviorX.currentPos",key:"x"},{sourceKey:"scroller.scrollBehaviorY.currentPos",key:"y"},{sourceKey:"scroller.scrollBehaviorX.hasScroll",key:"hasHorizontalScroll"},{sourceKey:"scroller.scrollBehaviorY.hasScroll",key:"hasVerticalScroll"},{sourceKey:"scroller.scrollBehaviorX.contentSize",key:"scrollerWidth"},{sourceKey:"scroller.scrollBehaviorY.contentSize",key:"scrollerHeight"},{sourceKey:"scroller.scrollBehaviorX.maxScrollPos",key:"maxScrollX"},{sourceKey:"scroller.scrollBehaviorY.maxScrollPos",key:"maxScrollY"},{sourceKey:"scroller.scrollBehaviorX.minScrollPos",key:"minScrollX"},{sourceKey:"scroller.scrollBehaviorY.minScrollPos",key:"minScrollY"},{sourceKey:"scroller.scrollBehaviorX.movingDirection",key:"movingDirectionX"},{sourceKey:"scroller.scrollBehaviorY.movingDirection",key:"movingDirectionY"},{sourceKey:"scroller.scrollBehaviorX.direction",key:"directionX"},{sourceKey:"scroller.scrollBehaviorY.direction",key:"directionY"},{sourceKey:"scroller.actions.enabled",key:"enabled"},{sourceKey:"scroller.animater.pending",key:"pending"},{sourceKey:"scroller.animater.stop",key:"stop"},{sourceKey:"scroller.scrollTo",key:"scrollTo"},{sourceKey:"scroller.scrollBy",key:"scrollBy"},{sourceKey:"scroller.scrollToElement",key:"scrollToElement"},{sourceKey:"scroller.resetPosition",key:"resetPosition"}];function r(e){console.error("[BScroll warn]: "+e)}var l="undefined"!=typeof window,c=l&&navigator.userAgent.toLowerCase(),d=!(!c||!/wechatdevtools/.test(c)),u=c&&0<c.indexOf("android"),f=function(){if("string"!=typeof c)return!1;var e=/os (\d\d?_\d(_\d)?)/.exec(c);return!!e&&!!(13===(e=e[1].split("_").map((function(e){return parseInt(e,10)})))[0]&&4<=e[1])}(),p=!1;if(l)try{var h={};Object.defineProperty(h,"passive",{get:function(){p=!0}}),window.addEventListener("test-passive",(function(){}),h)}catch(e){}function m(){return window.performance&&window.performance.now&&window.performance.timing?window.performance.now()+window.performance.timing.navigationStart:+new Date}var g=function(e,t){for(var n in t)e[n]=t[n];return e};function v(e){return null==e}function y(e,t,n){return e<t?t:n<e?n:e}var b=l&&document.createElement("div").style,I=function(){if(!l)return!1;for(var e=0,t=[{key:"standard",value:"transform"},{key:"webkit",value:"webkitTransform"},{key:"Moz",value:"MozTransform"},{key:"O",value:"OTransform"},{key:"ms",value:"msTransform"}];e<t.length;e++){var n=t[e];if(void 0!==b[n.value])return n.key}return!1}();function k(e){return!1===I?e:"standard"===I?"transitionEnd"===e?"transitionend":e:I+e.charAt(0).toUpperCase()+e.substr(1)}function S(e){return"string"==typeof e?document.querySelector(e):e}function w(e,t,n,a){a=p?{passive:!1,capture:!!a}:!!a,e.addEventListener(t,n,a)}function T(e,t,n,a){e.removeEventListener(t,n,{capture:!!a})}function C(e){for(var t=0,n=0;e;)t-=e.offsetLeft,n-=e.offsetTop,e=e.offsetParent;return{left:t,top:n}}I&&"standard"!==I&&I.toLowerCase();var x=k("transform"),$=(h=k("transition"),l&&k("perspective")in b),E=l&&("ontouchstart"in window||d),M=l&&h in b,P={transform:x,transition:h,transitionTimingFunction:k("transitionTimingFunction"),transitionDuration:k("transitionDuration"),transitionDelay:k("transitionDelay"),transformOrigin:k("transformOrigin"),transitionEnd:k("transitionEnd"),transitionProperty:k("transitionProperty")},D={touchstart:1,touchmove:1,touchend:1,touchcancel:1,mousedown:2,mousemove:2,mouseup:2};function _(e){if(e instanceof window.SVGElement){var t=e.getBoundingClientRect();return{top:t.top,left:t.left,width:t.width,height:t.height}}return{top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}}function B(e,t){for(var n in t)if(t[n].test(e[n]))return!0;return!1}var N=B;function O(e,t){void 0===t&&(t="click"),"mouseup"===e.type?i=e:"touchend"!==e.type&&"touchcancel"!==e.type||(i=e.changedTouches[0]);var n,o={};i&&(o.screenX=i.screenX||0,o.screenY=i.screenY||0,o.clientX=i.clientX||0,o.clientY=i.clientY||0);var i={ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey};if("undefined"!=typeof MouseEvent)try{n=new MouseEvent(t,g(a({bubbles:!0,cancelable:!0},i),o))}catch(e){s()}else s();function s(){(n=document.createEvent("Event")).initEvent(t,!0,!0),g(n,o)}n.forwardedTouchEvent=!0,n._constructed=!0,e.target.dispatchEvent(n)}var L={swipe:{style:"cubic-bezier(0.23, 1, 0.32, 1)",fn:function(e){return 1+--e*e*e*e*e}},swipeBounce:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},bounce:{style:"cubic-bezier(0.165, 0.84, 0.44, 1)",fn:function(e){return 1- --e*e*e*e}}};d=l&&window;function R(){}var F=l?d.requestAnimationFrame||d.webkitRequestAnimationFrame||d.mozRequestAnimationFrame||d.oRequestAnimationFrame||function(e){return window.setTimeout(e,e.interval||1e3/60)}:R,A=l?d.cancelAnimationFrame||d.webkitCancelAnimationFrame||d.mozCancelAnimationFrame||d.oCancelAnimationFrame||function(e){window.clearTimeout(e)}:R,j={enumerable:!0,configurable:!0,get:x=function(e){},set:x};var U=(H.prototype.on=function(e,t,n){return void 0===n&&(n=this),this.hasType(e),this.events[e]||(this.events[e]=[]),this.events[e].push([t,n]),this},H.prototype.once=function(e,t,n){var a=this;void 0===n&&(n=this),this.hasType(e);var o=function o(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];a.off(e,o);var r=t.apply(n,i);if(!0===r)return r};return o.fn=t,this.on(e,o),this},H.prototype.off=function(e,t){if(!e&&!t)return this.events={},this;if(e){if(this.hasType(e),!t)return this.events[e]=[],this;var n=this.events[e];if(!n)return this;for(var a=n.length;a--;)(n[a][0]===t||n[a][0]&&n[a][0].fn===t)&&n.splice(a,1);return this}},H.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.hasType(e),e=this.events[e])for(var a,i=e.length,s=o(e),r=0;r<i;r++){var l=(c=s[r])[0],c=c[1];if(l&&!0===(a=l.apply(c,t)))return a}},H.prototype.registerType=function(e){var t=this;e.forEach((function(e){t.eventTypes[e]=e}))},H.prototype.destroy=function(){this.events={},this.eventTypes={}},H.prototype.hasType=function(e){var t=this.eventTypes;t[e]===e||r('EventEmitter has used unknown event type: "'+e+'", should be oneof ['+Object.keys(t).map((function(e){return JSON.stringify(e)}))+"]")},H);function H(e){this.events={},this.eventTypes={},this.registerType(e)}var V=(W.prototype.destroy=function(){this.removeDOMEvents(),this.events=[]},W.prototype.addDOMEvents=function(){this.handleDOMEvents(w)},W.prototype.removeDOMEvents=function(){this.handleDOMEvents(T)},W.prototype.handleDOMEvents=function(e){var t=this,n=this.wrapper;this.events.forEach((function(a){e(n,a.name,t,!!a.capture)}))},W.prototype.handleEvent=function(e){var t=e.type;this.events.some((function(n){return n.name===t&&(n.handler(e),!0)}))},W);function W(e,t){this.wrapper=e,this.events=t,this.addDOMEvents()}var K,q=(n(z,K=h=function(){}),z.prototype.merge=function(e){if(!e)return this;for(var t in e)"bounce"!==t?this[t]=e[t]:this.bounce=this.resolveBounce(e[t]);return this},z.prototype.process=function(){return this.translateZ=this.HWCompositing&&$?" translateZ(1px)":"",this.useTransition=this.useTransition&&M,this.preventDefault=!this.eventPassthrough&&this.preventDefault,this.scrollX="horizontal"!==this.eventPassthrough&&this.scrollX,this.scrollY="vertical"!==this.eventPassthrough&&this.scrollY,this.freeScroll=this.freeScroll&&!this.eventPassthrough,this.scrollX=!!this.freeScroll||this.scrollX,this.scrollY=!!this.freeScroll||this.scrollY,this.directionLockThreshold=this.eventPassthrough?0:this.directionLockThreshold,this},z.prototype.resolveBounce=function(e){var t={top:!0,right:!0,bottom:!0,left:!0};return t="object"==s(e)?g(t,e):e?t:{top:!1,right:!1,bottom:!1,left:!1}},z);function z(){var e=K.call(this)||this;return e.startX=0,e.startY=0,e.scrollX=!1,e.scrollY=!0,e.freeScroll=!1,e.directionLockThreshold=0,e.eventPassthrough="",e.click=!1,e.dblclick=!1,e.tap="",e.bounce={top:!0,bottom:!0,left:!0,right:!0},e.bounceTime=800,e.momentum=!0,e.momentumLimitTime=300,e.momentumLimitDistance=15,e.swipeTime=2500,e.swipeBounceTime=500,e.deceleration=.0015,e.flickLimitTime=200,e.flickLimitDistance=100,e.resizePolling=60,e.probeType=0,e.stopPropagation=!1,e.preventDefault=!0,e.preventDefaultException={tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT|AUDIO)$/},e.tagException={tagName:/^TEXTAREA$/},e.HWCompositing=!0,e.useTransition=!0,e.bindToWrapper=!1,e.bindToTarget=!1,e.disableMouse=E,e.disableTouch=!E,e.autoBlur=!0,e.autoEndDistance=5,e.outOfBoundaryDampingFactor=1/3,e.specifiedIndexAsContent=0,e.quadrant=1,e}var Y=(X.prototype.handleDOMEvents=function(){var e=(s=this.options).bindToWrapper,t=s.disableMouse,n=s.disableTouch,a=s.click,o=this.wrapper,i=e?o:window,s=[];e=[],n=!n,t=!t;a&&s.push({name:"click",handler:this.click.bind(this),capture:!0}),n&&(s.push({name:"touchstart",handler:this.start.bind(this)}),e.push({name:"touchmove",handler:this.move.bind(this)},{name:"touchend",handler:this.end.bind(this)},{name:"touchcancel",handler:this.end.bind(this)})),t&&(s.push({name:"mousedown",handler:this.start.bind(this)}),e.push({name:"mousemove",handler:this.move.bind(this)},{name:"mouseup",handler:this.end.bind(this)})),this.wrapperEventRegister=new V(o,s),this.targetEventRegister=new V(i,e)},X.prototype.beforeHandler=function(e,t){var n=this.options,a=n.preventDefault,o=n.stopPropagation,i=n.preventDefaultException;!{start:function(){return a&&!B(e.target,i)},end:function(){return a&&!B(e.target,i)},move:function(){return a}}[t]()||e.preventDefault(),o&&e.stopPropagation()},X.prototype.setInitiated=function(e){this.initiated=e=void 0===e?0:e},X.prototype.start=function(e){var t=D[e.type];this.initiated&&this.initiated!==t||(this.setInitiated(t),N(e.target,this.options.tagException)?this.setInitiated():2===t&&0!==e.button||this.hooks.trigger(this.hooks.eventTypes.beforeStart,e)||(this.beforeHandler(e,"start"),t=e.touches?e.touches[0]:e,this.pointX=t.pageX,this.pointY=t.pageY,this.hooks.trigger(this.hooks.eventTypes.start,e)))},X.prototype.move=function(e){var t,n,a;D[e.type]===this.initiated&&(this.beforeHandler(e,"move"),a=(n=e.touches?e.touches[0]:e).pageX-this.pointX,t=n.pageY-this.pointY,this.pointX=n.pageX,this.pointY=n.pageY,this.hooks.trigger(this.hooks.eventTypes.move,{deltaX:a,deltaY:t,e:e})||(n=document.documentElement.scrollLeft||window.pageXOffset||document.body.scrollLeft,a=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop,t=this.pointX-n,n=this.pointY-a,a=this.options.autoEndDistance,(t>document.documentElement.clientWidth-a||n>document.documentElement.clientHeight-a||t<a||n<a)&&this.end(e)))},X.prototype.end=function(e){D[e.type]===this.initiated&&(this.setInitiated(),this.beforeHandler(e,"end"),this.hooks.trigger(this.hooks.eventTypes.end,e))},X.prototype.click=function(e){this.hooks.trigger(this.hooks.eventTypes.click,e)},X.prototype.setContent=function(e){e!==this.wrapper&&(this.wrapper=e,this.rebindDOMEvents())},X.prototype.rebindDOMEvents=function(){this.wrapperEventRegister.destroy(),this.targetEventRegister.destroy(),this.handleDOMEvents()},X.prototype.destroy=function(){this.wrapperEventRegister.destroy(),this.targetEventRegister.destroy(),this.hooks.destroy()},X);function X(e,t){this.wrapper=e,this.options=t,this.hooks=new U(["beforeStart","start","move","end","click"]),this.handleDOMEvents()}var J={x:["translateX","px"],y:["translateY","px"]},Q=(Z.prototype.getComputedPosition=function(){var e=window.getComputedStyle(this.content,null)[P.transform].split(")")[0].split(", ");return{x:+(e[12]||e[4])||0,y:+(e[13]||e[5])||0}},Z.prototype.translate=function(e){var t=[];Object.keys(e).forEach((function(n){var a,o;!J[n]||(a=J[n][0])&&(o=J[n][1],n=e[n],t.push(a+"("+n+o+")"))})),this.hooks.trigger(this.hooks.eventTypes.beforeTranslate,t,e),this.style[P.transform]=t.join(" "),this.hooks.trigger(this.hooks.eventTypes.translate,e)},Z.prototype.setContent=function(e){this.content!==e&&(this.content=e,this.style=e.style)},Z.prototype.destroy=function(){this.hooks.destroy()},Z);function Z(e){this.setContent(e),this.hooks=new U(["beforeTranslate","translate"])}function G(e,t,n){this.translater=t,this.options=n,this.timer=0,this.hooks=new U(["move","end","beforeForceStop","forceStop","callStop","time","timeFunction"]),this.setContent(e)}G.prototype.translate=function(e){this.translater.translate(e)},G.prototype.setPending=function(e){this.pending=e},G.prototype.setForceStopped=function(e){this.forceStopped=e},G.prototype.setCallStop=function(e){this.callStopWhenPending=e},G.prototype.setContent=function(e){this.content!==e&&(this.content=e,this.style=e.style,this.stop())},G.prototype.clearTimer=function(){this.timer&&(A(this.timer),this.timer=0)},G.prototype.destroy=function(){this.hooks.destroy(),A(this.timer)};var ee,te=(n(ne,ee=d=G),ne.prototype.startProbe=function(e,t){var n=this,a=e;this.callStopWhenPending&&this.setCallStop(!1),A(this.timer),function o(){var i=n.translater.getComputedPosition();(function(e,t,n,a){function o(e,t){return 0<(t=e-t)?-1:t<0?1:0}var i=o(t.x,e.x);return t=o(t.y,e.y),e=n.x-a.x,a=n.y-a.y,i*e<=0&&t*a<=0})(e,t,i,a)&&n.hooks.trigger(n.hooks.eventTypes.move,i),n.pending||(n.callStopWhenPending?n.callStopWhenPending=!1:n.hooks.trigger(n.hooks.eventTypes.end,i)),a=i,n.pending&&(n.timer=F(o))}()},ne.prototype.transitionTime=function(e){this.style[P.transitionDuration]=(e=void 0===e?0:e)+"ms",this.hooks.trigger(this.hooks.eventTypes.time,e)},ne.prototype.transitionTimingFunction=function(e){this.style[P.transitionTimingFunction]=e,this.hooks.trigger(this.hooks.eventTypes.timeFunction,e)},ne.prototype.transitionProperty=function(){this.style[P.transitionProperty]=P.transform},ne.prototype.move=function(e,t,n,a){this.setPending(0<n),this.transitionTimingFunction(a),this.transitionProperty(),this.transitionTime(n),this.translate(t),a=3===this.options.probeType,n&&a&&this.startProbe(e,t),n||(this._reflow=this.content.offsetHeight,a&&this.hooks.trigger(this.hooks.eventTypes.move,t),this.hooks.trigger(this.hooks.eventTypes.end,t))},ne.prototype.doStop=function(){var e,t,n=this.pending;return this.setForceStopped(!1),this.setCallStop(!1),n&&(this.setPending(!1),A(this.timer),e=(t=this.translater.getComputedPosition()).x,t=t.y,this.transitionTime(),this.translate({x:e,y:t}),this.setForceStopped(!0),this.setCallStop(!0),this.hooks.trigger(this.hooks.eventTypes.forceStop,{x:e,y:t})),n},ne.prototype.stop=function(){this.doStop()&&this.hooks.trigger(this.hooks.eventTypes.callStop)},ne);function ne(){return null!==ee&&ee.apply(this,arguments)||this}var ae,oe=(n(ie,ae=d),ie.prototype.move=function(e,t,n,a){if(!n)return this.translate(t),3===this.options.probeType&&this.hooks.trigger(this.hooks.eventTypes.move,t),void this.hooks.trigger(this.hooks.eventTypes.end,t);this.animate(e,t,n,a)},ie.prototype.animate=function(e,t,n,a){var o=this,i=m(),s=i+n,r=3===this.options.probeType;this.setPending(!0),this.callStopWhenPending&&this.setCallStop(!1),A(this.timer),function l(){var c=m();if(s<=c)return o.translate(t),r&&o.hooks.trigger(o.hooks.eventTypes.move,t),void o.hooks.trigger(o.hooks.eventTypes.end,t);var d=a(c=(c-i)/n),u={};Object.keys(t).forEach((function(n){var a=e[n],o=t[n];u[n]=(o-a)*d+a})),o.translate(u),r&&o.hooks.trigger(o.hooks.eventTypes.move,u),o.pending&&(o.timer=F(l)),o.pending||(o.callStopWhenPending?o.callStopWhenPending=!1:o.hooks.trigger(o.hooks.eventTypes.end,t))}()},ie.prototype.doStop=function(){var e,t=this.pending;return this.setForceStopped(!1),this.setCallStop(!1),t&&(this.setPending(!1),A(this.timer),e=this.translater.getComputedPosition(),this.setForceStopped(!0),this.setCallStop(!0),this.hooks.trigger(this.hooks.eventTypes.forceStop,e)),t},ie.prototype.stop=function(){this.doStop()&&this.hooks.trigger(this.hooks.eventTypes.callStop)},ie);function ie(){return null!==ae&&ae.apply(this,arguments)||this}var se=(re.prototype.start=function(){this.dist=0,this.setMovingDirection(0),this.setDirection(0)},re.prototype.move=function(e){return e=this.hasScroll?e:0,this.setMovingDirection(e),this.performDampingAlgorithm(e,this.options.outOfBoundaryDampingFactor)},re.prototype.setMovingDirection=function(e){this.movingDirection=0<e?-1:e<0?1:0},re.prototype.setDirection=function(e){this.direction=0<e?-1:e<0?1:0},re.prototype.performDampingAlgorithm=function(e,t){var n=this.currentPos+e;return n>this.minScrollPos||n<this.maxScrollPos?n>this.minScrollPos&&this.options.bounces[0]||n<this.maxScrollPos&&this.options.bounces[1]?this.currentPos+e*t:n>this.minScrollPos?this.minScrollPos:this.maxScrollPos:n},re.prototype.end=function(e){var t={duration:0},n=Math.abs(this.currentPos-this.startPos);return this.options.momentum&&e<this.options.momentumLimitTime&&n>this.options.momentumLimitDistance?(n=-1===this.direction&&this.options.bounces[0]||1===this.direction&&this.options.bounces[1]?this.wrapperSize:0,t=this.hasScroll?this.momentum(this.currentPos,this.startPos,e,this.maxScrollPos,this.minScrollPos,n,this.options):{destination:this.currentPos,duration:0}):this.hooks.trigger(this.hooks.eventTypes.end,t),t},re.prototype.momentum=function(e,t,n,a,o,i,s){void 0===s&&(s=this.options);var r=e-t,l=Math.abs(r)/n;t=s.deceleration,n=s.swipeBounceTime,s=s.swipeTime,t={destination:e+l*l/t*(r<0?-1:1),duration:Math.min(s,2*l/t),rate:15};return this.hooks.trigger(this.hooks.eventTypes.momentum,t,r),t.destination<a?(t.destination=i?Math.max(a-i/4,a-i/t.rate*l):a,t.duration=n):t.destination>o&&(t.destination=i?Math.min(o+i/4,o+i/t.rate*l):o,t.duration=n),t.destination=Math.round(t.destination),t},re.prototype.updateDirection=function(){var e=this.currentPos-this.absStartPos;this.setDirection(e)},re.prototype.refresh=function(e){var t=(o=this.options.rect).size,n=o.position,a="static"===window.getComputedStyle(this.wrapper,null).position,o=_(this.wrapper);this.wrapperSize=this.wrapper["width"===t?"clientWidth":"clientHeight"],this.setContent(e),e=_(this.content),this.contentSize=e[t],this.relativeOffset=e[n],a&&(this.relativeOffset-=o[n]),this.computeBoundary(),this.setDirection(0)},re.prototype.setContent=function(e){e!==this.content&&(this.content=e,this.resetState())},re.prototype.resetState=function(){this.currentPos=0,this.startPos=0,this.dist=0,this.setDirection(0),this.setMovingDirection(0),this.resetStartPos()},re.prototype.computeBoundary=function(){this.hooks.trigger(this.hooks.eventTypes.beforeComputeBoundary);var e={minScrollPos:0,maxScrollPos:this.wrapperSize-this.contentSize};e.maxScrollPos<0&&(e.maxScrollPos-=this.relativeOffset,0===this.options.specifiedIndexAsContent&&(e.minScrollPos=-this.relativeOffset)),this.hooks.trigger(this.hooks.eventTypes.computeBoundary,e),this.minScrollPos=e.minScrollPos,this.maxScrollPos=e.maxScrollPos,this.hasScroll=this.options.scrollable&&this.maxScrollPos<this.minScrollPos,!this.hasScroll&&this.minScrollPos<this.maxScrollPos&&(this.maxScrollPos=this.minScrollPos,this.contentSize=this.wrapperSize)},re.prototype.updatePosition=function(e){this.currentPos=e},re.prototype.getCurrentPos=function(){return this.currentPos},re.prototype.checkInBoundary=function(){var e=this.adjustPosition(this.currentPos);return{position:e,inBoundary:e===this.getCurrentPos()}},re.prototype.adjustPosition=function(e){return!this.hasScroll&&!this.hooks.trigger(this.hooks.eventTypes.ignoreHasScroll)||e>this.minScrollPos?e=this.minScrollPos:e<this.maxScrollPos&&(e=this.maxScrollPos),e},re.prototype.updateStartPos=function(){this.startPos=this.currentPos},re.prototype.updateAbsStartPos=function(){this.absStartPos=this.currentPos},re.prototype.resetStartPos=function(){this.updateStartPos(),this.updateAbsStartPos()},re.prototype.getAbsDist=function(e){return this.dist+=e,Math.abs(this.dist)},re.prototype.destroy=function(){this.hooks.destroy()},re);function re(e,t,n){this.wrapper=e,this.options=n,this.hooks=new U(["beforeComputeBoundary","computeBoundary","momentum","end","ignoreHasScroll"]),this.refresh(t)}var le=((x={}).yes=function(e){return!0},x.no=function(e){return e.preventDefault(),!1},x),ce=((d={}).horizontal=((x={}).yes="horizontal",x.no="vertical",x),d.vertical=((x={}).yes="vertical",x.no="horizontal",x),d),de=(ue.prototype.reset=function(){this.directionLocked=""},ue.prototype.checkMovingDirection=function(e,t,n){return this.computeDirectionLock(e,t),this.handleEventPassthrough(n)},ue.prototype.adjustDelta=function(e,t){return"horizontal"===this.directionLocked?t=0:"vertical"===this.directionLocked&&(e=0),{deltaX:e,deltaY:t}},ue.prototype.computeDirectionLock=function(e,t){""!==this.directionLocked||this.freeScroll||(e>t+this.directionLockThreshold?this.directionLocked="horizontal":t>=e+this.directionLockThreshold?this.directionLocked="vertical":this.directionLocked="none")},ue.prototype.handleEventPassthrough=function(e){var t=ce[this.directionLocked];if(t){if(this.eventPassthrough===t.yes)return le.yes(e);if(this.eventPassthrough===t.no)return le.no(e)}return!1},ue);function ue(e,t,n){this.directionLockThreshold=e,this.freeScroll=t,this.eventPassthrough=n,this.reset()}var fe=(pe.prototype.bindActionsHandler=function(){var e=this;this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.start,(function(t){return!e.enabled||e.handleStart(t)})),this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.move,(function(t){var n=t.deltaX,a=t.deltaY,o=t.e;return!e.enabled||(t=n,n=a,n={deltaX:(n=2===(a=e.options.quadrant)?[n,-t]:3===a?[-t,-n]:4===a?[-n,t]:[t,n])[0],deltaY:n[1]},e.hooks.trigger(e.hooks.eventTypes.coordinateTransformation,n),e.handleMove(n.deltaX,n.deltaY,o))})),this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.end,(function(t){return!e.enabled||e.handleEnd(t)})),this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.click,(function(t){e.enabled&&!t._constructed&&e.handleClick(t)}))},pe.prototype.handleStart=function(e){var t=m();this.fingerMoved=!1,this.contentMoved=!1,this.startTime=t,this.directionLockAction.reset(),this.scrollBehaviorX.start(),this.scrollBehaviorY.start(),this.animater.doStop(),this.scrollBehaviorX.resetStartPos(),this.scrollBehaviorY.resetStartPos(),this.hooks.trigger(this.hooks.eventTypes.start,e)},pe.prototype.handleMove=function(e,t,n){if(!this.hooks.trigger(this.hooks.eventTypes.beforeMove,n)){var a=this.scrollBehaviorX.getAbsDist(e),o=this.scrollBehaviorY.getAbsDist(t),i=m();if(this.checkMomentum(a,o,i))return!0;if(this.directionLockAction.checkMovingDirection(a,o,n))return this.actionsHandler.setInitiated(),!0;o=this.directionLockAction.adjustDelta(e,t),n=this.scrollBehaviorX.getCurrentPos(),e=this.scrollBehaviorX.move(o.deltaX),t=this.scrollBehaviorY.getCurrentPos(),o=this.scrollBehaviorY.move(o.deltaY),this.hooks.trigger(this.hooks.eventTypes.detectMovingDirection)||(this.fingerMoved||(this.fingerMoved=!0),t=e!==n||o!==t,this.contentMoved||t||this.hooks.trigger(this.hooks.eventTypes.contentNotMoved),!this.contentMoved&&t&&(this.contentMoved=!0,this.hooks.trigger(this.hooks.eventTypes.scrollStart)),this.contentMoved&&t&&(this.animater.translate({x:e,y:o}),this.dispatchScroll(i)))}},pe.prototype.dispatchScroll=function(e){e-this.startTime>this.options.momentumLimitTime&&(this.startTime=e,this.scrollBehaviorX.updateStartPos(),this.scrollBehaviorY.updateStartPos(),1===this.options.probeType&&this.hooks.trigger(this.hooks.eventTypes.scroll,this.getCurrentPos())),1<this.options.probeType&&this.hooks.trigger(this.hooks.eventTypes.scroll,this.getCurrentPos())},pe.prototype.checkMomentum=function(e,t,n){return n-this.endTime>this.options.momentumLimitTime&&t<this.options.momentumLimitDistance&&e<this.options.momentumLimitDistance},pe.prototype.handleEnd=function(e){if(!this.hooks.trigger(this.hooks.eventTypes.beforeEnd,e)){var t=this.getCurrentPos();if(this.scrollBehaviorX.updateDirection(),this.scrollBehaviorY.updateDirection(),this.hooks.trigger(this.hooks.eventTypes.end,e,t))return!0;t=this.ensureIntegerPos(t),this.animater.translate(t),this.endTime=m(),e=this.endTime-this.startTime,this.hooks.trigger(this.hooks.eventTypes.scrollEnd,t,e)}},pe.prototype.ensureIntegerPos=function(e){this.ensuringInteger=!0;var t=e.x,n=e.y,a=(i=this.scrollBehaviorX).minScrollPos,o=i.maxScrollPos,i=(e=this.scrollBehaviorY).minScrollPos;e=e.maxScrollPos,t=0<t?Math.ceil(t):Math.floor(t),n=0<n?Math.ceil(n):Math.floor(n);return{x:t=y(t,o,a),y:n=y(n,e,i)}},pe.prototype.handleClick=function(e){B(e.target,this.options.preventDefaultException)||(e.preventDefault(),e.stopPropagation())},pe.prototype.getCurrentPos=function(){return{x:this.scrollBehaviorX.getCurrentPos(),y:this.scrollBehaviorY.getCurrentPos()}},pe.prototype.refresh=function(){this.endTime=0},pe.prototype.destroy=function(){this.hooks.destroy()},pe);function pe(e,t,n,a,o){this.hooks=new U(["start","beforeMove","scrollStart","scroll","beforeEnd","end","scrollEnd","contentNotMoved","detectMovingDirection","coordinateTransformation"]),this.scrollBehaviorX=e,this.scrollBehaviorY=t,this.actionsHandler=n,this.animater=a,this.options=o,this.directionLockAction=new de(o.directionLockThreshold,o.freeScroll,o.eventPassthrough),this.enabled=!0,this.bindActionsHandler()}function he(e,t,n,a){var o=["momentum","momentumLimitTime","momentumLimitDistance","deceleration","swipeBounceTime","swipeTime","outOfBoundaryDampingFactor","specifiedIndexAsContent"].reduce((function(t,n){return t[n]=e[n],t}),{});return o.scrollable=!!e[t],o.bounces=n,o.rect=a,o}function me(e,t,n){n.forEach((function(n){var a,i;"string"==typeof n?a=i=n:(a=n.source,i=n.target),e.on(a,(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.trigger.apply(t,o([i],e))}))}))}var ge=(ve.prototype.init=function(){var e=this;this.bindTranslater(),this.bindAnimater(),this.bindActions(),this.hooks.on(this.hooks.eventTypes.scrollEnd,(function(){e.togglePointerEvents(!0)}))},ve.prototype.registerTransitionEnd=function(){this.transitionEndRegister=new V(this.content,[{name:P.transitionEnd,handler:this.transitionEnd.bind(this)}])},ve.prototype.bindTranslater=function(){var e=this,t=this.translater.hooks;t.on(t.eventTypes.beforeTranslate,(function(t){e.options.translateZ&&t.push(e.options.translateZ)})),t.on(t.eventTypes.translate,(function(t){var n=e.getCurrentPos();e.updatePositions(t),!0!==e.actions.ensuringInteger?t.x===n.x&&t.y===n.y||e.togglePointerEvents(!1):e.actions.ensuringInteger=!1}))},ve.prototype.bindAnimater=function(){var e=this;this.animater.hooks.on(this.animater.hooks.eventTypes.end,(function(t){e.resetPosition(e.options.bounceTime)||(e.animater.setPending(!1),e.hooks.trigger(e.hooks.eventTypes.scrollEnd,t))})),me(this.animater.hooks,this.hooks,[{source:this.animater.hooks.eventTypes.move,target:this.hooks.eventTypes.scroll},{source:this.animater.hooks.eventTypes.forceStop,target:this.hooks.eventTypes.scrollEnd}])},ve.prototype.bindActions=function(){var e=this,t=this.actions;me(t.hooks,this.hooks,[{source:t.hooks.eventTypes.start,target:this.hooks.eventTypes.beforeStart},{source:t.hooks.eventTypes.start,target:this.hooks.eventTypes.beforeScrollStart},{source:t.hooks.eventTypes.beforeMove,target:this.hooks.eventTypes.beforeMove},{source:t.hooks.eventTypes.scrollStart,target:this.hooks.eventTypes.scrollStart},{source:t.hooks.eventTypes.scroll,target:this.hooks.eventTypes.scroll},{source:t.hooks.eventTypes.beforeEnd,target:this.hooks.eventTypes.beforeEnd}]),t.hooks.on(t.hooks.eventTypes.end,(function(n,a){return e.hooks.trigger(e.hooks.eventTypes.touchEnd,a),!!e.hooks.trigger(e.hooks.eventTypes.end,a)||!(t.fingerMoved||(e.hooks.trigger(e.hooks.eventTypes.scrollCancel),!e.checkClick(n)))||(e.resetPosition(e.options.bounceTime,L.bounce)?(e.animater.setForceStopped(!1),!0):void 0)})),t.hooks.on(t.hooks.eventTypes.scrollEnd,(function(n,a){var o=Math.abs(n.x-e.scrollBehaviorX.startPos),i=Math.abs(n.y-e.scrollBehaviorY.startPos);if(e.checkFlick(a,o,i))return e.animater.setForceStopped(!1),void e.hooks.trigger(e.hooks.eventTypes.flick);e.momentum(n,a)?e.animater.setForceStopped(!1):(t.contentMoved&&e.hooks.trigger(e.hooks.eventTypes.scrollEnd,n),e.animater.forceStopped&&e.animater.setForceStopped(!1))}))},ve.prototype.checkFlick=function(e,t,n){if(1<this.hooks.events.flick.length&&e<this.options.flickLimitTime&&t<this.options.flickLimitDistance&&n<this.options.flickLimitDistance&&(1<n||1<t))return!0},ve.prototype.momentum=function(e,t){var n={time:0,easing:L.swiper,newX:e.x,newY:e.y},a=this.scrollBehaviorX.end(t);t=this.scrollBehaviorY.end(t);if(n.newX=v(a.destination)?n.newX:a.destination,n.newY=v(t.destination)?n.newY:t.destination,n.time=Math.max(a.duration,t.duration),this.hooks.trigger(this.hooks.eventTypes.momentum,n,this),n.newX!==e.x||n.newY!==e.y)return(n.newX>this.scrollBehaviorX.minScrollPos||n.newX<this.scrollBehaviorX.maxScrollPos||n.newY>this.scrollBehaviorY.minScrollPos||n.newY<this.scrollBehaviorY.maxScrollPos)&&(n.easing=L.swipeBounce),this.scrollTo(n.newX,n.newY,n.time,n.easing),!0},ve.prototype.checkClick=function(e){var t=this.animater.forceStopped;if(this.hooks.trigger(this.hooks.eventTypes.checkClick))return this.animater.setForceStopped(!1),!0;if(t)return!1;var n,a,o=this.options.dblclick;t=!1;return o&&this.lastClickTime&&(a=void 0===(n=o.delay)?300:n,m()-this.lastClickTime<a&&(t=!0,O(e,"dblclick"))),this.options.tap&&(o=e,n=this.options.tap,(a=document.createEvent("Event")).initEvent(n,!0,!0),a.pageX=o.pageX,a.pageY=o.pageY,o.target.dispatchEvent(a)),this.options.click&&!B(e.target,this.options.preventDefaultException)&&O(e),this.lastClickTime=t?null:m(),!0},ve.prototype.resize=function(){var e=this;this.actions.enabled&&(u&&(this.wrapper.scrollTop=0),clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout((function(){e.hooks.trigger(e.hooks.eventTypes.resize)}),this.options.resizePolling))},ve.prototype.transitionEnd=function(e){e.target===this.content&&this.animater.pending&&(this.animater.transitionTime(),this.resetPosition(this.options.bounceTime,L.bounce)||(this.animater.setPending(!1),3!==this.options.probeType&&this.hooks.trigger(this.hooks.eventTypes.scrollEnd,this.getCurrentPos())))},ve.prototype.togglePointerEvents=function(e){for(var t=this.content.children.length?this.content.children:[this.content],n=(e=void 0===e||e)?"auto":"none",a=0;a<t.length;a++){var o=t[a];o.isBScrollContainer||(o.style.pointerEvents=n)}},ve.prototype.refresh=function(e){var t=this.setContent(e);this.hooks.trigger(this.hooks.eventTypes.beforeRefresh),this.scrollBehaviorX.refresh(e),this.scrollBehaviorY.refresh(e),t&&(this.translater.setContent(e),this.animater.setContent(e),this.transitionEndRegister.destroy(),this.registerTransitionEnd(),this.options.bindToTarget&&this.actionsHandler.setContent(e)),this.actions.refresh(),this.wrapperOffset=C(this.wrapper)},ve.prototype.setContent=function(e){var t=e!==this.content;return t&&(this.content=e),t},ve.prototype.scrollBy=function(e,t,n,a){void 0===n&&(n=0);var o=(i=this.getCurrentPos()).x,i=i.y;this.scrollTo(e+=o,t+=i,n,a=a||L.bounce)},ve.prototype.scrollTo=function(e,t,n,o,i){void 0===n&&(n=0),void 0===o&&(o=L.bounce),void 0===i&&(i={start:{},end:{}});var s=this.options.useTransition?o.style:o.fn;o=this.getCurrentPos(),o=a({x:o.x,y:o.y},i.start),e=a({x:e,y:t},i.end);this.hooks.trigger(this.hooks.eventTypes.scrollTo,e),function(e,t){for(var n=0,a=Object.keys(e);n<a.length;n++){var o=a[n];if(e[o]!==t[o])return}return 1}(o,e)||(t=Math.abs(e.x-o.x),i=Math.abs(e.y-o.y),t<1&&i<1&&(n=0,this.hooks.trigger(this.hooks.eventTypes.minDistanceScroll)),this.animater.move(o,e,n,s))},ve.prototype.scrollToElement=function(e,t,n,a,o){var i=S(e),s=C(i);n=(e=function(e,t,n){return"number"==typeof e?e:e?Math.round(t/2-n/2):0})(n,i.offsetWidth,this.wrapper.offsetWidth),a=e(a,i.offsetHeight,this.wrapper.offsetHeight),e=function(e,t,n,a){return a.adjustPosition((e-=t)-n)},s.left=e(s.left,this.wrapperOffset.left,n,this.scrollBehaviorX),s.top=e(s.top,this.wrapperOffset.top,a,this.scrollBehaviorY),this.hooks.trigger(this.hooks.eventTypes.scrollToElement,i,s)||this.scrollTo(s.left,s.top,t,o)},ve.prototype.resetPosition=function(e,t){void 0===e&&(e=0),void 0===t&&(t=L.bounce);var n=(o=this.scrollBehaviorX.checkInBoundary()).position,a=o.inBoundary,o=(i=this.scrollBehaviorY.checkInBoundary()).position,i=i.inBoundary;return!(a&&i||(f&&this.reflow(),this.scrollTo(n,o,e,t),0))},ve.prototype.reflow=function(){this._reflow=this.content.offsetHeight},ve.prototype.updatePositions=function(e){this.scrollBehaviorX.updatePosition(e.x),this.scrollBehaviorY.updatePosition(e.y)},ve.prototype.getCurrentPos=function(){return this.actions.getCurrentPos()},ve.prototype.enable=function(){this.actions.enabled=!0},ve.prototype.disable=function(){A(this.animater.timer),this.actions.enabled=!1},ve.prototype.destroy=function(){var e=this;["resizeRegister","transitionEndRegister","actionsHandler","actions","hooks","animater","translater","scrollBehaviorX","scrollBehaviorY"].forEach((function(t){return e[t].destroy()}))},ve);function ve(e,t,n){this.wrapper=e,this.content=t,this.resizeTimeout=0,this.hooks=new U(["beforeStart","beforeMove","beforeScrollStart","scrollStart","scroll","beforeEnd","scrollEnd","resize","touchEnd","end","flick","scrollCancel","momentum","scrollTo","minDistanceScroll","scrollToElement","beforeRefresh"]),this.options=n;var a,o,i=(l=this.options.bounce).left,s=l.right,r=l.top,l=l.bottom;this.scrollBehaviorX=new se(e,t,he(n,"scrollX",[i,s],{size:"width",position:"left"})),this.scrollBehaviorY=new se(e,t,he(n,"scrollY",[r,l],{size:"height",position:"top"})),this.translater=new Q(this.content),this.animater=(t=this.content,n=this.translater,r=(a=this.options).useTransition,l={},Object.defineProperty(l,"probeType",{enumerable:!0,configurable:!1,get:function(){return a.probeType}}),new(r?te:oe)(t,n,l)),this.actionsHandler=new Y(this.options.bindToTarget?this.content:e,(o=this.options,["click","bindToWrapper","disableMouse","disableTouch","preventDefault","stopPropagation","tagException","preventDefaultException","autoEndDistance"].reduce((function(e,t){return e[t]=o[t],e}),{}))),this.actions=new fe(this.scrollBehaviorX,this.scrollBehaviorY,this.actionsHandler,this.animater,this.options),e=this.resize.bind(this),this.resizeRegister=new V(window,[{name:"orientationchange",handler:e},{name:"resize",handler:e}]),this.registerTransitionEnd(),this.init()}var ye,be=(n(Ie,ye=U),Ie.use=function(e){var t=e.pluginName;return Ie.plugins.some((function(t){return e===t.ctor}))||(v(t)?r("Plugin Class must specify plugin's name in static property by 'pluginName' field."):(Ie.pluginsMap[t]=!0,Ie.plugins.push({name:t,applyOrder:e.applyOrder,ctor:e}))),Ie},Ie.prototype.setContent=function(e){var t=!1,n=!0;return(e=e.children[this.options.specifiedIndexAsContent])?(t=this.content!==e)&&(this.content=e):(r("The wrapper need at least one child element to be content element to scroll."),n=!1),{valid:n,contentChanged:t}},Ie.prototype.init=function(e){var t=this;(this.wrapper=e).isBScrollContainer=!0,this.scroller=new ge(e,this.content,this.options),this.scroller.hooks.on(this.scroller.hooks.eventTypes.resize,(function(){t.refresh()})),this.eventBubbling(),this.handleAutoBlur(),this.enable(),this.proxy(i),this.applyPlugins(),this.refreshWithoutReset(this.content),e={x:(e=this.options).startX,y:e.startY},this.hooks.trigger(this.hooks.eventTypes.beforeInitialScrollTo,e)||this.scroller.scrollTo(e.x,e.y)},Ie.prototype.applyPlugins=function(){var e=this,t=this.options;Ie.plugins.sort((function(e,t){var n=((n={}).pre=-1,n.post=1,n);return(e.applyOrder?n[e.applyOrder]:0)-(t.applyOrder?n[t.applyOrder]:0)})).forEach((function(n){var a=n.ctor;t[n.name]&&"function"==typeof a&&(e.plugins[n.name]=new a(e))}))},Ie.prototype.handleAutoBlur=function(){this.options.autoBlur&&this.on(this.eventTypes.beforeScrollStart,(function(){var e=document.activeElement;!e||"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName||e.blur()}))},Ie.prototype.eventBubbling=function(){me(this.scroller.hooks,this,[this.eventTypes.beforeScrollStart,this.eventTypes.scrollStart,this.eventTypes.scroll,this.eventTypes.scrollEnd,this.eventTypes.scrollCancel,this.eventTypes.touchEnd,this.eventTypes.flick])},Ie.prototype.refreshWithoutReset=function(e){this.scroller.refresh(e),this.hooks.trigger(this.hooks.eventTypes.refresh,e),this.trigger(this.eventTypes.refresh,e)},Ie.prototype.proxy=function(e){var t=this;e.forEach((function(e){var n=e.key;e=e.sourceKey;!function(e,t,n){j.get=function(){return function(e,t){for(var n=t.split("."),a=0;a<n.length-1;a++)if("object"!=s(e=e[n[a]])||!e)return;var o=n.pop();return"function"==typeof e[o]?function(){return e[o].apply(e,arguments)}:e[o]}(this,t)},j.set=function(e){!function(e,t,n){for(var a,o=t.split("."),i=0;i<o.length-1;i++)e[a=o[i]]||(e[a]={}),e=e[a];e[o.pop()]=n}(this,t,e)},Object.defineProperty(e,n,j)}(t,e,n)}))},Ie.prototype.refresh=function(){var e=this.setContent(this.wrapper),t=e.contentChanged;e.valid&&(e=this.content,this.refreshWithoutReset(e),t&&(this.hooks.trigger(this.hooks.eventTypes.contentChanged,e),this.trigger(this.eventTypes.contentChanged,e)),this.scroller.resetPosition())},Ie.prototype.enable=function(){this.scroller.enable(),this.hooks.trigger(this.hooks.eventTypes.enable),this.trigger(this.eventTypes.enable)},Ie.prototype.disable=function(){this.scroller.disable(),this.hooks.trigger(this.hooks.eventTypes.disable),this.trigger(this.eventTypes.disable)},Ie.prototype.destroy=function(){this.hooks.trigger(this.hooks.eventTypes.destroy),this.trigger(this.eventTypes.destroy),this.scroller.destroy()},Ie.prototype.eventRegister=function(e){this.registerType(e)},Ie.plugins=[],Ie.pluginsMap={},Ie);function Ie(e,t){var n=ye.call(this,["refresh","contentChanged","enable","disable","beforeScrollStart","scrollStart","scroll","scrollEnd","scrollCancel","touchEnd","flick","destroy"])||this;return(e=S(e))?(n.plugins={},n.options=(new q).merge(t).process(),n.setContent(e).valid&&(n.hooks=new U(["refresh","enable","disable","destroy","beforeInitialScrollTo","contentChanged"]),n.init(e)),n):(r("Can not resolve the wrapper DOM."),n)}function ke(e,t){return new be(e,t)}ke.use=be.use,ke.plugins=be.plugins,ke.pluginsMap=be.pluginsMap,d=ke,e.Behavior=se,e.CustomOptions=h,e.createBScroll=ke,e.default=d,Object.defineProperty(e,"__esModule",{value:!0})})),"undefined"!=typeof window&&window.BScroll&&(window.BScroll=window.BScroll.default)},203:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMsgContent=b,t.getSendProgess=k,t.handleMap=void 0,t.init=function(e){a=e},n(3),n(9),n(18),n(37),n(20),n(63),n(117),n(66),n(142),n(24),n(28),n(31),n(204);var a,o,i,s,r=u(n(32)),l=u(n(4)),c=u(n(6)),d=n(13);function u(e){return e&&e.__esModule?e:{default:e}}function f(){return c.default.getConfig("locationBase")||location.origin}var p={etmt:{10:1,20:1,30:1,40:1,161:1,162:1,163:1,164:1,127:1,105:1,130:1,640:1,641:1,642:1,644:1,647:1,648:1,655:1,658:1,680:1,688:1,864:1,865:1,866:1,959:1,10001:1,10011:1,12001:1},text:{10:1,20:1,30:1,40:1,105:1,130:1,864:1,640:1,644:1,648:1},visitor:{30:1,127:1,105:1,130:1,161:1,162:1,163:1,164:1,864:1,865:1,866:1},resendEt:{127:1,105:1,130:1,161:1,162:1,163:1},sendingEt:{127:1,105:1,130:1,163:1},resendEtFile:{161:1,162:1,163:1,164:1},staff:{10:1,640:1,641:1,642:1,644:1,680:1},sysMsg:function(e){return 647==e.mt||648==e.mt||20==e.mt||10010==e.mt||10001==e.mt||12001==e.mt&&(7==e.type||3==e.type)||10011==e.mt&&(3==e.mst||2==e.customizeMsgType)},sysToStaff:function(e){return 647==e.mt&&(5==e.type||10==e.type)||10011==e.mt&&2==e.mst},sysToVisitor:function(e){return 10011==e.mt&&1==e.mst},sysToRobot:function(e){return 647==e.mt&&10==e.type},robotAnswer:function(e){return 12001==e.mt&&(1==e.type||2==e.type||5==e.type||6==e.type)},robotTip:function(e){return 12001==e.mt&&7==e.type},location:function(e){return 127==e.et},msgParser:function(e){var t,n,a=e.mt||e.et;if(s[a])return s[a];for(t=["push","video","voice","img","file"],n=0;n<t.length;n++)if(p[t[n]](e))return s[t[n]]},push:function(e){return 655==e.mt||658==e.mt},video:function(e){return 162==e.et&&4==e.fileType||(642==e.mt||866==e.mt)&&2==e.fileType},voice:function(e){return 163==e.et&&3==e.fileType||(642==e.mt||866==e.mt)&&1==e.fileType},img:function(e){return 161==e.et&&1==e.fileType||641==e.mt||865==e.mt},file:function(e){return 161==e.et&&2==e.fileType||164==e.et||(642==e.mt||866==e.mt)&&0==e.fileType},getResendClass:function(e,t){if(p.resendEt[t]&&e.sendStatus===r.default.sendStatus.error)return p.resendEtFile[t]?"file-resend":"resend";if(p.sendingEt[t]&&e.sendStatus===r.default.sendStatus.sending)return" "}};function h(e){if(!e||"string"!=typeof e)return e;var t=c.default.getDataByName("emoMap"),n=f();return t&&(e=e.replace(r.default.regFace,(function(e){var a=e.charCodeAt(0),o=e.charCodeAt(1),i=(o-56320+(a-55296<<10)+65536).toString(16);return t[i]?'<img class="img-emo" src="'+n+"/res/emoji/32/"+i+'.png" />':t[a+"_"+o]?'<img class="img-emo" src="'+n+"/res/emoji/32/"+a+"_"+o+'.png" />':e}))),e=e.replace(r.default.regEmo,(function(e){var a=e.replace(/^\[#([\d\w_]+)#\]/g,"$1");return t&&t[a]||!t?'<img class="img-emo" src="'+n+"/res/emoji/32/"+a+'.png" />':e}))}function m(e){if("string"!=typeof e||e.match(/(msg\-tel)|(msg\-link)|(msg\-mail)/))return e;var t,n,a=l.default.isMobile,o=r.default.regPhone,i=r.default.regMail,s=r.default.regLink;return o.lastIndex=0,i.lastIndex=0,s.lastIndex=0,(e=e.replace(s,(function(e){var t=arguments.length,n=arguments[t-2];if(n>0){var o=arguments[t-1].substring(0,n);if(/(\<(a|img|link|iframe|script)[^>]*>([^<]+(?!\<\/a\>))?$)|(\<[a-zA-Z]+[^>]*$)/gi.test(o))return e}return a?'<a class="msg-link" href="'+e+'" target="visitorSiteIframe">'+e+"</a>":'<a class="msg-link" target="_blank" href="'+e+'">'+e+"</a>"}))).indexOf("@")>1&&(e=e.replace(i,(function(e){var t=arguments.length,n=arguments[t-2];if(n>0){var a=arguments[t-1].substring(0,n);if(/(\<(a|img|link|iframe|script)[^>]*>[^<]+(?!\<\/a\>)$)|(\<[a-zA-Z]+[^>]*$)/gi.test(a))return e}return'<a class="msg-mail" target="_blank" href="mailto:'+e+'">'+e+"</a>"}))),e=e.replace(o,(function(e,t){var n,o,i=arguments.length,s=arguments[i-2];if(s>0){var r=arguments[i-1].substring(0,s);if(/(\<(a|img|link|iframe|script)[^>]*>[^<]+(?!\<\/a\>)$)|(\<[a-zA-Z]+[^>]*$)/gi.test(r))return e}return n=t,o=e.replace(/^[^\d]|\b/,""),(n||"")+(a?'<a class="msg-tel" href="tel:'+o+'">'+o+"</a>":'<span class="msg-tel">'+o+"</span>")})),n=/\bsrc\b\s*=\s*[\'\"]?([^\'\"]*)[\'\"]?/i,e=t=(t=e)&&t.replace(/<video\b.*?(?:\>|\/>)/gi,(function(e){var t=n.exec(e),a="";return t.length>1&&(a=t[1]),'<div class="msg-medias"><div class="msg-video" videourl='+a+'><div class="msg-video-poster"></div><div class="msg-video-angle"></div></div></div>'}))}function g(e,t,n){return'<img onerror="_echat0.imgError(this)"'+(t?"":' onload="javascript:_echat0.scrollToBottom()"')+' src="'+e+'" class="msg-img '+(n||"")+'"/>'}function v(e,t,n,a){var o=/\bsrc\b\s*=\s*[\'\"]?([^\'\"]*)[\'\"]?/i;return t=t||{},e=e&&e.replace(/<img\b.*?(?:\>|\/>)/gi,(function(e){var i=a||o.exec(e);return i?g(i=a||i[1],t.notEnd,n):e}))}function y(e){return h(v(e.localMsg||e.translation||e.content))}function b(e,t){var n,a=p.msgParser(e);return n=a?a.apply(this,arguments):y(e),680==e.mt||p.push(e)?n:n&&m(n).replace(/((\r\n)|\n)/g,"</br>")}function I(e){return(e.toStaffNickName||lanRes.serviceStaff)+" "+lanRes.transferStaff}function k(e){var t=e.sendStatus,n=c.default.getMsgFromHistory(e.clientFileId);return n&&n.sendStatus==r.default.sendStatus.success?"":t==r.default.sendStatus.sending||t==r.default.sendStatus.notSend?'<div class="msg-preview-info"><div class="msg-preview-progress">'+(e.progress||0)+"%</div></div>":""}function S(e,t,n){var a=e.sendStatus;return 161!=e.et&&162!=e.et&&163!=e.et&&164!=e.et||a==r.default.sendStatus.success||t?"":k(e)+(n?"</div>":"")}function w(e,t){if(1!=t.feedback||!c.default.getConfig("robotFeedback"))return"";var n,a,i=c.default.getStatusData(),s=e.feedback||e.allExtra.h5Extra.feedback,r=e.feedbackSubitem||e.allExtra.h5Extra.feedbackSubitem;return e.talkId==i.talkId||s?(!o&&(n=c.default.getConfig("config649").robotWordsInfo,a=l.default.dji,l.default.needHttps&&(n.solvedButton&&(n.solvedButton=n.solvedButton.replace(/^http:/,l.default.needHttps)),n.unsolvedButton&&(n.unsolvedButton=n.unsolvedButton.replace(/^http:/,l.default.needHttps))),n.solvedSubitem||n.unsolvedSubitem?!a||n.unsolvedWords||n.solvedWords?o=function(e){e=e||{};var t,o="",i='<div class="feedback-tip">'+(n.fedBackWords||"")+'</div><div class="feedback-tag"><i class="feed-icon-sel"></i><span>'+lanRes.hasSelected+'</span></div><div class="feedback-btns clearfix"><div class="feedback-btn-solve '+(1==e.feedback?"feedback-btn-solve-sel":"")+(a&&!n.solvedWords?" hide":"")+'" type="1">'+(n.solvedButton?'<img onerror="_echat0.imgError(this)" src="'+n.solvedButton+'"/>':"")+"<span>"+(n.solvedWords||"")+'</span></div><div class="feedback-btn-unsolve '+(2==e.feedback?"feedback-btn-unsolve-sel":"")+(a&&!n.unsolvedWords?" hide":"")+'" type="2">'+(n.unsolvedButton?'<img onerror="_echat0.imgError(this)" src="'+n.unsolvedButton+'"/>':"")+"<span>"+(n.unsolvedWords||"")+"</span></div></div>";if(e.feedbackSubitem||e.currentTalk){if(n.solvedSubitem&&"string"==typeof n.solvedSubitem&&(n.solvedSubitem=JSON.parse(n.solvedSubitem)),n.unsolvedSubitem&&"string"==typeof n.unsolvedSubitem&&(n.unsolvedSubitem=JSON.parse(n.unsolvedSubitem)),2!=e.feedback&&n.solvedSubitem&&n.solvedSubitem.length>0){for(o+='<div class="feedback-sub-solved"><div class="robot-tip">'+lanRes.solvedReason+'</div><ul class="feedback-sub-list '+(e.feedbackSubitem?"robot-feedback-sub-had":"")+'">',t=0;t<n.solvedSubitem.length;t++)o+='<li class="feedback-sub-li sub-solved-li '+(e.feedbackSubitem==n.solvedSubitem[t].content?"feedback-sub-sel1":"")+'"><span class="list-style-dot">'+(t+1)+'.</span><span class="feedback-sub-content" type="1">'+n.solvedSubitem[t].content+"</span></li>";o+="</ul></div>"}if(1!=e.feedback&&n.unsolvedSubitem&&n.unsolvedSubitem.length>0){for(o+='<div class="feedback-sub-unsolved"><div class="robot-tip">'+lanRes.unsolvedReason+'</div><ul class="feedback-sub-list '+(e.feedbackSubitem?"robot-feedback-sub-had":"")+'">',t=0;t<n.unsolvedSubitem.length;t++)o+='<li class="feedback-sub-li sub-unsolved-li '+(e.feedbackSubitem==n.unsolvedSubitem[t].content?"feedback-sub-sel2":"")+'"><span class="list-style-dot">'+(t+1)+'.</span><span class="feedback-sub-content" type="2">'+n.unsolvedSubitem[t].content+"</span></li>";o+="</ul>"}}return i+o+"</div></div>"}:hasRobotFeedback=!1:o=function(e){return e=e||{},'<div class="feedback-tip">'+(n.fedBackWords||"")+'</div><div class="feedback-tag"><i class="feed-icon-sel"></i><span>'+lanRes.hasSelected+'</span></div><div class="feedback-btns clearfix"><div class="feedback-btn-solve '+(1==e.feedback?"feedback-btn-solve-sel":"")+'" type="1">'+(n.solvedButton?'<img onerror="_echat0.imgError(this)" src="'+n.solvedButton+'"/>':"")+"<span>"+(n.solvedWords||"")+'</psan></div><div class="feedback-btn-unsolve '+(2==e.feedback?"feedback-btn-unsolve-sel":"")+'" type="2">'+(n.unsolvedButton?'<img onerror="_echat0.imgError(this)" src="'+n.unsolvedButton+'"/>':"")+"<span>"+(n.unsolvedWords||"")+"</span></div></div></div></div>"}),o?'<div class="robot-feedback '+(s?" robot-feedback-had robot-feedback-had"+s:"")+'">'+o({currentTalk:e.talkId==i.talkId,feedback:s,feedbackSubitem:r,answerItem:t}):(console.log("设置反馈打开但是没找到反馈配置"),"")):""}t.handleMap=p,i=function(e,t){var n=t?" border0":"";return e?'<div class="custom-event'+n+'"><div class="custom-event-wrap">{{imageUrl}}<div class="custom-event-content"><div class="custom-event-title" style="height:auto;margin-bottom:0;" title="{{title1}}">{{title}}</div><div class="custom-event-detail">{{content}}</div></div></div>{{memo}}</div>':'<a class="custom-event'+n+'" {{linkset}}><div class="custom-event-wrap">{{imageUrl}}<div class="custom-event-content"><div class="custom-event-title" style="height:auto;margin-bottom:0;" title="{{title1}}">{{title}}</div><div class="custom-event-detail">{{content}}</div></div></div>{{memo}}</a>'},s={647:function(e){if(10!=e.type)return y(e);var t,n,a=e.content;if(a=v(a,e),(n=e.commonQuestions&&JSON.parse(e.commonQuestions))&&n.length){for(e.commonQuesWords?a+='<div class="common-ques-tip">'+e.commonQuesWords+'</div><ul class="common-ques-list">':a+='<ul class="common-ques-list">',t=0;t<n.length;t++)a+='<li class="common-ques-li" did="'+n[t].id+'" ques="'+escape(n[t].question||n[t].content)+'"><span class="list-style-dot">'+(t+1)+'.</span><span class="link-robot-ques">'+(n[t].question||n[t].content)+"</span></li>";a+="</ul>"}return a},959:function(e){if(e.template){var t=e.template,n=l.default.getCSSRule(".bg0"),a=1==Number(l.default.windowType)?"info_frame3":"inner",o=e.formUrl.replace(/^http(s)?:\/\/(.*?)\//,f()+"/")+l.default.addMapParams({isVisitor:1,showResult:1,tm:(new Date).getTime(),visitorId:e.visitorId,talkId:e.talkId,sendId:e.sendId,formInfoId:e.formInfo.id,companyId:c.default.getVisitorInfo("companyId"),bgColor:n.style.backgroundColor||"",dataHost:c.default.getVisitorInfo("dataHost")});return'<a target="'+a+'" href="'+encodeURI(o)+'" class="push-url clearfix form-link-box form-res-box"><span class="from-res-box-img"></span><span>'+t.commitMsg+'</span><span style="float: right;color: #ddd;">></span></a>'}},688:function(e){if(e.template){var t=e.template,n=l.default.getCSSRule(".bg0"),a=1==Number(l.default.windowType)?"info_frame3":"inner",o=e.formUrl.replace(/^http(s)?:\/\/(.*?)\//,f()+"/")+l.default.addMapParams({isVisitor:1,visitorId:e.visitorId,talkId:e.talkId,sendId:e.sendId,companyId:c.default.getVisitorInfo("companyId"),bgColor:n.style.backgroundColor||"",dataHost:c.default.getVisitorInfo("dataHost"),apiServerDomain:c.default.getApiDomain()}),i=function(){var e=(t.detailList||[]).slice().splice(0,4),n="";for(var a in e)n+="<li>"+e[a].label+"</li>";return n}(),s='<a title="'+t.name+'" class="push-url clearfix form-link-box" target="'+a+'" href="'+encodeURI(o)+'"><div class="form-link-box-name">'+t.name+'</div><ul class="form-link-box-content">'+i+'</ul><div class="form-link-box-btn bg0"><span>点击填写</span></div></a>';if(1==t.openType&&e.allExtra&&0==e.allExtra.isForward)switch(Number(l.default.windowType)){case 1:l.default.publish("handlePushURL",encodeURI(o));break;default:l.default.publish("showURLLink",t.name,encodeURI(o),{from:5})}return s}},10011:function(e,t){if(2!=e.visibility){if(t[0]=t[0]+"anglebgwhite ",e.urlForVisitor){e.urlForVisitor=e.urlForVisitor.replace(/\s/g,"");var n=e.urlForVisitor.match(/^http\(['"]?([^'",]+)['"]?(\,['"]?(blank|inner)['"]?)?\)/i)||e.urlForVisitor.match(/^xcx\(['"]?([^'",]+)['"]?(\,['"]?(navigateTo|redirectTo|switchTab)['"]?)?\)/i);n?(e.url=n[1],e.openType=n[3]):e.url=""}else if(0==e.urlEnableForVisitor&&(e.url=void 0,delete e.url),e.url){var a=e.url.replace(/\s/g,"").match(/^apiUrl\(['"]?(\d+)['"]?(\,['"]?(reload|hash)['"]?)?\)/);a?e.toCrmUrlId=a[1]:(e.url.match(/(^http[s]?:)|(^file:)/i)||(e.url=""),e.toCrmUrlId=!1)}var o="";return e.imageUrl&&(e.imageUrl=e.imageUrl.replace(/["']/,""),o=e.imageUrl?'<img onerror="_echat0.imgError" class="custom-event-img" src="'+e.imageUrl+'"/>':"",e.url&&!e.toCrmUrlId||(o=v(o,e,"custom-event-img",e.imageUrl))),i(!e.url||e.toCrmUrlId,3==e.mst).replace(/\{\{linkset\}\}/,!e.url||e.toCrmUrlId?"":' href="'+e.url+("inner"==e.openType?'" target="inner" title="'+(e.title||lanRes.interactWnd)+'" ':"navigateTo"==e.openType||"redirectTo"==e.openType||"switchTab"==e.openType?'" target="'+e.openType+'" ':'" target="_blank" ')).replace(/\{\{title1\}\}/,l.default.HTMLDecode(e.title)||"").replace(/\{\{title\}\}/,e.title||"").replace(/\{\{imageUrl\}\}/,o).replace(/\{\{content\}\}/,e.content||"").replace(/\{\{memo\}\}/,e.memo?'<div class="custom-event-memo">'+e.memo+"</div>":"")}},10001:I,680:function(e){var t=e.pushUrlDetail.url,n="";return l.default.needHttps&&t.match(/^http:/i)&&(n=" push-blank"),'<a class="push-url clearfix'+n+'" target="info_frame3" href="'+t+'"><div class="push-icon echat bg1"></div><div class="push-content"><div class="push-name">'+l.default.HTMLDecode(e.pushUrlDetail.urlName)+' </div><div class="push-url-link">'+e.pushUrlDetail.url+"</div></div></a>"},604:I,12001:function(e){var t,n,o,i,s=e.knowledgeAnswerList||[],r="",c='<ul class="question-list">';if(e.nonTextMsg)return b(r=e.nonTextMsg);if(1==e.type||2==e.type){if((t=s[0])?1==t.answerType?r+=e.tips||"":2==t.answerType?(r+='<div class="robot-tip">'+(e.tips||"")+"</div>",r+=t.answer||"",n=t.relateKnowledges,c+='<div class="robot-tip margin-top10">'+(e.tipsExt||"")+"</div>"):3==t.answerType?(n=t.suggestions,c+='<div class="robot-tip">'+(e.tips||"")+"</div>"):4==t.answerType?r+=t.answer||"":5==t.answerType?(r+=t.answer||"",n=t.relateKnowledges,c+='<div class="robot-tip">'+(e.tips||"")+"</div>"):6==t.answerType&&(r+=t.answer||"",n=t.relateKnowledges,c+='<div class="robot-tip margin-top10">'+(e.tips||"")+"</div>"):r+=e.tips||"",n&&n.length){for(i=0;i<n.length;i++)c+='<li class="question-list-li" index="'+i+'" ><span class="list-style-dot">'+(i+1)+'. </span><span class="color-link">'+n[i].question+"</span></li>";c+="</ul>"}else c="";return o=w(e,t),'<div class="msg-item-robot">'+(r=(r=v(r,e)).replace(/&nbsp;([^&\s])/g," $1"))+c+"</div>"+o}if(r=(r=e.tip||e.tips||e.content)&&r.replace(/&nbsp;([^&\s])/g," $1"),5==e.type&&0==r.isForward)try{var u=$("#q"+e.robotDetailId),f=(0,d.getMsgByDom)(u.results[0]),p=e.feedbackSubitem;o=e.feedback,l.default.publish("setExtraMessage",f,{feedback:o,feedbackSubitem:p}),a(f)}catch(e){console.log("处理反馈没有找到机器人消息")}return r},127:function(e){var t=e.locationX||e.x,n=e.locationY||e.y,a="https://restapi.amap.com/v3/staticmap?location="+n+","+t+"&zoom="+(e.scale||15)+"&size=400*200&key=5349312538cf80d1f6c008eb059b732c&markers=mid,,A:"+n+","+t;return'<div class="msg-map"><a target="cover" href="http://uri.amap.com/marker?position='+n+","+t+"&name="+encodeURIComponent(e.label)+'&coordinate=gaode"><div class="msg-map-title"><div>'+e.label+'</div><div class="msg-map-addr">'+(e.address||"")+'</div></div><img onerror="_echat0.imgError(this)" onload="_echat0.scrollToBottom()" class="view_img" src="'+a+'" draggable="false"/></a></div>'},push:function(e,t){var n=e.staffNickName||c.default.getStaff(e.staffId).name,a=[];return 1==e.allExtra.h5Extra.read&&(t[0]=t[0]+" unfold "),a.push('<div class="msg-leave" ><div class="msg-leave-title"><i class="msg-leave-i"></i><span class="msg-leave-t">'),a.push('<span class="color0">'+n+"&nbsp;</span>"),a.push(658==e.mt?lanRes.visitor174:4==e.chatInfoType?lanRes.staffLeave:lanRes.leaveStaffReply),a.push("</span></div>"),a.push('<div class="msg-leave-con" ><div class="msg-leave-content">'),a.push(h(l.default.HTMLDecode(e.brief))),a.push('</div><div class="msg-leave-dot">...</div><div class="msg-leave-link color0">'),a.push(lanRes.viewAll),a.push("</div></div></div>"),a.join("")},video:function(e){var t=e.localThumbnailPath||e.remoteThumbnaiLPath||e.videoThumbUrl;return'<div class="msg-video">'+(t?'<img class="msg-video-poster" onerror="_echat0.imgError(this)" src="'+t+'" '+(e.notEnd?"":'onload="javascript:_echat0.scrollToBottom()"')+'alt=""/>':'<div class="msg-video-poster" ></div>')+'<div class="msg-video-angle"></div>'+S(e,!1,!0)},voice:function(e){var t,n;return t=(n=parseInt((e.voiceDuration||e.duration||0)/1e3)||1)<4?60:15*n,'<div class="msg-voice" style="width:'+(t=Math.min(t,.75*window.innerWidth-40))+'px;"><span class="msg-voice-info">'+n+'"</span><i></i>'+S(e,!0,!0)},img:function(e){return'<div class="msg-imgs">'+g(e.smallImg||e.localFile,e.notEnd,e.customClass)+S(e,!1,!0)},file:function(e){var t=e.allExtra.nativeExtra||{},n=t.loadStatus,a=void 0===n?0:n,o=t.progress,i=void 0===o?0:o,s={0:"点击下载",1:"点击打开",2:i+"%",3:"点击重新下载",4:'<span class="red">下载失败</span>重新下载'};return'<div class="msg-file file-load-status'+a+'" ><div class="file-icon echat"></div><div class="file-info file-info-btn"><div class="file-name">'+e.fileName+'</div><div class="file-size">文件大小（'+((parseInt((e.fileSize||0)/1024)||1)/1024).toFixed(3)+'M）</div></div><div class="file-load-bar clearfix"><div class="file-load-bar-info">'+s[a||0]+'</div><div class="file-load-progress"><div class="file-load-progress0" style="width:'+(i||0)+'%"></div></div></div></div>'+S(e,!1,!0)}}},206:function(e,t,n){"use strict";n(38),n(26),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(10),n(3),n(20),n(18),n(39);var a=c(n(4)),o=c(n(44)),i=n(13),s=c(n(6)),r=c(n(118)),l=["allExtra","h5Extra","isForward","sendStatus","tm"];function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var u,f,p=o.default.callEchatNative,h=!1;function m(e){var t=$(e).parents(".msgli").attr("id"),n=s.default.getMsgFromHistory(t);return n&&n.msg}function g(){$(".msg-voice").each((function(e,t){$(t).removeClass("playing")}))}var v={init:function(e){u=e,a.default.subscribe("recordEvent",(function(e,t){t&&6==t.type&&(f=null,g())})),a.default.subscribe("downloadEvent",(function(e,t){var n=t.identityKey,a=t.fileIdentity,o=t.nativeExtra,i=o.loadStatus,r=o.progress,l=o.localFile,c=n||a,d=s.default.getMsgFromHistory(n||a).msg;l=d.localFile||l,s.default.updateMsgByIndetity(d.clientFileId||c,{localFile:l}),s.default.updateHistoryMsgNativeExt(d.clientFileId||c,"loadStatus",i),s.default.updateHistoryMsgNativeExt(d.clientFileId||c,"progress",r),d.allExtra.nativeExtra||(d.allExtra.nativeExtra={}),d.allExtra.nativeExtra.loadStatus=i,d.allExtra.nativeExtra.progress=r,u.updateMsg(d)})),$("#content").on("click",".msg-voice",(function(e){var t=m(this),n=f&&f.clientFileId,a=t.clientFileId||t.fileIdentity;n&&(p("voice",{type:7,clientFileId:t.clientFileId,localFile:t.localFile}),g()),n!=a?(p("voice",{type:6,url:t.remoteFileUrl,identityKey:t.identityKey||t.fileIdentity,clientFileId:t.clientFileId,localFile:t.localFile}),f=t,$(this).addClass("playing")):f=null})).on("click",".msg-video",(function(e){var t=m(this),n=t.remoteVideoPath||t.remoteFileUrl||t.fileUrl||t.localVideoPath;if(!n){if(!(n=$(this).attr("videourl")))return void console.log("未找到视频文件信息");t={identityKey:(new Date).getTime(),remoteVideoPath:n}}var a,o,i=t.fileName||(new Date).getTime()+".mp4";a="video",o={type:"play",identityKey:t.identityKey||t.fileIdentity,clientFileId:t.clientFileId,url:n,localVideoPath:t.localVideoPath,fileName:i,downloadUrl:n+(-1==n.indexOf("?")?"?":"&")+"attname="+encodeURIComponent(i)},h||(h=!0,p(a,o),setTimeout((function(){h=!1}),700))})).on("click",".msg-imgs",(function(e){var t=$(".msg-img",this).results[0],n=[],a=0;$(".msg-img",_$("content")).each((function(e,o){var i,s,r,l,c=m(o);c&&(i=c.clientFileId||c.identityKey||c.fileIdentity)?(r=c.fileName,n.push({bigImg:c.bigImg||c.localFile,smallImg:c.smallImg,sourceImg:c.sourceImg,identityKey:c.identityKey||c.fileIdentity,clientFileId:c.clientFileId,localFile:c.localFile})):(i=(new Date).getTime()+"",r=s=$(o).attr("src"),n.push({bigImg:s,smallImg:s,sourceImg:s,identityKey:i,clientFileId:i,isOrignal:1})),t==o&&(a=n.length),l=(l=(r||"temp.png").match(/[^.]+$/))&&l[0]||"png",n[n.length-1].fileName=i+"."+l})),p("previewImage",{urls:n,current:a})})).on("click",".file-resend",(function(e){if(!(0,i.handleNetwork)()){var t=m(this);t&&a.default.showDialog({tip:"发送失败，是否重发该消息",ok:function(){p("resendFile",t.clientFileId)}}),$(this).attr("resend","1")}})).on("click",".msg-file",(function(e){var t,n,a,o,r=m(this),l=r.allExtra.nativeExtra||{},c=l.loadStatus,d=void 0===c?0:c,u=l.localFile;if(r){if(a=r.identityKey||r.fileIdentity,t=r.fileUrl||r.remoteFileUrl,t+=(-1==t.indexOf("?")?"?":"&")+"attname="+encodeURIComponent(r.fileName),0==d||3==d||4==d){if((0,i.handleNetwork)())return;n=2,p("downloadFile",{identityKey:a,url:t,isNeedOpen:0,downloadType:0,fileName:r.fileName,windowType:0}),o="0%",$(".file-load-progress0",this).css("width","0px")}else 2==d?(p("cancelDownloadFile",{identityKey:a,url:t}),n=3,o="点击重新下载"):1==d&&p("openFile",{identityKey:a,clientFileId:r.clientFileId,localFile:u||r.localFile});n&&(s.default.updateHistoryMsgNativeExt(r.clientFileId||a,"loadStatus",n),s.default.updateHistoryMsgNativeExt(r.clientFileId||a,"progress",0)),this.className="msg-file file-load-status"+d,o&&$(".file-load-bar-info",this).html(o)}})).on("click",".msg-leave",(function(e){var t=$(this).parents(".msgli").attr("id"),n=t&&s.default.getMsgFromHistory(t);if(n){var o,i=n.msg,r=658==i.mt,l=s.default.getConfig("locationBase"),c=s.default.getVisitorInfo(),d=s.default.getConfig("config600"),u=s.default.getApiDomain()+"/chatapi/paodm/qd?companyId="+c.companyId+a.default.addMapParams({visitorId:c.visitorId,chatInfoType:i.chatInfoType||9,talkId:i.newsMsgId||i.jobId,tm:i.tm,token:i.signature}),f="in"==window.lanResName?"id":window.lanResName,p=l+"/visitor/common/"+(r?"order.html":"record.html")+"?lan="+(r?d.lan:f)+"&sdkVersion=21&url="+encodeURIComponent(u);r&&(p+=a.default.addMapParams({token:i.token,nonce:i.nonce,uploadFileSize:d.uploadFileSize,fileUploadInfos:(o=d.fileUploadInfos.reduce((function(e,t){return e.push(t.uploadServiceType),e}),[]),JSON.stringify(o)),photo:s.default.getVisitorImg()})),a.default.publish("showURLLink",r?lanRes.visitor173:lanRes.leaveMsgTitle,p,{needOpen:!0,from:5,workorder:r?1:void 0}),1!=i.allExtra.h5Extra.read&&($(this).parents(".msgli").addClass("unfold"),s.default.updateHistoryMsgExt(t,{read:1}),a.default.publish("setExtraMessage",i,{read:1}))}})),$(".action-close").on("touchend",(function(){a.default.publish("visitorClose")})),$("#pre_his").on("touchend",(function(){a.default.publish("loadHistory")})),$(document).on("click",".resend",(function(e){if(!(0,i.handleNetwork)()){var t,n,o=(t=$(this).parents(".msgli").attr("id"),(n=s.default.getMsgFromHistory(t))&&n.originData),c=s.default.getStatusData(),u=2==c.chatStatus,f=2==c.chatStatus&&c.talkType==a.default.Constants.talkTypeRobot;if(!u)return a.default.showTip("请继续对话后再发送消息");if(f&&127==o.data.et)return a.default.showTip("请进入人工服务后再发送位置消息");var p=o.data,h=(p.allExtra,p.h5Extra,p.isForward,p.sendStatus,p.tm,d(p,l));o.data=h,(0,r.default)(o)}})).on("click",".btn-restart",(function(){(0,i.handleNetwork)()||(setTimeout((function(){a.default.publish("restartChat")}),10),$(".btn-restart").removeClass("btn-restart"),$(this).text(lanRes.chatContinued))}))}};t.default=v},207:function(e,t,n){},208:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=this,t=this;this.textRange=null,this.getInputDoc=function(){var t;return 2==e.editorType?(t=_$("html_input").contentDocument)||(t=document.frames.html_input.document):t=document,t},this.getInputDocBody=function(){var t,n,a=e.editorType;return 3==a?(n=_$("html_pre_input")).blur||(n.blur=function(){window.focus()}):2==a?((t=_$("html_input").contentDocument)||(t=document.frames.html_input.document),n=t.body||t.getElementsByTagName("body")[0]):n=_$("textInput"),n},this.focusInput=function(t){var n,a,o,i=e.editorType;return 3==i?n=_$("html_pre_input"):2==i?(n=_$("html_input").contentWindow||document.frames.html_input,(a=_$("html_input").contentDocument)||(a=document.frames.html_input.document),o=a.body||a.getElementsByTagName("body")[0],!t&&o.focus()):n=_$("textInput"),!t&&n.focus(),!t&&o&&o.focus(),n},this.filterPasteData=function(e,t){var n=e&&e.replace(/^(<div>)(<br(\/)?>)+(<\/div>)/gi,"").replace(/(<div>)(<br(\/)?>)+(<\/div>)/gi,"\n").replace(/<([br|hr|div])+(\/)?>/gi,"\n").replace(/<\/(br|p|table|section|footer|article|li|ul|ol)>/gi,"\n").replace(/(<[a-z]+(\s+[^>]*)?\/?>)|(<\/[a-z]+>)/gi,"").replace(/&nbsp;/g," ");return"function"==typeof String.prototype.trimEnd?(t&&(e=e.trimEnd()),n=n.trimEnd()):(t&&(e=e.replace(/(\n|\r|[<br>]|\s)+$\w{0}/g,"")),n=n.replace(/(\n|\r|[<br>]|\s)+$\w{0}/g,"")),e&&t?e:n},this.filterPasteText=function(t,n,a,o){var i,s,r=_$("textInput");if(void 0===n&&(n=a.clipboardData&&clipboardData.setData?a.clipboardData.getData("text"):(t.originalEvent||t).clipboardData.getData("text/plain")||prompt("在这里输入文本")),n){if(n=e.filterPasteData(n),t.returnValue=!1,t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),n&&e.plainText)if(o.selection)o.selection.createRange().text=n;else if("number"==typeof r.selectionStart&&"number"==typeof r.selectionEnd){var l=r.selectionStart,c=r.selectionEnd,d=l,u=r.value;r.value=u.substring(0,l)+n+u.substring(c,u.length),d+=n.length,r.selectionStart=r.selectionEnd=d}else r.value+=n;else n&&o.body.createTextRange?(o.selection?textRange=o.selection.createRange():a.getSelection&&(i=a.getSelection().getRangeAt(0),(s=o.createElement("span")).innerHTML="&#FEFF;",i.deleteContents(),i.insertNode(s),textRange=o.body.createTextRange(),textRange.moveToElementText(s),s.parentNode.removeChild(s)),textRange.text=n,textRange.collapse(!1),textRange.select()):n&&o.execCommand("insertText",!1,n);return!1}return!0},this.sendMsg=function(e){a.default.triggerEventOnPoint("_sendMsg");try{3==t.editorType?window.getSelection().empty():2==t.editorType&&t.win.getSelection().empty()}catch(e){}e&&"enter"==e.from&&t.isMobile&&"qq"!=a.default.Browser.browser&&"weixin"!=a.default.Browser.browser&&"uc"!=a.default.Browser.browser&&t.getInputDocBody().blur(),t.textInputChange()},this.textInputChange=function(e){var n=t.getInput(),s=i.default.getStatusData(),l=i.default.getConfig("inputMaxLength"),c=i.default.getConfig("maxRobotLength"),d=-1;2==s.chatStatus&&s.talkType==o.default.talkTypeRobot?function(e,n){var a,o,i=0,s=0;for(n*=2,a=0;a<e.length;a++){if(null!=e.charAt(a).match(/[^\x00-\xff]/gi)?(i+=2,s+=1):i+=1,i>=n)return t.setInput(e.substr(0,i-s)),void $("#inputLengthTip").html(lanRes.inputLengthTip1+" 0 "+lanRes.inputLengthTip2);o=n/2-(parseInt(i/2)+i%2),$("#inputLengthTip").html(lanRes.inputLengthTip1+" "+o+" "+lanRes.inputLengthTip2)}}(n,l?Math.min(c,l):c):l&&l<n.length&&(n.substr(l-8,16).replace(a.default.Constants.regEmo,(function(e,t,n){d=n})),d=d>-1?8-d:0,t.setInput(n.substr(0,l-d))),n!=r&&(r=n),a.default.publish("textInputChangeEvt",e)}},n(3),n(9),n(209),n(20);var a=s(n(4)),o=s(n(32)),i=s(n(6));function s(e){return e&&e.__esModule?e:{default:e}}var r=""},210:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(119);var a=l(n(4)),o=l(n(53)),i=l(n(120)),s=l(n(211)),r=l(n(212));function l(e){return e&&e.__esModule?e:{default:e}}var c;o.default.infoScroll;a.default.subscribe("changeNetStatus",(function(e,t){t?a.default.publish("changeDom",{name:"#networkDisconnected",cls:"hide"}):a.default.publish("changeDom",{name:"#networkDisconnected",removeCls:"hide"})}));var d={init:function(e){c=e,s.default.init(e),i.default.init(e),r.default.init(),$("#sa_advise").on("blur",(function(){window.scrollTo(0,0)})),$("#content").on("click",(function(e){c.getInputDocBody().blur()}))}};t.default=d},211:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(10);var a=s(n(6)),o=s(n(44)),i=s(n(4));s(n(13));function s(e){return e&&e.__esModule?e:{default:e}}var r,l,c=o.default.callEchatNative,d=null,u=null,f=-1;i.default.subscribe("recordEvent",(function(e,t){if(0==t.type||1==t.type)d&&d(t.type);else if(2==t.type&"number"==typeof t.db){var n;n=t.db<40?0:(n=parseInt((t.db-40)/10))>5?5:n<1?1:n,$(".icon-record-sound").results[0].className="icon-record-sound echat icon-record-sound"+n}else 3==t.type&&"number"==typeof t.timeout?(console.log("record-countdown",t.timeout),$("body").addClass("record-countdown"),$(".icon-record-countdown").html(t.timeout)):4==t.type?u&&u():5==t.type?(u&&u(),i.default.showTip("说话时间太短")):7==t.type&&u&&u()}));var p={init:function(){var e=a.default.getVisitorInfo().companyId;function t(e){c("voice",{type:5}),u&&u()}e&&"522166"!=e&&$(".record-switch").removeClass("limit-hide"),$(".record-switch").on("click",(function(){$("#chatText").hasClass("recording")?$("#chatText").removeClass("recording"):$("#chatText").addClass("recording")})),r="getSelection"in window?function(){window.getSelection().removeAllRanges()}:function(){document.selection.empty()},$(".btn-record").on("contextmenu",(function(e){e.preventDefault&&e.preventDefault()})).on("touchstart",(function(e){r();var n,a,o=l?e:e.touches[0];(l=function(e,t){return e.type=="pointer"+t||e.type.toLowerCase()=="mspointer"+t}(e,"down"))&&("touch"!=(a=e).pointerType&&a.pointerType!=a.MSPOINTER_TYPE_TOUCH||!a.isPrimary)||(n={x1:o.pageX,y1:o.pageY,start:(new Date).getTime()},f=0,d=function(e){d=null,0===f&&(1==e?($("body").addClass("record-touching").removeClass("record-canceling").removeClass("record-countdown"),$(".btn-record").html(lanRes.visitor194),c("voice",{type:2}),f=1,i.default.hideTip()):i.default.showTip("请打开麦克风权限"))},setTimeout((function(){0==f&&c("voice",{type:1,record_time:60})}),0),u=function(){f=-1,$("body").removeClass("record-touching").removeClass("record-canceling"),$(".btn-record").html(lanRes.visitor193),$(document).off("touchmove",s).off("touchend",t),u=null,d=null,r()},$(document).on("touchmove",s).on("touchend",t),!1!==e.cancelable&&e.preventDefault&&e.preventDefault());function s(e){r(),o=l?e:e.touches[0],n.x2=o.pageX,n.y2=o.pageY,1!=f&&2!=f||(Math.abs(n.y1-n.y2)>30?1==f&&($("body").addClass("record-canceling"),c("voice",{type:3}),f=2):2==f&&($("body").removeClass("record-canceling"),c("voice",{type:4}),f=1))}}))}};t.default=p},212:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(43),n(119);var a=r(n(44)),o=r(n(4)),i=r(n(6)),s=n(13);function r(e){return e&&e.__esModule?e:{default:e}}var l=a.default.callEchatNative;o.default.subscribe("showURLLink",(function(e,t,n,a){var o={url:n,openType:(a=a||{}).openType||"half"};a&&a.workorder?(o.openType=a.openType||"coverChat",o.registerBridge=15,o.isCanOtherHandle=0):a&&5==a.from&&(o.registerBridge=7,o.isCanOtherHandle=1),l("openUrl",o)}));var c={init:function(){$("#urlList").on("click",".list-url-item",(function(e){var t=i.default.getConfig("urlListConfig"),n=t&&t[this.getAttribute("data-index")],a=n&&n.url;n&&a&&(a=(0,s.getADURL)(!0,n.openWindowParamList.concat(n.afterConnectParamList||[]),a),l("openUrl",{url:a,openType:1==n.openType?"default":"half"}))})),$("body").on("click","a",(function(e){var t,n,a=this;if($.fn.contains(_$("list_his"),a)||$.fn.contains(_$("innerADWrap"),a))return t=a.getAttribute("href"),n=a.getAttribute("target"),!!t&&(t=(0,s.addFixedParam)(t),"inner"==n||"menuSiteIframe"==n?l("openUrl",{url:t,openType:"half"}):n&&"cover"==n?l("openUrl",{url:t,openType:"coverChat"}):n&&"_blank"==n||n&&_$(n)?l("openUrl",{url:t,openType:"default"}):l("openUrl",{url:t,openType:"half"}),e.preventDefault&&e.preventDefault(),!1)}))}};t.default=c},213:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(3),n(9),n(10);var a=s(n(4)),o=s(n(6)),i=n(13);function s(e){return e&&e.__esModule?e:{default:e}}var r={innerAD:{notEnableParam:!1,params:"[]",element:"#inner_frame",hash:!0,srcUrl:void 0,attr:"src",url:""},innerImgUrl:{attr:"href"},rightAD:null,leftAD:null,innerURL:{},merchantLink:null,staffInfo:null,urlList:null};a.default.subscribe("updateChatStaffInfo",(function(){function e(e){if(e.srcUrl){var t,n=(0,i.getADURL)(!e.notEnableParam,e.params,e.srcUrl,e.hash);$(e.element).each((function(a,o){t=n,"IFRAME"==o.tagName&&(t=(0,i.addEchatInnerFrameParam)(n)),"src"==e.attr?o.src=t:"href"==e.attr?o.href=t:$(o).attr(e.attr,t)})),e.url=t}}var t,n,o;for(t in r)if(n=r[t])if(a.default.isArray(n))for(o=0;o<n.length;o++)e(n[o]);else e(n)}));var l={init:function(){a.default.subscribe("setTheme",(function(){!function(){console.log("**************** 设置主题色了 ***************");var e=a.default.setCss,t=o.default.getChatbox(),n=o.default.getConfig("config649"),i=n.robotWordsInfo;if(t){o.default.setConfigs({echatSourceTagEnable:n.echatSourceTagEnable,showAvatar:"1"==t.chatBoxStaffImgEnable,busyCanSend:"1"!=t.busyNotAllowSendStatus,robotFeedback:i&&"1"==i.enableFedBack}),t.chatColor=t.chatColor||t.chatThemeBackColor,e(".bg0",[{attr:"color",value:t.chatThemeTxtColor},{attr:"backgroundColor",value:t.chatColor}]),e(".border0",{attr:"borderColor",value:t.chatColor}),e(".color0",{attr:"color",value:t.chatColor}),e(".bg1",[{attr:"backgroundColor",value:t.chatStaffBackColor},{attr:"borderColor",value:t.chatStaffBackColor},{attr:"color",value:t.chatStaffTxtColor}]),e(".colorbg1",{attr:"color",value:t.chatStaffBackColor}),e(".bg3",[{attr:"backgroundColor",value:t.chatVisitorBackColor},{attr:"borderColor",value:t.chatVisitorBackColor},{attr:"color",value:t.chatVisitorTxtColor}]),e(".colorbg3",{attr:"color",value:t.chatVisitorBackColor}),e(".msg-info",[{attr:"backgroundColor",value:t.sysMsgBackground},{attr:"color",value:t.sysMsgFontColor}]);var s=a.default.getBackground(t.windowThemeBackColor,t.windowThemeBackTransparency);return t.sysMsgBackground&&(e(".color1",{attr:"color",value:t.windowTextColor}),e(".msg-staff-name",{attr:"color",value:t.windowTextColor}),e(".hr-left",{attr:"backgroundColor",value:t.windowTextColor}),e(".hr-right",{attr:"backgroundColor",value:t.windowTextColor})),t.windowThemeBackColor&&(e(".bg4",{attr:"backgroundColor",value:s}),e(".hr-left",{attr:"background",value:"linear-gradient(to right,"+s+" 0%, "+t.windowTextColor+" 40%, "+t.windowTextColor+" 100%)"}),e(".hr-right",{attr:"background",value:"linear-gradient(to left,"+s+" 0%, "+t.windowTextColor+" 40%, "+t.windowTextColor+" 100%)"})),t.evaluateThemeColor&&(e("body .sub-selected",[{attr:"color",value:t.evaluateThemeColor},{attr:"borderColor",value:t.evaluateThemeColor}]),e(".emcolor",{attr:"color",value:t.evaluateThemeColor}),e(".embgcolor",{attr:"backgroundColor",value:t.evaluateThemeColor})),i?(e(".feedback-btn-solve",{attr:"backgroundColor",value:(t=i).solvedBackColor}),e(".sub-solved-li",{attr:"backgroundColor",value:t.solvedBackColor}),e(".feedback-btn-solve-sel",{attr:"backgroundColor",value:t.solvedSelectColor}),e(".feedback-sub-sel1",{attr:"backgroundColor",value:t.solvedSelectColor}),e(".feedback-btn-unsolve",{attr:"backgroundColor",value:t.unsolvedBackColor}),e(".sub-unsolved-li",{attr:"backgroundColor",value:t.unsolvedBackColor}),e(".feedback-btn-unsolve-sel",{attr:"backgroundColor",value:t.unsolvedSelectColor}),e(".feedback-sub-sel2",{attr:"backgroundColor",value:t.unsolvedSelectColor}),t):t}console.log("没有对话窗口配置")}(),2==o.default.getStatusByKey("chatStatus")&&function(){var e,t,n,s,l=o.default.getChatbox(),c=l.chatBoxAdHeight,d=1==l.chatBoxAdImgLinkFixed;function u(){a.default.publish("changeDom",{name:"#innerADWrap",removeCls:"hide"})}c=c?parseInt(c):0,$(".innerAD").each((function(){$("#list_msg").contains(this)||$(this).remove()})),2==l.chatBoxInnerAdType?e=l.chatBoxInnerAdContent:3==l.chatBoxInnerAdType?e=c&&l.chatBoxInnerAdImg:1==l.chatBoxInnerAdType&&(e=c&&l.chatBoxInnerAdUrl),e&&(2==l.chatBoxInnerAdType?t='<li class="clearfix innerAD innerAD-text"><div>'+e+"</div></li>":3==l.chatBoxInnerAdType?(s=(new Date).getTime(),window["resetInnerAdHeight"+s]=function(e,t,n){if(n==s){var a=(t>e?e:t)+20;d&&$("#innerADWrap").css("height",a+"px"),u()}},a.default.needHttps&&(e=e.replace(/^http:/,a.default.needHttps)),l.chatBoxInnerAdImgLinkUrl?(n=(0,i.getADURL)(l.chatBoxAdPostEnable,l.chatBoxInnerAdPostParamList||"{}",l.chatBoxInnerAdImgLinkUrl,1!=l.chatBoxInnerAdParamAppendType),t='<li class="clearfix innerAD innerAD-img"><a id="innerADLink" target="'+(1==l.chatBoxInnerAdImgLinkOpenType?window.SDK?"cover":"_blank":"inner")+'" href="'+n+'"><img onload="resetInnerAdHeight'+s+"(this.height,"+c+","+s+')" onerror="resetInnerAdHeight'+s+"(this.height,"+c+","+s+')" style="max-height:'+c+'px" src="'+e+'"/></a></li>',$.extend(r.innerImgUrl,{notEnableParam:1!=l.chatBoxAdPostEnable,srcUrl:l.chatBoxInnerAdImgLinkUrl,url:e,params:l.chatBoxInnerAdPostParamList||"{}",hash:1!=l.chatBoxInnerAdParamAppendType,element:"#innerADLink"})):t='<li class="clearfix innerAD innerAD-img"><img onload="resetInnerAdHeight'+s+"(this.height,"+c+","+s+')" style="max-height:'+c+'px" src="'+e+'"/></li>'):1==l.chatBoxInnerAdType&&(a.default.needHttps&&(e=e.replace(/^http:/,a.default.needHttps)),e=(0,i.getADURL)(l.chatBoxAdPostEnable,l.chatBoxInnerAdPostParamList||"{}",e,1!=l.chatBoxInnerAdParamAppendType),t='<li class="clearfix innerAD innerAD-url"><iframe id="inner_frame" class="ps-child" height="'+l.chatBoxAdHeight+'px" border="0" allowtransparency="true" scrolling="no" frameborder="0" style="width:100%;height:'+l.chatBoxAdHeight+'px" src="'+(0,i.addEchatInnerFrameParam)(e)+'" ></iframe></li>',$.extend(r.innerAD,{notEnableParam:1!=l.chatBoxAdPostEnable,srcUrl:l.chatBoxInnerAdUrl,url:e,params:l.chatBoxInnerAdPostParamList||"{}",hash:1!=l.chatBoxInnerAdParamAppendType,element:"#inner_frame"})),d?($("#innerADWrap").html(t).removeClass("hide"),u()):($("#list_msg").append(t),a.default.publish("changeDom",{name:"#innerADWrap",cls:"hide"})),2==l.chatBoxInnerAdType&&(setTimeout(u,1e3),setTimeout(u,5e3)))}()}))}};t.default=l},214:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(10),n(3),n(9);var a=r(n(4)),o=r(n(6)),i=r(n(53));n(215),n(216),n(217);var s=r(n(32));function r(e){return e&&e.__esModule?e:{default:e}}function l(){var e=$(this).attr("dataindex"),t=o.default.getConfig("config695").routeEntranceInfo.entranceDetails[parseInt(e)],n={routeId:t.routeId,routeEntranceTheme:t.theme,echatTag:t.routeEntranceEchatTag||t.theme};o.default.setVisitorInfo(n),a.default.triggerEventOnPoint("registChat",n),$("#router").remove(),$("#mask").hide()}a.default.subscribe("displayRouterDom",(function(e,t){var n,o,s,r,c,d,u,f,p=0,h=t.lines,m=t.entranceDetails,g=a.default.Browser.isIOS&&a.default.Browser.osVersion<13,v='<div id="router" class="router '+(g?"":"slideUp")+" router-line"+h+'"><div id="routerTitle" class="router-title '+(t.title?"":"router-hide")+'">'+t.title+'</div><div id="routerList" class="router-list"><ul class="clearfix">';for(r=0;r<m.length;r++)n=++p%h==0,o=(s=m[r]).icon&&!s.content?1:s.icon&&s.content?2:!s.icon&&s.content?3:s.icon||s.content?"":3,a.default.needHttps&&s.icon&&(s.icon=s.icon.replace(/^http:/,a.default.needHttps)),v+='<li class="router-item router-item-content'+o+'" dataindex="'+r+'" '+(n?'style="border-right:none;"':"")+'><div class="router-item-content"><div class="router-item-icon '+(m[r].icon?"":"router-hide")+'">'+(m[r].icon?'<img onload="_echat0.checkImg&&_echat0.checkImg(this)" src="'+m[r].icon+'"/>':"")+'</div></div><div class="router-item-theme">'+m[r].theme+"</div></li>";v+="</ul></div></div>",$("#entry").addClass("hide"),$("#mask").show(),$("body").append(v),$(".router-item").off("click").on("click",l),d=window.innerHeight||document.body.clientHeight,u=$("#routerList").height(),f=$("#routerTitle").height(),.8*d<u+f?($("#router").css({height:.8*d+"px"}),$("#routerList").css({height:.8*d-f+"px"}),c=i.default.initScroll("routerScroll","routerList"),setTimeout((function(){c.refresh()}),600)):$("#routerList").css({height:"auto"}),!g&&setTimeout((function(){$("#router").removeClass("slideUp")}),100)}));var c={init:function(){a.default.Browser.isIOS&&$("body").addClass("ios"),$(".robot-staff-close").on("click",(function(){var e=this.parentNode;$(e).addClass("hide")})),$("#chat").on(a.default.clickName,".robot-staff",(function(){2==o.default.getStatusByKey("chatStatus")&&o.default.getStatusByKey("talkType")==s.default.talkTypeRobot&&a.default.publish("sendMessage",{et:131})})).on(a.default.clickName,".end-chat",(function(){a.default.publish("visitorClose")})).on(a.default.clickName,".to-leave-word",(function(){o.default.getStatusByKey("chatStatus")>0&&o.default.getStatusByKey("talkType")!=s.default.talkTypeLeave&&a.default.publish("sendMessage",{et:107,toLeaveWord:1},(function(){}))})),$(".leave-bar-btn").on("click",(function(){a.default.publish("restartChat")}))},reset:function(){$(".btn-qcode").addClass("hide"),$(".btn-close").addClass("hide")}};t.default=c},215:function(e,t,n){"use strict";n(43),n(3),n(9),n(10),n(28),n(24),n(39);var a=l(n(4));n(155),n(156);var o=l(n(6)),i=l(n(13)),s=l(n(53)),r=n(157);function l(e){return e&&e.__esModule?e:{default:e}}var c,d,u,f,p,h,m,g=a.default.isMobile,v=!g&&2==a.default.windowType;function y(){function e(){var e;$("#verify_change").hasClass("loadin")||($("#verify_change").addClass("loadin"),e={et:122,windowType:a.default.windowType,content:"refresh code"},"1"==a.default.queryParams.autoPop&&(e.isAutoPop=1),a.default.publish("sendMessage",e))}$("#verify_change").removeClass("loadin"),$("#verify_input").removeClass("error").val(""),$("#verify_img").off("click").on("click",e),$("#verify_change").off("click").bind("click",e),$("#verify_input").off("click").bind("keydown",(function(){$("#verify_input").removeClass("error")})),$("#verify_ok").off("click").bind("click",(function(){if(!$("#verify_change").hasClass("loadin")){var e,t=$("#verify_input").val();t?($("#verify_change").addClass("loadin"),e={et:106,captcha:t,windowType:a.default.windowType},"1"==a.default.getQueryParams.autoPop&&(e.isAutoPop=1),a.default.publish("sendMessage",e)):$("#verify_input").addClass("error")}}))}a.default.subscribe("displayCode",(function(e,t){c(t)})),a.default.subscribe("displayEntryDom",(function(e,t){if(a.default.dji&&1==t.entranceInfo.entranceLevel)return o.default.setStatusByKey("isInEntryOrCode",!1),a.default.triggerEventOnPoint("registChat"),!1;var n,i=t.entranceInfo,s=2==o.default.getStatusByKey("status"),l=!1,c=i.buzFieldSettings||[],u=i.fieldSettings||[],p=o.default.getVisitorInfo(),h=p.visitorId,m=p.companyId,g=s&&"0"==i.offlineStartType,v=decodeURIComponent($.store("ECHAT_"+m+"_"+h+"_ENTRY_HIS")||"{}");u=u.concat(c),v=JSON.parse(v),1!=i.entranceLevel&&g&&(i.entranceLevel=1,l=!0,u=[{enable:1,field:"gender",fieldId:7106,isSystem:1,label:"性别",lan:"default",settings:[{configs:[{item:lanRes.male,sort:1,value:"1"},{item:lanRes.female,sort:2,value:"2"}],lan:"default"}],type:4},{enable:1,field:"maritalStatus",fieldId:7107,isSystem:1,label:"婚否",lan:"default",settings:[{configs:[{item:lanRes.married,sort:1,value:"2"},{item:lanRes.unmarried,sort:2,value:"1"}],lan:"default"}],type:4},{enable:1,field:"age",fieldId:7109,isSystem:1,label:"年龄",lan:"default",settings:[{configs:{end:127,start:1,stepSize:1},lan:"default"}],type:7},{enable:1,field:"birthday",fieldId:7108,isSystem:1,label:"生日",settings:[],type:6}],i.upgradeOfflineVisitorInfoConfiguration=i.offlineVisitorInfoConfiguration,i.upgradeOfflineWelcomeWord=i.offlineWelcomeWord),$("#entry").remove(),n=1==i.entranceLevel?d(i,v,l,u):f(i,v),a.default.publish("__setTitle",s?lanRes.leaveWord:lanRes.onlineService),(0,r.resetOptionField)(n,u,"entrance",i)})),f=function(e,t){var n,i,s,r,l,c,d=2==o.default.getStatusByKey("status"),f=(d?e.offlineVisitorInfoConfiguration:e.visitorInfoConfiguration)||[],h=f&&f.length||0,g=!o.default.getStatusByKey("captChaToken")&&function(e){var t,n=!0;for(t=0;t<e.length&&(n=n&&"1"==e[t].configInline);t++);return n?"1":"0"}(f),v=o.default.getConfig("isVip"),y=0,b=0,I="",k=0;for(e=$.extend({},e),!0===d&&(e.welcomeWord=e.offlineWelcomeWord,e.welcomeWordPos=e.offlineWelcomeWordPos,e.entryCanClose=e.offlineEntryCanClose,e.visitorInfoCloseImg=e.offlineVisitorInfoCloseImg,e.visitorInfoClosePos=e.offlineVisitorInfoClosePos,e.visitorInfoFormPos=e.offlineVisitorInfoFormPos,e.visitorInfoBackImg=e.offlineVisitorInfoBackImg,e.visitorInfoLabelColor=e.offlineVisitorInfoLabelColor,e.visitorInfoInputColor=e.offlineVisitorInfoInputColor,e.visitorInfoSubmitPos=e.offlineVisitorInfoSubmitPos,e.visitorInfoSubmitTxt=e.offlineVisitorInfoSubmitTxt,e.buttonBackgroundColor=e.offlineButtonBackgroundColor,e.visitorInfoBackgroundColor=e.offlineVisitorInfoBackgroundColor,e.visitorInfoSubmitImg=e.offlineVisitorInfoSubmitImg),a.default.needHttps&&(e.visitorInfoCloseImg&&(e.visitorInfoCloseImg=e.visitorInfoCloseImg.replace(/^http:/,a.default.needHttps)),e.visitorInfoBackImg&&(e.visitorInfoBackImg=e.visitorInfoBackImg.replace(/^http:/,a.default.needHttps)),e.visitorInfoSubmitImg&&(e.visitorInfoSubmitImg=e.visitorInfoSubmitImg.replace(/^http:/,a.default.needHttps))),console.log(e.visitorInfoBackImg),r=' <div id="entryWrap" class="'+("1"==g?"book-all-line ":"")+'" >'+(1==e.entryCanClose&&e.visitorInfoCloseImg?'<div id="cancelEntryBtn" style="'+e.visitorInfoClosePos+'"><img src="'+e.visitorInfoCloseImg+'" onload="imgLoadResizeSelf(this)" /></div>':"")+(e.visitorInfoBackImg?'<div><img id="entryWrapImg" class="book-table-img hide" src="'+e.visitorInfoBackImg+'" onload="imgLoadResize(this,-1)" /></div>':"")+'<form id="entryForm" name="entryForm" class="book-items" ><div class="book-form-title0" style="'+e.welcomeWordPos+'">'+(e.welcomeWord||"")+'</div> <div class="clearfix book-items-list" style="'+e.visitorInfoFormPos+';">',c=0;c<h;c++)I=1==(l=f[c]).configRequired?" req ":"","1"==l.configInline?y=parseInt(y+1.5):y+=.5,"1"==l.configWebVipVisitor&&v||"1"==l.configWebVisitor&&!v?("1"==l.configInline?b=parseInt(b+1.5):b+=.5,i=t[n=l.configName],s=window.ltIE10?"text":"birthday"==n?"date":"age"==n?"number":"text",r+='<div class="book-half book-item'+I+("1"==l.configInline?" book-one-line":"")+("gender"==n||"maritalStatus"==n?" book-item-opts":"")+'"><label class="book-label" style="color:'+e.visitorInfoLabelColor+'"><span class="req-span color0">*</span><span class="name-span">'+l.configDesc+"</span></label>"+("gender"==n?'<label class="input-radio-lb" style="color:'+e.visitorInfoLabelColor+'"><input type="radio" class="book-radio '+I+'" name="gender" value="1" '+(1==i?'checked="checked"':"")+' lb="'+l.configDesc+'"/><span class="radio-span">'+lanRes.male+'</span></label><label class="input-radio-lb" style="color:'+e.visitorInfoLabelColor+'"><input type="radio" class="book-radio '+I+'" name="gender" value="2" '+(2==i?'checked="checked"':"")+' lb="'+l.configDesc+'" /><span class="radio-span">'+lanRes.female+"</span></label>":"maritalStatus"==n?'<label class="input-radio-lb" style="color:'+e.visitorInfoLabelColor+'"><input type="radio" class="book-radio '+I+'" name="maritalStatus" value="1" '+(1==i?'checked="checked"':"")+' lb="'+l.configDesc+'"/><span class="radio-span">'+lanRes.unmarried+'</span></label><label class="input-radio-lb" style="color:'+e.visitorInfoLabelColor+'"><input type="radio" class="book-radio '+I+'" name="maritalStatus" value="2" '+(2==i?'checked="checked"':"")+' lb="'+l.configDesc+'"/><span class="radio-span">'+lanRes.married+"</span></label>":'<input autocomplete="off" type="'+s+'" lb="'+l.configDesc+'" class="book-ipt '+I+'" name="'+n+'" value="'+(i||"")+'" style="border-bottom-color:'+e.visitorInfoInputColor+";color:"+e.visitorInfoInputColor+';"/>')+"</div>"):(f[c].disabled=!0,k++);if(o.default.getStatusByKey("captChaToken")&&(r+='<div class="clearfix"><div class="book-half book-item req" id="verifyInner"><label class="book-label" style="color:'+e.visitorInfoLabelColor+'"><span class="req-span color0">*</span><span class="name-span">'+lanRes.validateCode+'</span></label><input autocomplete="off" type="text" id="verify_input" class="book-ipt req" lb="'+lanRes.validateCode+'" style="border-color:'+e.visitorInfoInputColor+'"/></div><div class="book-half book-item verify-line"><img onerror="this.className=this.className.replace(\'loadin\',\'\')" alt="'+lanRes.validateCode+'" id="verify_img" src="'+m(e)+'"/><span class="color0 cursor-p" id="verify_change">'+lanRes.nextPic+"</span></div></div>"),r+="</div>",r+='<div id="submitBtnentry" style="'+e.visitorInfoSubmitPos+'" class="book-btn"> <span class="book-btn-text">'+(e.visitorInfoSubmitTxt||"")+"</span></div>",r+="</form></div>",$("body").append('<div id="entry" class="entry-wrap0" style="display:block">'+r+"</div>"),$("body").addClass("entry"),1==a.default.windowType&&(y=parseInt(y+.5),b=parseInt(b+.5),k=y-b),k>0&&setTimeout((function(){$(".book-items-list").css("paddingBottom",view.px2rem?view.px2rem(30*k):30*k+"px")}),10),e.visitorInfoSubmitImg){var S=new Image;S.onload=function(){var t=_$("submitBtnentry").style;t.backgroundImage="url('"+e.visitorInfoSubmitImg+"')",t.backgroundSize=(view.px2rem?view.px2rem(this.width):this.width+"px")+" "+(view.px2rem?view.px2rem(this.height):this.height+"px"),t.lineHeight=view.px2rem?view.px2rem(this.height):this.height+"px",t.height=view.px2rem?view.px2rem(this.height):this.height+"px",t.width=view.px2rem?view.px2rem(this.width):this.width+"px",t=null,S=null},S.src=e.visitorInfoSubmitImg}return u({list:f,entry:e,submitSelector:"#submitBtnentry"}),$("#cancelEntryBtn").on("click",p),setTimeout((function(){var e=_$("entryForm").offsetHeight+20+_$("entryForm").offsetTop;_$("entry").style.minHeight=e+"px"}),100),f},d=function(e,t,n,i){var s,l,c,d,f,h,y,b,I=o.default.getConfig("config600").lan||e.lan||"default",k=o.default.getConfig("isVip"),S=2==o.default.getStatusByKey("status"),w=S&&"0"==e.offlineStartType,T='<div class="entry2-item"><div class="entry2-label {{req}}"><span class="req-span">*</span><span class="entry2-name">{{configDesc}}:</span></div><div class="entry2-typeline {{req}}" lb="{{configDesc}}">{{typeline}}</div></div>',C=!0===S?e.upgradeOfflineVisitorInfoConfiguration:e.upgradeVisitorInfoConfiguration,x=C&&C.length||0,E="",M="",P=[],D={};for(!0===S&&(e.upgradeVisitorInfoSubmitTxt=e.upgradeOfflineVisitorInfoSubmitTxt,e.upgradeWelcomeWord=e.upgradeOfflineWelcomeWord),P.push(1!=a.default.windowType||a.default.dji?"entry2-mb":"entry2-pc"),!g&&v&&P.push("entry2-pc-mini"),P.push(w?"entry2-form":"entry2-half"),d=D,f=0;f<i.length;f++)if(c=d[i[f].field]=i[f],s=null,(c=i[f]).settings&&c.settings.length>0)if(1==c.settings.length)c.configs=c.settings[0].configs;else{for(h=0;h<c.settings.length;h++){if(c.settings[h].lan==I){c.configs=c.settings[h].configs;break}"default"==c.settings[h].lan&&(s=c.settings[h].configs)}!c.configs&&(c.configs=s||c.settings[0].configs)}for(y=0;y<x;y++)if(0==(l=C[y]).configWebVipVisitor&&k||0==l.configWebVisitor&&!k)l.disabled=!0;else{if(!D[l.configName]){if(!n){l.disabled=!0;continue}D[l.configName]={type:1}}var _=D[l.configName].type,B=t[l.configName];E=(0,r.getElementByFieldType)(D,_,l,B),M+=T.replace("{{typeline}}",E).replace(/\{\{configName\}\}/g,l.configName).replace(/\{\{configDesc\}\}/g,l.configDesc).replace(/\{\{wordDesc\}\}/g,"").replace(/\{\{value\}\}/g,B||"").replace(/\{\{req\}\}/g,1==l.configRequired?"req":"")}return w&&(M+=T.replace(/\{\{req\}\}/g,"req").replace(/\{\{configDesc\}\}/g,lanRes.leaveWordContent).replace("{{typeline}}",'<textarea autocomplete="off" rows="4" lb="'+lanRes.leaveWordContent+'" autoHeight="true"  class="entry2-textarea leave-entry-text req"></textarea>')),o.default.getStatusByKey("captChaToken")&&(M+=T.replace(/\{\{req\}\}/g,"req").replace(/\{\{configDesc\}\}/g,lanRes.validateCode).replace("{{typeline}}",'<input autocomplete="off" type="text" id="verify_input" lb="'+lanRes.validateCode+'" class="entry2-input entry2-input-code req" /><img alt="'+lanRes.validateCode+'" id="verify_img" src="'+m(e)+'" onerror="this.className=this.className.replace(\'loadin\',\'\')" /><span class="color0 cursor-p" id="verify_change">'+lanRes.nextPic+"</span>")),M='<div id="entry" class="{{entryClass}}"><form id="entryForm" class="entry2-wrap"><div class="entry2-title bg0">{{upgradeWelcomeWord}}</div><div class="entry2-content"><div class="entry2-items">{{list}}</div>{{btns}}</form></div>'.replace("{{entryClass}}",P.join(" ")).replace("{{list}}",M).replace("{{upgradeWelcomeWord}}",e.upgradeWelcomeWord).replace("{{btns}}",1==a.default.windowType&&!a.default.dji&&w?"":'<div class="entry2-submit"><div class="entry2-btn-submit bg0">{{upgradeVisitorInfoSubmitTxt}}</div></div></div>').replace("{{upgradeVisitorInfoSubmitTxt}}",w?lanRes.submit:e.upgradeVisitorInfoSubmitTxt).replace("{{close}}",lanRes.close).replace("{{submit}}",lanRes.submit),w?(1!=a.default.windowType||a.default.dji?$("body").append(M):$("#leave").html(M).removeClass("hide"),$("html").addClass("page-leave entry2"),b=1==a.default.windowType&&!a.default.dji&&w?".leave-enter-btn":".entry2-btn-submit"):($("body").append(M),$("html").addClass("entry2"),$(".entry2-btn-close").on("click",p),b=".entry2-btn-submit"),u({list:C,entry:e,submitSelector:b}),$("textarea[autoHeight]").autoHeight(),C},p=function(e){o.default.setStatusByKey("visitorClose",!1),a.default.publish("chatEnded"),delete a.default.queryParams.autoPop,delete a.default.queryParams.autoChat},u=function(e,t){var n=e.list,s=e.entry,l=e.submitSelector,c=2==o.default.getStatusByKey("status")&&"0"==s.offlineStartType,d=a.default.checkIpt.bind(a.default),u=!1;function f(e){if(u)return!1;var s,l,f,p,h,m,g,v=_$("entryForm"),y={windowType:a.default.windowType},b="",I=!0;for(f=0,s=n.length;f<s;f++)if(null,"",h=n[f].configName,p=v[h],!n[f].disabled){if(l=(m=(0,r.getFormItemValue)(null,p,h)).val,!(I=d(p,l,h,(function(e){p.nodeType?e?$(p).removeClass("error"):$(p).addClass("error"):p[0]&&p[0].nodeType&&$(p[0].parentNode.parentNode).addClass("error")}))&&I))return!1;l&&I&&(b+=m.label+" "+(m.inputValue||l)+"\r\n "),y[h]=l}if(i.default.handleNetwork())return!1;if(y.leaveContent=void 0,c&&(g=$(".leave-entry-text").results[0],d(g,g.value,"content",(function(e){g.nodeType&&(e?$(g).removeClass("error"):$(g).addClass("error"))})),!g.value))return!1;if(o.default.getStatusByKey("captChaToken")){if($("#verify_change").hasClass("loadin"))return!1;var k=$("#verify_input").val();if(!k)return $("#verify_input").addClass("error"),!1;$("#verify_change").addClass("loadin"),y.captcha=k}return y.et=106,"1"==a.default.queryParams.autoPop&&(y.isAutoPop=1),u=!0,o.default.setStatusByKey("visitorEntryInput",{entryParam:y,entryVisitorMsg:b,entryLeaveContent:c?g&&g.value:void 0}),a.default.publish("sendMessage",y,(function(e){e&&e.successful&&t&&t(),o.default.getStatusByKey("captChaToken")&&$("#verify_change").removeClass("loadin"),u=!1})),!1}o.default.getStatusByKey("captChaToken")&&h(),$("input",_$("entryForm")).bind("blur",(function(){var e=this.name,t=(0,r.getFormItemValue)(null,this,e).val;d(this,t,e,(function(e){}))})),$("textarea",_$("entryForm")).bind("blur",(function(){var e=this.value.replace(/^[\s]+|[\s]+$/gi,"");d(this,e,"textarea",(function(e){}))})),$("select",_$("entryForm")).bind("change",(function(){var e=this.value;d(this,e,"select",(function(e){}))})),$(".date-input",_$("entryForm")).bind("change",(function(e){var t=$(".date-show",this.parentNode);t&&t.val(this.value)})),u=!1,_$("entryForm").onsubmit=f,$(l).off("click").on("click",f)},m=function(){return o.default.getVisitorInfo().dataHost+"/chatCaptCha.jpg?captChatToken="+o.default.getStatusByKey("captChaToken")},h=function(e){$(".verify-change").attr("id",""),$(".verify-img").attr("id",""),$(".verify-ok").attr("id",""),$(".verify-input").attr("id",""),y()},c=function(e){$("#entry").html("").addClass("hide"),$(".verify-change").attr("id","verify_change"),$(".verify-img").attr("id","verify_img"),$(".verify-ok").attr("id","verify_ok"),$(".verify-input").attr("id","verify_input"),y(),$("#verify_img").attr("src",m(e)),$("#verify").show(),$("#mask").show()},a.default.subscribe("refreshCode",(function(e,t){$("#verify_change").removeClass("loadin"),0==t.status||1==t.status&&$("#verify_input").addClass("error"),$("#verify_img").attr("src",m(t))})),a.default.subscribe("entryCallback",(function(e,t){if(t.success&&(a.default.publish("changeDom",{name:"#footer",bottom:0,scrollTime:500}),t.mid&&(delete a.default.queryParams.autoPop,delete a.default.queryParams.autoChat),o.default.setStatusByKey("captChaToken",void 0),o.default.setStatusByKey("isInEntryOrCode",!1),t.mt)){a.default.triggerEventOnPoint("registChat",{et:103});var n,i=o.default.getStatusByKey("visitorEntryInput").entryParam,s=o.default.getVisitorInfo(),r="ECHAT_"+s.companyId+"_"+s.visitorId+"_ENTRY_HIS";i&&(delete i.et,delete i.captcha,n=(n=$.store(r))?JSON.parse(n):{},i=$.extend(n,i),$.store(r,JSON.stringify(i)))}})),window.imgLoadResizeSelf=function(e){a.default.px2rem&&(e.style.width=a.default.px2rem(e.naturalWidth||e.width))},window.imgLoadResize=function(e,t){Math.random();var n=-1==t?"entry":"inviteBook"+t,o=-1==t?"entryWrapImg":"inviteBookImg"+t;function i(){var e=1==a.default.windowType?600:260,i=this.naturalWidth||this.width,r=_$(n);r&&(i>e&&(i=e),r.style.width=a.default.px2rem?a.default.px2rem(i):i+"px",console.log('Util.px2rem ? (Util.px2rem(w)) : (w + "px");',a.default.px2rem?a.default.px2rem(i):i+"px"),-1==t&&(r.style.marginLeft=a.default.px2rem?a.default.px2rem(-i/2):-i/2+"px"),$("#"+o).removeClass("hide").css("width",a.default.px2rem?a.default.px2rem(i):i+"px"),s.default.scrollToBottom())}if(e.naturalWidth)i.call(e);else{var r=new Image;r.onload=i,r.src=e.src}}},216:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(3),n(9),n(10);var a=l(n(4)),o=n(13),i=l(n(6)),s=l(n(120)),r=l(n(154));function l(e){return e&&e.__esModule?e:{default:e}}var c,d,u,f,p,h=!1,m={satisfyFocus:!1};function g(e){$("#satisfy").removeClass("satisfy-show").hide(),$("#mask").hide().off("click",g),_$("sa_advise").blur(),$("#footer").removeClass("hide-satisfy"),a.default.publish("changeDom",{name:"#footer",bottom:0}),!0!==e&&(2!=i.default.getStatusByKey("chatStatus")?(a.default.publish("__evaluate","0-2"),a.default.publish("_closeWin")):a.default.publish("__evaluate","0-1"))}function v(e){var t=$(".menu-satisfy"),n="hide",a="limit-hide";1==e?t.addClass(n).removeClass("show"):2==e?t.removeClass(n):3==e?t.addClass(a):4==e?t.removeClass(a):5==e?t.addClass("show").removeClass(n):6==e&&t.hide(),s.default.checkMenuNums()}function y(e){var t=i.default.getEvaluateAndLimit(),n=i.default.getStatusByKey("sendMsgNum");if(t.limit>n&&1==e)return!1;if(p=e,2==e||3==e||d&&!i.default.getStatusByKey("satisfySubmited")){r.default.inputBlur(),u(),s.default.hideMenus();var a=setTimeout((function(){clearTimeout(a),$("#mask").off("click",g).on("click",g).show(),$("#satisfy").show()}),0);return!0}return!1}f=function(e,t,n){function a(e,n){var a,o,i=parseInt(e)-1;if(!t)for(o=$(".sa-sli").results,a=0;a<5;a++)a<=i?$(o[a]).addClass("sa-star").html("&#xe64d;"):$(o[a]).removeClass("sa-star").html("&#xe6cd;");_$("satisfyConfig").className="sa-sel-"+(i+1),n&&$("#satisfy_ipt").val(i+1)}function o(){var e,n,a=parseInt($("#satisfy_ipt").val()||5)-1;if(!t)for(e=$(".sa-sli").results,n=0;n<5;n++)n<=a?$(e[n]).addClass("sa-star"):$(e[n]).removeClass("sa-star");_$("satisfyConfig").className="sa-sel-"+(a+1),$(".sub-tab-sel").removeClass("sub-tab-sel"),$(".sub-tab"+(a+1)).addClass("sub-tab-sel")}n&&$(".sub-tab"+n).addClass("sub-tab-sel"),$(".sa-stars").on("touchstart touchmove touchend",(function(e){var t;if(e.touches&&e.touches.length&&e.clientX)try{t=document.elementFromPoint(e.touches[0].pageX,e.touches[0].pageY)}catch(n){t=document.elementFromPoint(e.clientX,e.clientY)}else;t=t||e.target||e.srcElement,$(t).hasClass("sa-sli")&&a($(t).attr("v"),!0)})),$(".sa-stars").on("touchend",o),$(".sa-imgs").on("touchend",o),$(".sa-imgs").on("touchstart touchmove touchend",(function(e){var t;if(e.touches&&e.touches.length&&e.clientX)try{t=document.elementFromPoint(e.touches[0].pageX,e.touches[0].pageY)}catch(n){t=document.elementFromPoint(e.clientX,e.clientY)}else;t=t||e.target||e.srcElement,($(t).hasClass("sa-un-img")||$(t).hasClass("sa-s-img"))&&a($(t).attr("v"),!0)})),$(".sa-cli").on("click",(function(e){$(this).hasClass("sub-selected")?$(this).removeClass("sub-selected"):$(this).addClass("sub-selected")})),$("#sa_advise").on("focus",(function(e){m.satisfyFocus=!0})).on("blur",(function(e){m.satisfyFocus=!1,_$("satisfyContent").style.marginBottom="0"}))},u=function(){var e,t,n;if($("#sa_advise").val(""),!h)for(e=$(".sa-sli").results,t=0;t<e.length;t++)$(e[t]).addClass("sa-star").html("&#xe64d;");n=$("#satisfyConfig").attr("default"),$("#satisfyConfig").attr("class","sa-sel-"+n),$(".sub-tab-sel").removeClass("sub-tab-sel"),$(".sub-tab"+n).addClass("sub-tab-sel"),$("#satisfy_ipt").val(n)},a.default.subscribe("inviteSatisfy",(function(e,t){y(2),a.default.publish("__newMsg",{f:"s",m:0,c:"[evaluate]:客服邀请您评价"})})),a.default.subscribe("showSatisfy",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return y(t)})),a.default.subscribe("initEvaluate",(function(){var e=i.default.getStatusByKey("sendMsgNum"),t=i.default.getEvaluateAndLimit();if(!t.config)return d=!1,void v(3);t.enable?(d=!0,t.limit>0&&(e<t.limit?v(3):v(4))):(d=!1,v(3)),c||function(e){var t,n,s,r=!1;if(c=!0,(n=(t=h=1==e.evaluateType)?1==e.bestEnable?5:1==e.betterEnable?4:1==e.commonEnable?3:1==e.worseEnable?2:1==e.worstEnable&&1:5)||(n=5,r=!0),$("#satisfy_ipt").val(n),s='<div class="sa-title tc"><div class="sa-title-left"></div><div class="sa-title-content"><span langs="evaluateTip">'+lanRes.evaluateTip+'</span><span class="sa-name sa-name5 emcolor">'+a.default.HTMLDecode(e.bestDesc)+'</span><span class="sa-name sa-name4 emcolor">'+a.default.HTMLDecode(e.betterDesc)+'</span><span class="sa-name sa-name3 emcolor">'+a.default.HTMLDecode(e.commonDesc)+'</span><span class="sa-name sa-name2 emcolor">'+a.default.HTMLDecode(e.worseDesc)+'</span><span class="sa-name sa-name1 emcolor">'+a.default.HTMLDecode(e.worstDesc)+'</span></div><div class="sa-title-right"></div></div>',t&&!r?(s+='<ul class="sa-imgs clearfix">',1==e.worstEnable&&(s+='<li class="sa-img sa-img1" v="1"><img class="sa-s-img" v="1" src="'+e.worstSelected.replace(/^http:/,a.default.needHttps||"http:")+'"/><img class="sa-un-img" v="1" src="'+e.worstUnSelected.replace(/^http:/,a.default.needHttps||"http:")+'"/></li>'),1==e.worseEnable&&(s+='<li class="sa-img sa-img2" v="2"><img class="sa-s-img" v="2" src="'+e.worseSelected.replace(/^http:/,a.default.needHttps||"http:")+'"/><img class="sa-un-img" v="2" src="'+e.worseUnSelected.replace(/^http:/,a.default.needHttps||"http:")+'"/></li>'),1==e.commonEnable&&(s+='<li class="sa-img sa-img3" v="3"><img class="sa-s-img" v="3" src="'+e.commonSelected.replace(/^http:/,a.default.needHttps||"http:")+'"/><img class="sa-un-img" v="3" src="'+e.commonUnSelected.replace(/^http:/,a.default.needHttps||"http:")+'"/></li>'),1==e.betterEnable&&(s+='<li class="sa-img sa-img4" v="4"><img class="sa-s-img" v="4" src="'+e.betterSelected.replace(/^http:/,a.default.needHttps||"http:")+'"/><img class="sa-un-img" v="4" src="'+e.betterUnSelected.replace(/^http:/,a.default.needHttps||"http:")+'"/></li>'),1==e.bestEnable&&(s+='<li class="sa-img sa-img5 sa-sli5" v="5"><img class="sa-s-img" v="5" src="'+e.bestSelected.replace(/^http:/,a.default.needHttps||"http:")+'"/><img class="sa-un-img" v="5" src="'+e.bestUnSelected.replace(/^http:/,a.default.needHttps||"http:")+'"/></li>'),s+="</ul>"):s+='<ul class="sa-stars clearfix"><li class="sa-sli sa-star emcolor" v="1">&#xe64d;</li><li class="sa-sli sa-star emcolor" v="2">&#xe64d;</li><li class="sa-sli sa-star emcolor" v="3">&#xe64d;</li><li class="sa-sli sa-star emcolor" v="4">&#xe64d;</li><li class="sa-sli sa-star emcolor sa-sli5" v="5">&#xe64d;</li></ul>',!t||!r){s+='<div class="sub-tabs clearfix " >',s+="<div>";var l,d,u,m,v,y=["worstConfiguration","worseConfiguration","commonConfiguration","betterConfiguration","bestConfiguration"];for(l=5;l>0;l--){for(s+='<ul class="sub-tab sub-tab'+l+'" '+((v=(u=e[y[l-1]]||[]).length)>0?"":'style="display:none"')+' id="subEvaluate'+l+'"> ',d=0;d<v;d++)s+='<li class="sa-cli" dataname="'+(m=u[d]).configName+'">'+a.default.HTMLDecode(m.configDesc)+"</li>";s+="</ul>"}s+="</div>",s+="</div>"}$("#satisfyConfig").html(s).addClass("sa-sel-"+n).attr("default",n),f(r,t,n),$("#sa_ok").on(a.default.isMobile?"touchend":"click",(function(e){if((0,o.handleNetwork)())return!1;a.default.isMobile&&e.preventDefault();var t,n,s,l=a.default.HTMLDecode($("#sa_advise").val()),c=$("#satisfy_ipt").val(),d="";if("0"!=c&&c){if(!r&&(n=(t=$(".sa-cli",_$("subEvaluate"+c)).results||[]).length)>0)for(s=0;s<n;s++)d+="&"+[$(t[s]).attr("dataname")]+"="+($(t[s]).hasClass("sub-selected")?1:0);var u=i.default.getVisitorInfo(),f=i.default.getStatusData(),h=i.default.getConfig("config672")||{},m=u.dataHost+"/ces?companyId="+u.companyId+d+a.default.addMapParams({talkId:f.talkId,visitorId:u.visitorId,appId:u.appId,nonce:h.nonce,reChatTag:h.reChatTag,mainItem:c,evaluateType:p,comment:l,media:u.media,windowType:a.default.windowType,lan:u.lan});console.log("评价 url***",m),$.ajax({url:m,type:"jsonp",jsonpCB:"jsonpCallback",success:function(e){if(console.log(e),i.default.setStatusByKey("satisfySubmited",i.default.getStatusByKey("talkId")),1==e)c,a.default.showTip(lanRes.successSubmitEval,"ok"),0==i.default.getStatusByKey("chatStatus")?a.default.publish("__evaluate","1-2"):a.default.publish("__evaluate","1-1"),l&&a.default.publish("__evaluateComment",{comment:l,chatting:2==i.default.getStatusByKey("chatStatus")}),0==i.default.getStatusByKey("chatStatus")&&a.default.publish("_closeWin");else{var t=lanRes.unkownErrorSubmitEval;129==e?t=lanRes.evaluateTimeout:130==e?t=lanRes.evaluateRepeat:133==e&&(t=lanRes.evaluateRepeatTime),a.default.showTip(t)}},error:function(){a.default.showTip(lanRes.unkownErrorSubmitEval)}}),g(!0)}})),$("#sa_cancel").on(a.default.isMobile?"touchend":"click",(function(e){g(),a.default.isMobile&&e.preventDefault()}))}(t.config)}));var b=m;t.default=b},217:function(e,t,n){"use strict";n(3),n(9),n(28),n(26),n(67),n(10),n(24),n(39);var a=r(n(4));n(155),n(156);var o=r(n(6));n(158);var i=n(13),s=n(157);function r(e){return e&&e.__esModule?e:{default:e}}var l,c,d,u=window.fileUtil,f=(!a.default.isMobile&&a.default.windowType,u.orderUploadData),p=[];a.default.subscribe("enterWorkorder",(function(e,t){var n,i,r,d,f,p="",h="",m=[],g=o.default.getConfig("config600"),v=o.default.getVisitorInfo(),y=t.jobWindowInfo,b=y.configuration;for(u.setParamData({token:y.token,nonce:y.nonce,visitorId:v.visitorId,companyId:v.companyId,apiServerDomain:o.default.getApiDomain()}),m.push(1!=a.default.windowType||a.default.dji?"entry2-mb":"entry2-pc"),!a.default.isMobile&&a.default.mini&&m.push("entry2-pc-mini"),m.push("entry2-form"),$("#orderSubmit")&&$("#orderSubmit").remove(),n='<div id="orderSubmit" class="{{entryClass}} order-form"><header class="ordertitle"><div class="margin-b5" style="font-size: 14px;">{{title}}</div><div class="order-tip">{{description}}</div></header><div class="entry2-wrap entry2-items order-content"><form id="orderForm">{{element}}</form><span class="order-button magr0 bg-c order-upload-button"><form class="order-upload" name="orderUploadForm" id="orderUploadForm" enctype="multipart/form-data" method="post"><input type="file" title="'+lanRes.visitor189+'" name="file" id="orderUpload">'+lanRes.visitor189+'</form></span><div id="orderFileslist" class="order-fileslist"></div><div class="order-tip">'+lanRes.visitor178+'</div></div><footer class="order-footer"><span class="order-submit order-button bg0">{{submit}}</span></footer></div>',i='<div class="entry2-item"><div class="entry2-label {{req}}"><span class="req-span">*</span><span class="entry2-name">{{configDesc}}:</span></div><div class="entry2-typeline {{req}}" lb="{{configDesc}}">{{typeline}}</div></div>',r=0;r<b.length;r++)d=b[r],c(d.configName,y.fieldSettings,d.lan,(function(e,t,n){var a=t.type;p=(0,s.getElementByFieldType)(e,a,d,""),h+=i.replace("{{typeline}}",p).replace(/\{\{configName\}\}/g,d.configName).replace(/\{\{configDesc\}\}/g,d.configDesc).replace(/\{\{wordDesc\}\}/g,d.wordDesc).replace(/\{\{value\}\}/g,"").replace(/\{\{req\}\}/g,1==d.configRequired?"req":"")}));if(f=a.default.SDKNative?"jpg，png，gif，bmp，avi，mov，rmvb，rm，flv，mp4，3gp":"jpg，png，gif，txt，rar，zip，doc，docx，xls，xlsx，bmp，avi，mov，rmvb，rm，flv，mp4，3gp",h=n.replace("{{entryClass}}",m.join(" ")).replace("{{element}}",h).replace(/\{\{title\}\}/g,y.title).replace(/\{\{description\}\}/g,y.description).replace(/\{\{cancel\}\}/g,lanRes.cancel).replace(/\$\{uploadFileSize\}/g,g.uploadFileSize/1024/1024).replace(/\$\{filesTip\}/g,f).replace(/\{\{submit\}\}/g,lanRes.submit),1!=a.default.windowType||a.default.dji?$("body").append(h):$("#leave").html(h).removeClass("hide"),(0,s.resetOptionField)(y.fieldSettings,"workorder",y),a.default.isMobile&&$("#orderSubmit").off("click").bind("click","img",(function(e){setTimeout((function(){}),500)})),a.default.isMobile||1!=a.default.windowType||a.default.dji)self===window.top&&($(".btn-close").addClass("hide"),setTimeout((function(){$(".btn-close").addClass("hide")}),100)),$("#chat").addClass("hide");else{$("#chat").addClass("hide"),$("#orderSubmit footer").remove(),window.opener||($(".btn-close").addClass("hide"),setTimeout((function(){$(".btn-close").addClass("hide")}),100));var I='<div class="order-submit order-button bg0">'+lanRes.submit+"</div>";$(".leave-entry-foot").html(I)}$("html").addClass("page-leave entry2"),$("#footer").addClass("hide"),setTimeout((function(){$("#mask").hide()}),100),$("#orderUpload").off("click").bind("click",(function(e){e.stopPropagation()})),u.bindOrderUpload(".order-upload-button","#orderUpload"),l(b,".order-submit")})),c=function(e,t,n,a){var o,i,s,r,l,c={};for(n=n||"default",r=0;r<t.length;r++){if(i=null,(o=c[t[r].field]=t[r]).settings&&o.settings.length>0)if(1==o.settings.length)o.configs=o.settings[0].configs;else{for(l=0;l<o.settings.length;l++){if(o.settings[l].lan==n){o.configs=o.settings[l].configs;break}"default"==o.settings[l].lan&&(i=o.settings[l].configs)}!o.configs&&(o.configs=i||o.settings[0].configs)}t[r].field===e&&(s=t[r])}a&&a(c,s,i)},l=function(e,t){var n=a.default.checkIpt.bind(a.default),r=!1,l=_$("orderForm");function c(e,t){var n=o.default.getConfig("config649"),i=o.default.getVisitorInfo(),s="1"===n.jobWindowInfo.jobQRCodeEnable;$.ajax({url:o.default.getApiDomain()+"/chatapi/jobh/cmj?companyId="+i.companyId+"&requesterVisitorId="+i.visitorId+a.default.addMapParams(e),type:"jsonp",jsonpCB:"jsonpCallback",success:function(e){e.successful?(t&&t(!0),d(e.result.data,s)):(t&&t(!1),a.default.showDialog({tip:e.errorMsg,cancel:!1}))}})}function h(t){if(t.stopPropagation(),r)return!1;var d,h,m,g,v,y,b,I=l,k={},S=!0,w=!0,T=o.default.getConfig("config649"),C=o.default.getConfig("config600"),x=T.jobWindowInfo,E=(0,i.getParamChat)();for(h=0,m=e.length;h<m;h++)if(null,"",y=(g=e[h]).configName,v=I[y],!e[h].disabled){if(d=(0,s.getFormItemValue)(I,v,y).val,!(S=n(v,d,y,(function(e){v.nodeType?e?$(v).removeClass("error"):$(v).addClass("error"):v[0]&&v[0].nodeType&&$(v[0].parentNode.parentNode).addClass("error")}))&&S))return!1;k[y]=d}if((0,i.handleNetwork)())return!1;if(k.routeId=T.routeId,k.token=x.token,k.nonce=x.nonce,k.styleId=T.styleId,k.jobTemplateId=x.jobTemplateId,k.requesterLan=C.lan,a.default.SDKNative&&f.length>0)k.attachments=[],p=[],w=u.getSubmitItems(k.attachments),k.attachments=JSON.stringify(k.attachments);else if(p.length>0){for(k.attachments=[],b=0;b<p.length;b++)(g=p[b]).name=encodeURIComponent(g.name),g.fileValue?k.attachments.push({type:g.type,fileValue:g.fileValue}):w=!1;k.attachments=JSON.stringify(k.attachments)}if(E.acdStaffId&&(k.acdStaffId=E.acdStaffId),E.acdType&&(k.acdType=E.acdType),r=!0,w)return c(k,(function(e){r=!!e})),!1;a.default.showDialog({tip:lanRes.visitor190,ok:function(){for(b=0;b<p.length;b++)p[b].xhr&&p[b].xhr.abort();c(k,(function(e){r=!!e}))},cancel:function(){r=!1}})}$(".entry2-input",l).bind("blur",(function(){var e=this.name,t=(0,s.getFormItemValue)(l,this,e).val;n(this,t,e,(function(e){}))})),$("textarea",l).bind("blur",(function(){var e=this.value.replace(/^[\s]+|[\s]+$/gi,"");n(this,e,"textarea",(function(e){}))})),$("input",l).bind("change",(function(){var e=this.name,t=(0,s.getFormItemValue)(l,this,e).val;n(this,t,e,(function(e){}))})),$("select",l).bind("change",(function(){var e=this.value;n(this,e,"select",(function(e){}))})),$(".date-input",l).bind("change",(function(e){var t=$(".date-show",this.parentNode);t&&t.val(this.value)})),_$("orderForm").onsubmit=h,$(t).off("click").bind("click",h)},d=function(e,t){if(e.codeUrl){$("html").removeClass("entry2"),$("html").removeClass("page-leave"),$("#orderSubmit")&&$("#orderSubmit").remove();var n=t?e.codeUrl:locationBase+"/res/imgs/"+(a.default.SDK?"order_sdk.png":"order_web.png"),o=t?"order-complete":"order-complete-auto",i=t?'<div class="tip2">'+lanRes.visitor184+"</div>":"",s='<div id="orderSubmit"><div class="'+o+'"><img src="'+n+'" /><div class="tip1">'+lanRes.visitor183+"</div>"+i+"</div></div>";1==a.default.windowType?$("#leave").html(s).removeClass("hide"):$("body").append(s),$(".leave-entry-foot")&&$(".leave-entry-foot").remove()}}},218:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(24),n(3),n(9),n(45),n(47),n(49),n(37),n(20),n(31),n(63);var a,o,i,s,r,l=m(n(4)),c=m(n(6)),d=n(13),u=m(n(93)),f=m(n(118)),p=m(n(53)),h=m(n(52));function m(e){return e&&e.__esModule?e:{default:e}}function g(){var e=c.default.getStatusData();return 2==e.chatStatus&&e.talkType==l.default.Constants.talkTypeRobot}function v(){l.default.publish("changeDom",{name:"#inputSuggest",cls:"hide",html:" "})}i=function(){var e,t,n,a=c.default.getMsgList(),o=c.default.getStatusData().talkId;for(n=a.length-1;n>=0;n--)if(t=(e=a[n]).data.mt,e.data.talkId==o)12001==t&&h.default.updateMsg(e);else if(e.data.talkId&&e.data.talkId!=o)break},r=function(e){c.default.setConfigs({hasSearchInSameScreen:"1"==e.enableSearchInTheSameScreen,hasInputAssociation:"1"==e.enableInputAssociate}),$("#inputLengthTip").html(lanRes.inputLengthTip1+Math.min(c.default.getConfig("inputMaxLength"),c.default.getConfig("maxRobotLength"))+lanRes.inputLengthTip2),l.default.publish("clearSendingMsg","robot"),l.default.queryParams.autoPop&&delete l.default.queryParams.autoPop,l.default.queryParams.autoChat&&delete l.default.queryParams.autoChat,s&&s(),l.default.subscribe("_sendQuestion",(function(e,t){var n={et:130,docId:t.docId,originDocId:t.originDocId,content:t.content};(0,f.default)(n),v()})),l.default.publish("__setTitle",c.default.getRobotInfo().name)},s=function(){function e(e,t){var n=function(e,t){var n=(0,d.getMsgByDom)(e);if(n){var a=n.allExtra.h5Extra||{},o=a.feedback,i=a.feedbackSubitem;if(!(t&&i||!t&&o))return n}}(e,t);if(n&&2==c.default.getStatusByKey("chatStatus")&&c.default.getStatusByKey("talkType")==l.default.Constants.talkTypeRobot&&n.talkId==c.default.getStatusByKey("talkId")){var a=n.knowledgeAnswerList[0],o=$(e).parents(".robot-feedback"),i=$(e).attr("type")||void 0,s=t?$(e).text():void 0,r=a.docId,u=a.queryId,f=a.robotDetailId,h=a.searchId,m=a.originQuestion;l.default.publish("sendMessage",{et:133,feedBack:i,feedBackSubitem:s,docId:r,queryId:u,robotDetailId:f,searchId:h,originQuestion:m}),l.default.publish("setExtraMessage",n,{feedback:i,feedbackSubitem:s}),t?(o.addClass("robot-feedback-sub-had"),$(e.parentNode).addClass("feedback-sub-sel"+i)):(o.addClass("robot-feedback-had robot-feedback-had"+i),$(e).addClass("feedback-btn-"+(1==i?"solve":"unsolve")+"-sel")),p.default.scrollToElement($(e).parents(".msgli").attr("id"))}}s=null,$("#list_msg").on(l.default.clickName,".common-ques-li",(function(e){l.default.publish("_sendQuestion",{docId:$(this).attr("did"),content:unescape($(this).attr("ques"))})})),$("#robotToStaffWord").on(l.default.clickName,(function(){g()&&l.default.publish("sendMessage",{et:131}),u.default.input.inputBlur()})),$("#inputSuggest").on(l.default.clickName,".ipt-list-li",(function(e){if(!(0,d.handleNetwork)()&&(u.default.input.setInput(unescape($(this).attr("ques"))),g())){l.default.publish("_sendQuestion",{docId:$(this).attr("did"),content:unescape($(this).attr("ques"))});u.default.input.getInput(!0)}})),$("#list_msg").on(l.default.clickName,".question-list-li",(function(e){var t=(0,d.getMsgByDom)(this);if(t){var n=t.knowledgeAnswerList[0],a=n.docId,o=n.relateKnowledges&&n.relateKnowledges.length?n.relateKnowledges:n.suggestions,i=$(this).attr("index"),s=o[parseInt(i)];l.default.publish("_sendQuestion",{docId:s.docId,originDocId:a,content:s.question})}})),$("#list_his").on(l.default.clickName,".feedback-btn-unsolve",(function(t){e(this)})).on(l.default.clickName,".feedback-btn-solve",(function(t){e(this)})).on(l.default.clickName,".feedback-sub-content",(function(t){e(this,!0)}))},o=function(){var e;return l.default.subscribe("__visitorSendMsg",v),function(){var t=u.default.input.getInput(!1);t||v(),!t||a==t&&e==t||(a=t,(0,f.default)({et:132,content:a})),e=t}},l.default.subscribe("getMsgRobot",(function(e,t){if(function(e){if(1!=e.isForward||207==e.result){var t=c.default.getStatusData();if(2==t.chatStatus&&t.talkType==l.default.Constants.talkTypeRobot&&e.talkId==t.talkId)return!0}}(t)){var n,o,i,s,r,d,u,f,p,h,m=t.knowledgeAnswerList||[],g="",v=!1,y=0;if(4!=t.type)3!=t.type||(204==t.result||205==t.result?(c.default.setVisitorInfo({robotToHumanKey:t.robotToHumanKey}),l.default.triggerEventOnPoint("registChat",{robotToHumanKey:t.robotToHumanKey})):207==t.result&&l.default.publish("changeDom",{name:"#robotToStaff",removeCls:"hide"}));else{for(i=t.segWords,r=0;r<m.length;r++){if(o=(n=m[r]).question,v=!1,o==a){r++,y=1,g='<div class="ipt-list"><a class="ipt-list-li" did="'+n.docId+'" ques="'+escape(n.question)+'"><b class="words-seg">'+o+"</b></a>";break}if(i)for(0,d=0;d<i.length;d++)s=i[d],s=l.default.escapeRegExp(s),o=o.replace(new RegExp(s,"igm"),(function(e,t){if(v=!0,!((f=arguments[(u=arguments.length)-2])>0))return'<b class="words-seg">'+e+"</b>";if(p=arguments[u-1].substring(0,f),h=arguments[u-1].substring(f),s.match(/^s|sp|spa|span$/)&&p.match(/<$/))return e;if(s.match(/^n|an|pan|span$/)){var n="</span>".replace(s,",").split(",");if(p.match(new RegExp(n[0])&&h.match(n[1])))return e}return/(\<span[^>]*>([^<]+(?!\<\/span\>))?$)|(\<[a-zA-Z]+[^>]*$)/gi.test(p)?e:'<b class="words-seg">'+e+"</b>"}));v&&(y++,g+='<a class="ipt-list-li" did="'+n.docId+'" ques="'+escape(n.question)+'">'+o+"</a>")}y>0?l.default.publish("changeDom",{name:"#inputSuggest",removeCls:"hide",html:g+"</ul>"}):l.default.publish("changeDom",{name:"#inputSuggest",cls:"hide",html:" "})}}}));var y={init:function(e){var t=!1;e.subscribe("startRobot",(function(){var n=c.default.getConfig("config649");e.unSubscribe("textInputChangeEvt"),"1"==n.enableInputAssociate&&e.subscribe("textInputChangeEvt",(0,d.throttle)(o(),1e3)),r(n),t||(t=!0,2==c.default.getStatusData().fisrtChatstatus&&i()),c.default.setStatusByKey("statusName","robot"),l.default.publish("__chatStatus","robot")})),e.subscribe("endRobot",(function(){l.default.unSubscribe("_sendQuestion"),c.default.getStatusData().talkType==l.default.Constants.talkTypeRobot&&($(".robot-feedback").each((function(e,t){$(t).hasClass("robot-feedback-had")?$(t).hasClass("robot-feedback-sub-had")||($(".feedback-sub-solved",t).remove(),$(".feedback-sub-unsolved",t).remove()):$(t).remove()})),p.default.refreshChatScroll())}))}};t.default=y},219:function(e,t,n){"use strict";n(38),n(26),n(42),n(18),n(50),n(27),n(51),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(10),n(3),n(9),n(24);var a,o,i=d(n(4)),s=d(n(6)),r=n(13),l=d(n(52)),c=d(n(93));function d(e){return e&&e.__esModule?e:{default:e}}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(){a&&clearInterval(a),o&&l.default.removeMsg(o)}function h(e,t){var n,i=lanRes.staffInput,s=0;p(),function e(){if(s>5)return p();var o;switch(s%3){case 0:o=i+"&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";break;case 1:o=i+"&nbsp;.&nbsp;.&nbsp;&nbsp;&nbsp;";break;case 2:o=i+"&nbsp;.&nbsp;.&nbsp;.&nbsp;"}s++,(n=_$("serviceTypingLine"))&&$(".msg-item",n).html(o),t.content=o,!l.default.updateMsg(t)&&l.default.showMsg(t),a=setTimeout(e,500)}(),o=t}var m={init:function(e){e.subscribe("startChat",(function(){var t;i.default.publish("__chatStatus","chatting"),s.default.setStatusByKey("statusName","chatting"),delete i.default.queryParams.autoPop,delete i.default.queryParams.autoChat,i.default.publish("__chatStart",s.default.getStaff().name),e.subscribe("getMsgTyping",h),e.subscribe("clearMsgTyping",p),e.unSubscribe("textInputChangeEvt"),e.subscribe("textInputChangeEvt",(0,r.throttle)((t=null,function(){var e=c.default.input.getInput(!1),n=e;function a(e){i.default.publish("sendMessage",{et:104,content:e})}e&&(e=e.replace(/^[\n\r\s]+$/,""))&&t!=e&&(t=e,c.default.input.plainText&&(n=(0,r.plainTextToSendMsg)(e)),1!=i.default.filterMsg&&3!=i.default.filterMsg||!n?a(n):i.default.filterAndSendToServer({},(function(e,t,n){n||a(t)}),n))}),1e3)),i.default.publish("initEvaluate")})),e.subscribe("startQueue",(function(){i.default.publish("__chatStatus","waiting"),s.default.setStatusByKey("statusName","waiting"),i.default.publish("__setTitle",lanRes.waitting)})),e.subscribe("getPosMsg",(function(e,t){var n=s.default.getConfig("config649"),a=n.queueTxt||n.mobileQueueTxt;(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t)).id="positionInfo",t.content=a.replace("${waitcount}",t.position),l.default.removeMsg(t),l.default.showMsg(t),i.default.publish("__chatQueue",t.position)}))}};t.default=m},220:function(e,t,n){"use strict";n(38),n(26),n(42),n(50),n(51),n(67),n(90),n(68),n(91),n(92),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(18),n(27),n(3),n(20),n(10),n(9),n(65),n(153);var a=f(n(44)),o=f(n(4)),i=n(13),s=f(n(6)),r=f(n(221)),l=f(n(222)),c=f(n(52)),d=f(n(223));n(158),n(224);var u=["data","sendStatus"];function f(e){return e&&e.__esModule?e:{default:e}}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y,b,I,k,S,w,T,C,x=o.default.Constants,$=window.fileUtil,E=a.default.callEchatNativeConnect,M=!0,P=!1;function D(e){e?(s.default.setDataByName("hasPreHistory",!0),o.default.publish("changeDom",{name:"#pre_his",removeCls:"hide"})):(s.default.setDataByName("hasPreHistory",!1),o.default.publish("changeDom",{name:"#pre_his",cls:"hide"}))}function _(e){return o.default.isArray(e)||(e=[e]),e.forEach((function(e){e.data||(e.data=g({},e)),!e.data.tm&&e.createTime&&(e.data.tm=e.createTime),e.data.et&&(e.data.et=parseInt(e.data.et)),e.data.mt&&(e.data.mt=parseInt(e.data.mt)),e.data.id||(e.data.id=e.echatId),e.data.visitorId&&e.data.visitorId!=e.visitorId&&(e.data.visitorId=e.visitorId),e.data.isForward=e.isForward,!e.data.bridgeMsgId&&e.bridgeMsgId&&(e.data.bridgeMsgId=e.bridgeMsgId);e.data;var t=e.sendStatus,n=h(e,u);return e.data.allExtra=n||{},void 0===e.data.sendStatus&&(e.data.sendStatus=t),e.data.allExtra.h5Extra=e.data.allExtra.h5Extra||{},e})),e}function B(e,t){var n=(e=_(e)[0]).data,a=s.default.getStatusByKey("isInWorkOrder"),o=s.default.getMsgFromHistory(n.clientFileId);if(o){if(o.msg.sendStatus==x.sendStatus.success)return;s.default.updateMsgByIndetity(n.clientFileId,n)}else e.data.isInWorkOrder=a,s.default.updateMsgList(e,"push");if(a)return"prepareUpload"==t?$.prepareAddOrderFile(n):"uploadSuccess"==t?$.successOrderFile(n):$.updateOrderFile(n);o?c.default.updateMsgProgress(n):c.default.showMsg(n)}function N(e,t){return function(n){!(e=e.replace(n+",",""))&&t&&(t(),t=null)}}function O(){var e=s.default.getMsgListFirst()||{};e&&s.default.setDataByName("historyLastEchatId",e.echatId),E("getChatMessage",{mid:e.mid,visitorId:s.default.getVisitorInfo().visitorId,companyId:T,selectCount:20})}$.setUtil(o.default),$.setNative(a.default.callEchatNative),y={forwardConfigMessage:function(e){if(e&&o.default.isArray(e)&&0!=e.length){var t,n,a=s.default.getConfig("config600").mt,i=s.default.getConfig("config649").mt;for(n=0;n<e.length;n++)if((t=e[n].data).visitorId!=e[n].visitorId&&(t.visitorId=e[n].visitorId),t.mt=parseInt(t.mt),s.default.setConfig("config"+t.mt,t),600==t.mt){var r=t,c=r.city,d=r.province,u=r.country,f=r.photo,p=r.visitorId,h=r.firstUrl,m=r.keyword,g=r.referrer,v=r.searcher,y=r.apiServerDomain;s.default.setVisitorInfo({city:c,province:d,country:u,firstUrl:h,keyword:m,referrer:g,searcher:v,photo:f,apiServerDomain:y,visitorId:p}),s.default.setConfigs({inputMaxLength:"1"==t.limitVisitorInputContentLengthEnable?t.visitorInputContentMaxLength:2e3,companyVersionType:t.companyVersionType,isVip:1==t.visitorType})}else 649==t.mt?((a||1==s.default.getStatusByKey("chatStatus"))&&(0,l.default)(t),(!i&&s.default.getStatusByKey("chatStatus")<=1||i&&2==s.default.getStatusByKey("chatStatus"))&&o.default.publish("setTheme",t)):(0,l.default)(t);((i=s.default.getConfig("config649").mt)||2!=s.default.getStatusByKey("chatStatus"))&&(I("forwardConfigMessage"),S("forwardConfigMessage"),k("forwardConfigMessage"))}},forwardStaffInfo:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n={};for(e=0;e<t.length;e++)n[t[e].staffId]=t[e];s.default.setStaffInfo(n),I("forwardStaffInfo"),S("forwardStaffInfo")},forwardHistoryMessage:function(e){return e&&o.default.isArray(e)||(e=[]),e=_(e),C&&e.length&&(e[e.length-1].mid<=C.mid||e[e.length-1].echatId<=C.echatId)?(C=void 0,void o.default.publish("checkHistory",e)):(s.default.updateMsgList(e,"unshift"),e.length<20&&D(!1),M?(S("forwardHistoryMessage"),void k("forwardHistoryMessage")):void e.reverse().forEach((function(e){return(0,l.default)(e.data)})))},forwardChatMessage:function(e){!e||o.default.isArray(e)&&!e.length||(e=_(e),s.default.updateMsgList(e,"push"),e.forEach((function(e){return(0,l.default)(e.data)})))},forwardMessageCallback:function(e){if(e){var t=e.successful,n=e.bridgeMsgId;null!=p(t)&&n&&(s.default.updateMsgByIndetity(e.bridgeMsgId,{mid:e.mid,sendStatus:x.sendStatus.success}),d.default.callback(e))}},nativeReady:function(e){s.default.setVisitorInfo(e),P&&w.noVisitorInfoReinit(),I("nativeReady")},forwardChatStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=s.default.getStatusData(),n=-1==t.fisrtChatstatus;if(n&&(e.fisrtChatstatus=e.chatStatus),s.default.setStatusData(e),n||t.chatStatus==e.chatStatus||(console.log("可能是异常状态后，收到了最新的状态",e),b(t,!0)),!n&&0===e.chatStatus&&(1===t.chatStatus&&t.statusName&&t.statusName.match(/entry/)||0===t.chatStatus&&t.statusName&&t.statusName.match(/router/)))return s.default.setConfig("config672",{}),void o.default.publish("chatEnded",s.default.getStatusData(),t.chatStatu);n&&(I("forwardChatStatus"),2==e.chatStatus&&e.talkType==x.talkTypeChat||I("forwardStaffInfo"),k("forwardChatStatus"))},ackChangeStatus:function(e){if(e){var t=s.default.getStatusByKey("websocketStatus");e.successful?(s.default.setDataByName("websocketStatus",x.websocketConnected),(0,i.networkStatusChange)(!0),t!=x.websocketConnected&&setTimeout((function(e){s.default.getStatusByKey("websocketStatus")==x.websocketConnected&&(2==s.default.getStatusByKey("chatStatus")?(d.default.flashMsg(!1),d.default.flashMsg(!0)):d.default.flashMsg(!1))}),1e3)):(s.default.setDataByName("websocketStatus",x.websocketConnecting),t==x.websocketConnecting&&o.default.showTip("正在连接"))}},prepareUpload:function(e){B(e,"prepareUpload")},uploadStart:function(e){B(e)},uploadProgress:function(e){B(e)},uploadSuccess:function(e){B(e,"uploadSuccess")},uploadFailure:function(e){var t=s.default.getMsgFromHistory(e).originData;t.data.sendStatus=x.sendStatus.error,B(t)}},a.default.initNativeAPI(y,"callEchatJsConnect"),k=N("forwardChatStatus,forwardConfigMessage,forwardHistoryMessage,",(function(){var e,t,n=s.default.getStatusData();2==n.chatStatus&&n.talkType==x.talkTypeChat&&((e=(0,i.checkHistory)()).noLimit?e.last673&&(0,l.default)(e.last673):(t=s.default.getMsgListFirst())&&(o.default.subscribe("checkHistory",(function(e,t){var n=(0,i.checkHistory)(t).last673;n&&(0,l.default)(n)})),C=t,s.default.setDataByName("historyLastEchatId",t.echatId),E("getChatMessage",{mid:t.mid,visitorId:s.default.getVisitorInfo().visitorId,companyId:T,selectCount:50})))})),I=N("forwardChatStatus,forwardConfigMessage,forwardStaffInfo,nativeReady,",b=function(e){var t=s.default.getStatusData();2!=t.chatStatus?1==t.chatStatus&&4!=t.status||(e&&0!=e.chatStatus&&0==t.chatStatus&&o.default.publish("chatEnded",t,e),t.unreadCount>0?(c.default.showMsg({id:"unreadMarkLine",mt:40,tm:(new Date).getTime(),content:'<div class="tc color1"><i class="hr-left"></i> <span>您有'+t.unreadCount+'条未读消息</span> <i class="hr-right"></i></div>'}),o.default.publish("enterUnread")):e||o.default.triggerEventOnPoint("registChat")):t.talkType==x.talkTypeChat?(o.default.publish("startChat"),o.default.publish("updateChatStaffInfo")):t.talkType==x.talkTypeRobot?o.default.publish("startRobot"):t.talkType==x.talkTypeLeave?o.default.publish("startLeave"):t.talkType==x.talkTypeQueue&&o.default.publish("startQueue")}),S=N("forwardHistoryMessage,forwardStaffInfo,forwardConfigMessage,",(function(){M=!1;var e=s.default.getMsgList(),t=!1;D(e.length>=20),o.default.publish("changeDom",{name:"#content",cls:"fading"}),e.forEach((function(e){!t&&0===e.isForward&&e.data.mt&&(t=!0,c.default.showMsg({id:"unreadMarkLine",mt:40,tm:(new Date).getTime(),content:'<div class="tc color1"><i class="hr-left"></i> <span>以下是未读消息</span> <i class="hr-right"></i></div>'})),(0,l.default)(e.data)})),setTimeout((function(e){o.default.publish("changeDom",{name:"#content",removeCls:"fading"})}),100)})),o.default.subscribe("loadHistory",O),o.default.subscribe("setExtraMessage",(function(e,t,n){if(n){var a,o=t.allExtra.h5Extra;for(a in o&&(n=Object.assign(o,n)),n)void 0!==n[a]&&s.default.updateHistoryMsgExt(t.mid||t.bridgeMsgId,a,n[a]);E("setExtraMessage",{companyId:T,visitorId:s.default.getVisitorInfo().visitorId,rowId:t.allExtra.echatId,bridgeMsgId:t.allExtra.bridgeMsgId,h5Extra:n})}})),w={callNative:E,getInitVisparam:function(){var e=s.default.getVisitorInfo();return{visitorId:e.visitorId,companyId:e.companyId}},pageReady:function(){var e,t,n=this.getInitVisparam();if(n.companyId&&(T=n.companyId,a.default.setCurrentCompanyId(T)),!T)throw"没有初始化公司ID";P=!n.visitorId,n.visitorId&&E("getChatMessage",g(g({},n),{},{selectCount:20})),E("pageReady"),n.visitorId&&E("getConfigMessage",n),E("getStaffInfo",n),o.default.publish("_changeCloseBtn","0"),(e=o.default.getQueryString("noConsole"))&&"1"==e&&(t=0,r.default.map((function(e){t+=e.delay||200,"evt"==e.type?setTimeout(e.value,t):setTimeout((function(){window.callEchatJsConnect(e)}),t)})))},noVisitorInfoReinit:function(){E("getConfigMessage",this.getInitVisparam()),O()},init:function(){}},o.default.subscribe("setChatStatus",(function(e,t){var n=s.default.getVisitorInfo(),a=n.visitorId,o=n.companyId;E("setChatStatus",{visitorId:a,companyId:o,chatStatus:t||1}),s.default.setStatusData({chatStatus:t})})),o.default.subscriber.call(w,"connect"),w.setSub("handle"),w.subscribe("sendMessage",d.default.send);var L=w;t.default=L},221:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=[{functionName:"nativeReady",value:{echatTag:"lh"}},{functionName:"forwardChatStatus",value:{canChatNow:1,chatStatus:2,companyId:1801,createTime:1611314968129,echatId:3,staffId:85,status:1,talkId:"1607",talkType:1,unreadCount:0,updateTime:1611563750773,visitorId:"sdk11632"}},{functionName:"forwardConfigMessage",value:[{companyId:1801,createTime:1611314960781,data:{apiServerDomain:"devapi.rainbowred.com",bin:2,companyId:1801,companyName:"dev平台",companyVersionType:2,encryptVID:"hu1B6/aiGzA=",fileUploadInfos:[{fileBucketDomain:"http://tqn.rainbowred.com/",fileBucketHttpsDomain:"https://tqn.rainbowred.com/",fileUploadHttpsUrl:"https://up-z2.qbox.me/",fileUploadParam:"key=${qiniuKey},token=${token}",fileUploadUrl:"http://up-z2.qiniu.com/",uploadServiceType:1},{fileUploadHttpsUrl:"https://test-release-02.oss-cn-hangzhou.aliyuncs.com",fileUploadParam:"key=${aliyunKey},success_action_status=200,Content-Disposition=${Content-Disposition},OSSAccessKeyId=${ossAccessKeyId},policy=${policy},Signature=${signature},callback=${callback},x:filename=${x:filename}",fileUploadUrl:"http://test-release-02.oss-cn-hangzhou.aliyuncs.com",uploadServiceType:2},{fileBucketDomain:"http://devfile.rainbowred.com/",fileBucketHttpsDomain:"https://devfile.rainbowred.com/",fileUploadHttpsUrl:"https://dev.rainbowred.com/fup",fileUploadParam:"token=${token},uploadServiceType=${uploadServiceType}",fileUploadUrl:"http://dev.rainbowred.com/fup",uploadServiceType:3}],lan:"zh",mid:36425,mst:3,mt:"600",platformId:1801,platformName:"dev平台",rph:0,sdkHtmlForceUpdate:0,sdkHtmlVersion:"1.4.16.9",sessionId:"1p535n2uinyjdipi86ek22whlo",tm:1611563749436,uploadFileSize:524288e3,uploadFileType:"txt,doc,docx,xls,xlsx,amr,mp3,mp4,rar,zip,pdf,wav,log,mov,ppt,pptx,3gp,aac,ogg,webm,ts,3g2,3gpp,3gpp2,avi,m4v,mkv,ogg,webm,log,jpg,png,gif,jpeg,webp,bmp",vcs:0,visitorId:"sdk11632",visitorInputContentMaxLength:350,visitorSessionSize:0,visitorType:2},echatId:7,isForward:1,isPublic:1,mt:"600",updateTime:1611563748918,visitorId:"sdk11632"},{companyId:1801,createTime:1611314968156,data:{bin:2,canChatNow:1,chatStatus:0,companyId:1801,echatSourceTagEnable:"1",enableEchatHyperlink:"1",enableEchatUrl:"1",eventId:"5du3pjImczU=",media:"6",mid:36368,mst:3,mt:"649",notThroughStatus:0,queueTxt:"亲，目前客服全忙，您正排在队列的第${waitcount}位，请稍候……",routeId:"147",rph:0,sdkChatBoxInfo:{busyNotAllowSendStatus:"0",chatAd1Html:"http://devs.rainbowred.com/res/style/e/s1/chat_right_ad.png",chatAdWidth:"349",chatBoxAdHeight:"0",chatBoxAdImgLinkFixed:"1",chatBoxAdImgLinkOpenType:"1",chatBoxInnerAdContent:'<p>fasd </p><p class="ql-align-center">adsf </p><p class="ql-align-center">asd </p><p class="ql-align-center">asdf </p><p class="ql-align-center">asdf asdf </p><p class="ql-align-center"><span class="ql-font-NSimSun">asd </span><u class="ql-font-NSimSun">asdf sadf </u></p>',chatBoxInnerAdImg:"https://devfile.rainbowred.com/group1/M00/00/9C/rBAKCGAIFaGAYy1BAAAVZWq_QqY356.png",chatBoxInnerAdImgLinkOpenType:"1",chatBoxInnerAdImgLinkUrl:"https://www.gerensuodeshui.cn/",chatBoxInnerAdType:"3",chatBoxRightAdImg:"http://devs.rainbowred.com/res/style/e/s1/chat_right_ad.png",chatBoxRightAdType:"3",chatBoxStaffImgEnable:"1",chatBoxTitle:"Echat对话",chatColor:"rgb(224,203,170)",chatEndBtnBackColor:"#484a4a",chatEndBtnTxtColor:"#ffffff",chatLogoImg:"http://devs.rainbowred.com/res/style/e/s1/pc_logo.png",chatStaffBackColor:"rgb(41,207,207)",chatStaffTxtColor:"rgb(255,255,255)",chatThemeBackColor:"rgb(20,32,48)",chatThemeTxtColor:"rgb(255,255,255)",chatVisitorBackColor:"rgb(15,48,136)",chatVisitorTxtColor:"rgb(53,151,48)",defaultStaffImg:"http://devs.rainbowred.com/res/imgs/staff.png",defaultVisitorImg:"http://devs.rainbowred.com/res/imgs/visitor.png",enableChatEndBtn:"1",enableQRCode:"1",qrCodeType:"1",customUrlList:'[{"type":2,"openType":1,"msgContent":"安抚","title":"嗯嗯","openWindowParamList":[]},{"type":2,"openType":1,"msgContent":"阿道夫","title":"阿迪方式","openWindowParamList":[]},{"type":2,"openType":1,"msgContent":"阿斯顿发爱上","title":"阿斯顿发发多少阿斯顿发阿斯顿发","openWindowParamList":[]},{"type":"1","openType":1,"title":"阿迪上发生地方","icon":"","url":"http://172.16.3.16:8186/jenkins/view/test-%E5%89%8D%E7%AB%AF/job/Test-static-visitor/","openWindowParamList":[{"paramName":"staffName"},{"paramName":"talkId"},{"paramName":"chatPageTitle"},{"paramName":"eventId"},{"paramName":"companyId"}]},{"type":"1","openType":2,"title":"baidulaile","icon":"","url":"https://www.baidu.com/","openWindowParamList":[{"paramName":"companyId"},{"paramName":"staffId"}]}]',sdkUrlList:'[{"openType":1,"icon":"https://devfile.rainbowred.com/group1/M00/00/9B/rBAKCF_9H1-AfJ7KAAAdULIOGJI563.png","title":"test","url":"https://www.gerensuodeshui.cn/","openWindowParamList":[{"paramName":"visitorId"},{"paramName":"lan"},{"paramName":"country"},{"paramName":"companyId"},{"paramName":"eventId"},{"paramName":"metaData"},{"paramName":"province"},{"paramName":"myData"},{"paramName":"city"},{"paramName":"osName"},{"paramName":"echatTag"},{"paramName":"talkId"},{"paramName":"staffId"},{"paramName":"staffName"},{"paramName":"staffPhoto"},{"paramName":"staffPhone"},{"paramName":"staffInfo"}]},{"openType":2,"icon":"https://devfile.rainbowred.com/group1/M00/00/9B/rBAKCGAAGHOAQYyxAAAVZWq_QqY230.png","title":"发送消息","url":"http://chats.rainbowred.com/visitor/surfer/test.html?host=chat.rainbowred.com&companyId=1801&dataHost=dev.rainbowred.com","openWindowParamList":[{"paramName":"visitorId"},{"paramName":"lan"},{"paramName":"metaData"},{"paramName":"eventId"},{"paramName":"country"},{"paramName":"city"},{"paramName":"companyId"},{"paramName":"myData"},{"paramName":"province"},{"paramName":"osName"},{"paramName":"echatTag"},{"paramName":"staffPhoto"},{"paramName":"staffPhone"},{"paramName":"staffName"},{"paramName":"talkId"},{"paramName":"staffId"},{"paramName":"staffInfo"}]}]',styleId:"224",sysMsgBackground:"#e9e9e9",sysMsgFontColor:"rgb(181,65,194)",sysMsgIcon:"http://devs.rainbowred.com/res/imgs/sysinfo.png",toolAlbum:"1",toolCamera:"1",toolEmoji:"1",toolFile:"1",toolImg:"1",toolLocation:"1",toolSatisfaction:"1",toolScreenshot:"1",toolTelephone:"1",toolVoice:"1",type:"6",windowTextColor:"rgb(137,70,87)"},sdkEntranceInfo:{captChaEnable:"0",captChaName:"chatWindow",captChaType:"2",enableOffline:"0",enableOnline:"1",entranceLevel:1,entryCanClose:"0",fieldSettings:[{enable:1,field:"vt1",fieldId:789,isSystem:1,label:"来源",lan:"default",settings:[{configs:[{item:"官网对话",sort:1,value:"1"},{item:"官网留言",sort:2,value:"2"},{item:"朋友介绍",sort:3,value:"3"},{item:"上门咨询",sort:4,value:"4"}],lan:"default"}],type:3},{enable:1,field:"name",fieldId:791,isSystem:1,label:"姓名",settings:[],type:1}],lan:"default",offlineNotVipItemSize:0,offlineVipItemSize:0,onlineNotVipItemSize:0,onlineVipItemSize:0,requireCondition:"0",styleId:"224",type:"6",upgradeOfflineNotVipItemSize:0,upgradeOfflineVipItemSize:0,upgradeOnlineNotVipItemSize:2,upgradeOnlineVipItemSize:2,upgradeVisitorInfoConfiguration:[{configDesc:"来源",configName:"vt1",configRequired:"0",configSort:"0",configWebVipVisitor:"1",configWebVisitor:"1"},{configDesc:"姓名",configName:"name",configRequired:"0",configSort:"1",configWebVipVisitor:"1",configWebVisitor:"1"}],upgradeVisitorInfoSubmitTxt:"提交吧",upgradeWelcomeWord:"aaaa提示你输入",version:1,visitorInfoBackImg:"http://devs.rainbowred.com/res/static/config/entrance_pc.png",visitorInfoCloseImg:"http://devs.rainbowred.com/res/imgs/close.png",visitorInfoClosePos:"right:5px;top:5px;",visitorInfoEnable:"0",visitorInfoSubmitTxt:"确定",welcomeWord:"为了给您提供更优质的服务，请先完善以下信息",welcomeWordPos:"top:0;left:24px;right:auto;bottom:auto"},sdkEvaluateInfo:{bestDesc:"非常满意",bestDescDefault:"非常满意",bestEnable:"1",bestSelected:"http://devs.rainbowred.com/config/res/img/evaluate/bestSelected.png",bestUnSelected:"http://devs.rainbowred.com/config/res/img/evaluate/bestUnSelected.png",betterDesc:"满意",betterDescDefault:"满意",betterEnable:"1",betterSelected:"http://devs.rainbowred.com/config/res/img/evaluate/betterSelected.png",betterUnSelected:"http://devs.rainbowred.com/config/res/img/evaluate/betterUnSelected.png",commonDesc:"一般",commonDescDefault:"一般",commonEnable:"1",commonSelected:"http://devs.rainbowred.com/config/res/img/evaluate/commonSelected.png",commonUnSelected:"http://devs.rainbowred.com/config/res/img/evaluate/commonUnSelected.png",enable:"1",enableRepeatedEvaluate:"1",enableRepeatedEvaluateTimeLimit:"0",enableValidEvaluateTime:"1",enableVisitorEvaluateLimit:"0",evaluatePicURL:"http://devs.rainbowred.com/weixin/evaluate/weChatEval.html",evaluateType:"0",lan:"default",styleId:"224",type:"6",validEvaluateTime:"120",validRepeatedEvaluateTime:"30",worseDesc:"不满意",worseDescDefault:"不满意",worseEnable:"1",worseSelected:"http://devs.rainbowred.com/config/res/img/evaluate/worseSelected.png",worseUnSelected:"http://devs.rainbowred.com/config/res/img/evaluate/worseUnSelected.png",worstDesc:"非常不满意",worstDescDefault:"非常不满意",worstEnable:"1",worstSelected:"http://devs.rainbowred.com/config/res/img/evaluate/worstSelected.png",worstUnSelected:"http://devs.rainbowred.com/config/res/img/evaluate/worstUnSelected.png"},status:1,styleId:"224",tm:1611562089359,unreadMsgNumber:0,vcs:0,visitorId:"sdk11632",enableInputAssociate:"1",enableSearchInTheSameScreen:"1",robotConfigInfo:{categoryIds:"0",categoryType:"1",companyId:1801,enableAutoRecommend:"1",enableImagine:"1",enableRobot:"1",indexUpdateTime:"1611317412607",lan:"default",maxImaginations:"5",robotImg:"http://devs.rainbowred.com/res/imgs/robot.png",styleId:31},robotExtInfo:{autograph:"学富五车，才高八斗",companyId:1801,lan:"default",nickName:"小洽",styleId:31},robotSdkChatBox:{chatBoxAdHeight:"0",chatBoxAdImgLinkFixed:"0",chatBoxAdImgLinkOpenType:"1",chatBoxAdPostEnable:"0",chatBoxStaffImgEnable:"1",chatBoxTitle:"Echat对话",chatEndBtnBackColor:"rgb(220, 211, 235)",chatEndBtnTxtColor:"#ffffff",chatLAdHtmlWidth:"0",chatLogoImg:"http://devs.rainbowred.com/res/style/e/s1/pc_logo.png",chatRAdHtmlWidth:"0",chatStaffBackColor:"rgb(157,208,231)",chatStaffTxtColor:"rgb(0,0,0)",chatThemeBackColor:"rgb(198,185,219)",chatThemeTxtColor:"#ffffff",chatVisitorBackColor:"rgb(239,178,178)",chatVisitorTxtColor:"rgb(0,0,0)",defaultStaffImg:"http://devs.rainbowred.com/res/imgs/staff.png",defaultVisitorImg:"http://devs.rainbowred.com/res/imgs/visitor.png",enableChatEndBtn:"1",enableCloseBtn:"1",enableQRCode:"1",lan:"default",qrCodeType:"1",styleId:"224",sysMsgBackground:"#e9e9e9",sysMsgFontColor:"#5d5d5d",sysMsgIcon:"http://devs.rainbowred.com/res/imgs/sysinfo.png"},robotWordsInfo:{accurateWords:"小洽为您推荐",autoOnlineWords:"抱歉，没能帮您及时解决问题，小洽已为您转接到人工客服",clickSolvedWords:'[{"content":"能够帮到您我很开心！如果有需要您可以继续提问哦^_^","sort":1}]',clickUnsolvedWords:'[{"content":"未能帮到您小洽感到非常抱歉！您可以尝试换个问法，或联系人工服务^_^","sort":1}]',commonQuesWords:"您是否遇到以下问题：",companyId:1801,enableCommonQuestions:"1",enableFedBack:"1",fedBackWords:"以上内容是否对您有帮助？",guideWords:"请您选择：",inputBoxWords:"请用一句话描述您的问题，尽可能简短哦^^",lan:"default",media:"6",noAnswerWords:'[{"content":"小洽正在努力学习中，力争早日能帮您解决问题；现在您也可以通过人工服务获取帮助，谢谢！","sort":1}]',nonTextWords:"以小洽的学识，您还是发文字吧^^",relateKnowledgeWords:"您可能还想问：",relateQuesWords:"我猜您关心的问题是：",robotApiErrorWords:"抱歉当前咨询人数过多，请稍后再试",robotRpcErrorWords:"系统繁忙，请稍后再试",solvedBackColor:"rgb(204,204,204)",solvedButton:"http://devs.rainbowred.com/res/imgs/solved.png",solvedSelectColor:"rgb(255,167,38)",solvedWords:"是",stopWords:"妈妈告诉不能说xx，您重新问吧！",styleId:31,toHumanWords:"如您的问题未被解决，可进入",unsolvedBackColor:"rgb(204,204,204)",unsolvedButton:"http://devs.rainbowred.com/res/imgs/unsolved.png",unsolvedSelectColor:"rgb(255,167,38)",unsolvedWords:"否",welcomeWords:"宝宝，我来了！请详细描述你要求助的问题，让我更好的帮助你哦！"},sdkVisitorRobotConfig:{autoMaxNotKnowTimes:"3",autoMaxUnsolveTimes:"3",autoSwitchKeywords:"转人工",companyId:1801,enableAutoKeywords:"1",enableAutoMaxNotKnow:"1",enableAutoMaxUnsolve:"1",enableAutoSwitch:"1",enableLeaveBtnWhenStaffOffline:"0",enableManualKeywords:"1",enableManualMaxNotKnow:"1",enableManualMaxUnsolve:"1",enableManualSwitch:"1",enableSwitchBtnWhenStaffOnline:"0",lan:"default",manualMaxNotKnowTimes:"3",manualMaxUnsolveTimes:"3",manualSwitchKeywords:"转人工提示",priority:"2",styleId:31},webVisitorRobotConfig:{autoMaxNotKnowTimes:"3",autoMaxUnsolveTimes:"3",autoSwitchKeywords:"转人工",companyId:1801,enableAutoKeywords:"1",enableAutoMaxNotKnow:"1",enableAutoMaxUnsolve:"1",enableAutoSwitch:"1",enableLeaveBtnWhenStaffOffline:"0",enableManualKeywords:"1",enableManualMaxNotKnow:"1",enableManualMaxUnsolve:"1",enableManualSwitch:"1",enableSwitchBtnWhenStaffOnline:"0",lan:"default",manualMaxNotKnowTimes:"3",manualMaxUnsolveTimes:"3",manualSwitchKeywords:"转人工提示",priority:"2",styleId:31}},echatId:8,isForward:1,isPublic:0,mt:"649",updateTime:1611562088996,visitorId:"sdk11632"},{companyId:1801,createTime:1611314968206,data:{bin:2,companyId:1801,mid:36378,mst:3,mt:"672",nonce:"qCASs8xV",reChatTag:"e9Q4N1K343Z6bVZGA3F8yw==",rph:0,talkId:"1607",tm:1611562089824,vcs:0},echatId:9,isForward:1,isPublic:0,mt:"672",updateTime:1611562089037,visitorId:"sdk11632"}]},{functionName:"forwardStaffInfo",value:[{companyId:"1801",echatId:1,staffHead:"https://devfile.rainbowred.com/group1/M00/00/9B/rBAKCF_9HumAUBJBAAAT54AggQo025.png",staffId:"85",staffNickName:"🌈",staffPhone:"13281019356"}]},{functionName:"forwardHistoryMessage",value:[{companyId:521582,createTime:1627375358300,data:{bin:28,canTriggerWebTitleTip:1,chatInfoType:1,companyId:521582,content:"endTxt",id:0,mid:107133,mst:3,mt:"647",rph:0,sendStatus:1,staffId:0,talkId:"3146",tm:1627375359383,type:3,vcs:1,visitorId:"sdk12057"},echatId:131,isForward:1,mid:107133,mt:"647",sendStatus:0,show:1,updateTime:0,visitorId:"sdk12057"},{companyId:521582,createTime:1627375387934,data:{bin:28,canTriggerWebTitleTip:1,chatInfoType:1,companyId:521582,content:"您好，请问有什么可以帮助到您？",id:0,mid:107150,mst:3,mt:"647",rph:0,sendStatus:1,staffId:146,talkId:"3147",tm:1627375388988,type:2,vcs:1,visitorId:"sdk12057"},echatId:132,isForward:1,mid:107150,mt:"647",sendStatus:0,show:1,updateTime:0,visitorId:"sdk12057"},{companyId:521582,createTime:1627375387943,data:{bin:28,canTriggerWebTitleTip:1,chatInfoType:1,companyId:521582,content:"你好，很高兴为您服务，请问有什么可以帮您的吗？",id:0,mid:107152,mst:3,mt:"647",rph:0,sendStatus:1,staffId:146,talkId:"3147",tm:1627375389031,type:5,vcs:1,visitorId:"sdk12057"},echatId:133,isForward:1,mid:107152,mt:"647",sendStatus:0,show:1,updateTime:0,visitorId:"sdk12057"},{bridgeMsgId:"16273753876823",companyId:521582,createTime:1627375390221,data:{companyId:"521582",content:"你好",et:"105",visitorId:"sdk12057"},echatId:134,et:"105",isForward:1,mid:107158,sendStatus:1,show:1,updateTime:1627375390299,visitorId:"sdk12057"},{companyId:521582,createTime:1627375395676,data:{staffNickName:"aaa",bin:28,mt:"640",relateId:0,vcs:1,mid:107163,rph:0,content:"3",mst:2,companyId:521582,chatStaffNickName:"aaa",chatStaffId:146,tm:1627375396789,sendStatus:1,id:0,talkId:"3147",staffId:146,visitorId:"sdk12057"},echatId:135,isForward:1,mid:107163,mt:"640",sendStatus:0,show:1,updateTime:0,visitorId:"sdk12057"},{companyId:521582,createTime:1627375463784,data:{bin:"29",chatInfoType:1,mt:"647",vcs:1,mid:107167,rph:0,type:4,content:"您已长时间未响应客服对话，如果时间过长未响应，对话将结束!",canTriggerWebTitleTip:1,mst:3,companyId:521582,tm:1627375427670,sendStatus:1,id:30690,talkId:"3147",staffId:0,visitorId:"sdk12057"},echatId:136,isForward:1,mid:107167,mt:"647",sendStatus:0,show:1,updateTime:0,visitorId:"sdk12057"},{companyId:521582,createTime:1627375463793,data:{bin:"29",chatInfoType:1,mt:"647",vcs:1,mid:107171,rph:0,type:4,content:"您过长时间未响应，系统已结束您的对话，欢迎下次咨询!",canTriggerWebTitleTip:1,mst:3,companyId:521582,tm:1627375457818,sendStatus:1,id:30692,talkId:"3147",staffId:0,visitorId:"sdk12057"},echatId:137,isForward:1,mid:107171,mt:"647",sendStatus:0,show:1,updateTime:0,visitorId:"sdk12057"},{companyId:521582,createTime:1627375463806,data:{bin:"29",chatInfoType:1,mt:"647",vcs:1,mid:107173,rph:0,type:3,content:"endTxt",canTriggerWebTitleTip:1,mst:3,companyId:521582,tm:1627375457927,sendStatus:1,id:30693,talkId:"3147",staffId:0,visitorId:"sdk12057"},echatId:138,isForward:1,mid:107173,mt:"647",sendStatus:0,show:1,updateTime:0,visitorId:"sdk12057"},{bridgeMsgId:"16273753876824",companyId:521582,createTime:1627375467891,data:{companyId:"521582",content:"你好",et:"105",visitorId:"sdk12057"},echatId:139,et:"105",isForward:1,mid:107173,sendStatus:1,show:1,updateTime:1627375474832,visitorId:"sdk12057"},{bridgeMsgId:"16273753876826",companyId:521582,createTime:1627375594133,data:{companyId:"521582",content:"明",et:"105",visitorId:"sdk12057"},echatId:140,et:"105",isForward:1,mid:107173,sendStatus:0,show:1,updateTime:1627375600848,visitorId:"sdk12057"},{clientFileId:"ua/1/202f0e35-2d1e-4465-9999-1a643583ec75",companyId:521582,createTime:1628234337249,data:{fileName:"sdk-static.zip",fileSize:537977,remoteFileUrl:"https://tqn.rainbowred.com/ua/1/202f0e35-2d1e-4465-9999-1a643583ec75",clientFileId:"7348cc21-9467-4644-918a-b2ca9a2e7a41",companyId:521582,et:"164",fileType:1,identityKey:"ua/1/202f0e35-2d1e-4465-9999-1a643583ec75",isOrder:!1,isOtherProcess:!1,isUploading:!1,loadStatus:0,mid:141934,msgType:0,progress:100,sendStatus:1,staffId:147,tm:1628234336835,visitorId:"sdk12097"},echatId:290,et:"164",isForward:1,mid:141934,sendStatus:1,show:1,updateTime:0,visitorId:"sdk12097"}]},{functionName:"forwardChatMessage",value:[{data:{bin:20,companyId:1801,id:0,mid:42450,mst:3,mt:"604",rph:0,sendStatus:1,staffDetailInfo:{staffInfo:"浪的一批",staffPhone:"18801103391"},staffId:74,staffNickName:"浪浪浪~~~",startType:3,talkId:"1607",tm:1612346472125,vcs:0},echatId:231},{data:{bin:20,companyId:1801,departmentId:43,departmentName:"亚当吃🍎",fromStaffId:85,fromStaffName:"lh",id:0,mid:42452,mst:3,mt:"10001",rph:0,sendStatus:1,talkId:"1607",tm:1612346472242,toStaffChatNumber:1,toStaffDetailInfo:{staffInfo:"浪的一批",staffPhone:"18801103391"},toStaffId:74,toStaffName:"谢浪",toStaffNickName:"浪浪浪~~~",transferReason:4,transferResult:1,transferType:2,vcs:0},echatId:232},{companyId:1801,createTime:1612348326113,data:{fileName:"better.png",staffNickName:"🌈",bin:28,fileIdentity:"945b524f-b64f-4089-bf9e-faca92afaff3",mid:42803,mst:2,sourceLenth:9057,bigImg:"http://tqn.rainbowred.com/945b524f-b64f-4089-bf9e-faca92afaff3",sourceWidth:200,id:0,talkId:"1607",retry:!1,smallImg:"http://tqn.rainbowred.com/945b524f-b64f-4089-bf9e-faca92afaff3?imageView2/1/w/200/h/150",mt:"641",vcs:1,fileSource:1,bigLenth:0,sourceHeight:200,rph:0,sourceImg:"http://tqn.rainbowred.com/945b524f-b64f-4089-bf9e-faca92afaff3",companyId:1801,tm:1612348324840,sendStatus:1,smallLenth:0,staffId:85,visitorId:"sdk11632"},echatId:233,isForward:0,mid:42803,mt:"641",sendStatus:0,show:1,updateTime:0,visitorId:"sdk11632"},{companyId:1801,createTime:1612348257708,data:{bin:28,chatStaffId:74,chatStaffNickName:"浪浪浪~~~",companyId:1801,content:'123<img src="https://devfile.rainbowred.com/group1/M00/00/9E/rBAKCGAaeqGAfGyiAACFeqwu5WE389.png">',id:0,mid:42799,mst:2,mt:"640",relateId:0,rph:0,sendStatus:1,staffId:85,staffNickName:"🌈",talkId:"1607",tm:1612348256439,vcs:1,visitorId:"sdk11632"},echatId:234,isForward:0,mid:42799,mt:"640",sendStatus:0,show:1,updateTime:0,visitorId:"sdk11632"},{companyId:1801,createTime:1612348259708,data:{pushUrlDetail:{urlName:"连接百度",detailId:36,menuId:30,url:"https://www.baidu.com/"},staffNickName:"🌈",bin:28,mt:"680",vcs:1,mid:49602,rph:0,mst:2,companyId:1801,chatStaffNickName:"🌈",chatStaffId:85,pushDataType:"1",tm:1612490635510,sendStatus:1,id:0,talkId:"1607",staffId:85,visitorId:"sdk11632"},echatId:235,isForward:0,mid:49602,mt:"680",sendStatus:0,show:1,updateTime:0,visitorId:"sdk11632"},{companyId:1801,createTime:1612348259708,data:{staffNickName:"客服",customizeMsgType:"1",bin:12,mt:"10011",vcs:0,memo:"姐姐好可怕",mid:562864,urlForStaff:"http('http://m.echatsoft.com','inner')",rph:0,title:"心疼giegie",content:"giegie和我吃同一个冰糕，姐姐不会生气吧",dedup:"0",mst:1,companyId:521616,imageUrl:"https://www.echatsoft.com/images/logo/icon_echat_logo_1.png",tm:1640313101237,sendStatus:1,id:43170,talkId:"4743",staffId:"2",urlForVisitor:"http('http://m.echatsoft.com','inner')",visitorId:"web365857"},echatId:236,isForward:0,mid:49603,mt:"10011",sendStatus:0,show:1,updateTime:0,visitorId:"sdk11632"},{companyId:1801,createTime:1612348259709,data:{staffNickName:"客服",customizeMsgType:"2",bin:12,mt:"10011",vcs:0,memo:"姐姐好可怕",mid:562865,urlForStaff:"http('http://m.echatsoft.com','inner')",rph:0,title:"心疼giegie",content:"giegie和我吃同一个冰糕，姐姐不会生气吧",dedup:"0",mst:2,companyId:521616,imageUrl:"https://www.echatsoft.com/images/logo/icon_echat_logo_1.png",tm:1640313101237,sendStatus:1,id:43171,talkId:"4743",staffId:"2",urlForVisitor:"http('http://m.echatsoft.com','inner')",visitorId:"web365857"},echatId:237,isForward:0,mid:49604,mt:"10011",sendStatus:0,show:1,updateTime:0,visitorId:"sdk11632"},{companyId:1801,createTime:1612348259709,data:{staffNickName:"客服",customizeMsgType:"2",bin:12,mt:"10011",vcs:0,memo:"姐姐好可怕",mid:562866,urlForStaff:"http('http://m.echatsoft.com','inner')",rph:0,title:"心疼giegie",content:"giegie和我吃同一个冰糕，姐姐不会生气吧",dedup:"0",mst:3,companyId:521616,imageUrl:"https://www.echatsoft.com/images/logo/icon_echat_logo_1.png",tm:1640313101237,sendStatus:1,id:43172,talkId:"4743",staffId:"2",urlForVisitor:"http('http://m.echatsoft.com','inner')",visitorId:"web365857"},echatId:238,isForward:0,mid:49605,mt:"10011",sendStatus:0,show:1,updateTime:0,visitorId:"sdk11632"}]},,{functionName:"uploadStart",value:{clientFileId:"85f51947-4883-444a-8398-a1f1dae5345b",companyId:521582,createTime:1628674941069,data:{bigLenth:0,smallLenth:0,sourceLenth:0,clientFileId:"85f51947-4883-444a-8398-a1f1dae5345b",companyId:521582,et:"161",fileType:1,identityKey:"ua/1/b9d367a3-436f-485e-9083-85c416a4ed77",isOrder:!1,isOtherProcess:!1,isUploading:!1,loadStatus:0,localFile:"content://media/external/images/media/1536473",mid:0,msgType:1,progress:0,sendStatus:3,staffId:0,tm:0,visitorId:"sdk12146"},echatId:185,et:"161",identityKey:"ua/1/b9d367a3-436f-485e-9083-85c416a4ed77",isForward:1,mid:161421,sendStatus:3,show:1,updateTime:0,visitorId:"sdk12146"}},{functionName:"uploadProgress",value:{clientFileId:"85f51947-4883-444a-8398-a1f1dae5345b",companyId:521582,createTime:1628674941069,data:{bigLenth:0,smallLenth:0,sourceLenth:0,clientFileId:"85f51947-4883-444a-8398-a1f1dae5345b",companyId:521582,et:"161",fileType:1,identityKey:"ua/1/b9d367a3-436f-485e-9083-85c416a4ed77",isOrder:!1,isOtherProcess:!1,isUploading:!1,loadStatus:0,localFile:"content://media/external/images/media/1536473",mid:0,msgType:1,progress:10,sendStatus:3,staffId:0,tm:0,visitorId:"sdk12146"},echatId:185,et:"161",identityKey:"ua/1/b9d367a3-436f-485e-9083-85c416a4ed77",isForward:1,mid:161421,sendStatus:3,show:1,updateTime:0,visitorId:"sdk12146"}},{functionName:"uploadProgress",value:{clientFileId:"85f51947-4883-444a-8398-a1f1dae5345b",companyId:521582,createTime:1628674941069,data:{bigLenth:0,smallLenth:0,sourceLenth:0,clientFileId:"85f51947-4883-444a-8398-a1f1dae5345b",companyId:521582,et:"161",fileType:1,identityKey:"ua/1/b9d367a3-436f-485e-9083-85c416a4ed77",isOrder:!1,isOtherProcess:!1,isUploading:!1,loadStatus:0,localFile:"content://media/external/images/media/1536473",mid:0,msgType:1,progress:40,sendStatus:3,staffId:0,tm:0,visitorId:"sdk12146"},echatId:185,et:"161",identityKey:"ua/1/b9d367a3-436f-485e-9083-85c416a4ed77",isForward:1,mid:161421,sendStatus:3,show:1,updateTime:0,visitorId:"sdk12146"}},{functionName:"uploadSuccess",value:{clientFileId:"85f51947-4883-444a-8398-a1f1dae5345b",companyId:521582,createTime:1628674941069,data:{bigImg:"https://tqn.rainbowred.com/ua/1/b9d367a3-436f-485e-9083-85c416a4ed77?imageView2/1/w/573/h/1200",bigLenth:0,smallImg:"https://tqn.rainbowred.com/ua/1/b9d367a3-436f-485e-9083-85c416a4ed77?imageView2/1/w/200/h/150",smallLenth:0,sourceImg:"https://tqn.rainbowred.com/ua/1/b9d367a3-436f-485e-9083-85c416a4ed77",sourceLenth:0,clientFileId:"85f51947-4883-444a-8398-a1f1dae5345b",companyId:521582,et:"161",fileType:1,identityKey:"ua/1/b9d367a3-436f-485e-9083-85c416a4ed77",isOrder:!1,isOtherProcess:!1,isUploading:!1,loadStatus:0,localFile:"content://media/external/images/media/1536473",mid:161426,msgType:1,progress:100,sendStatus:1,staffId:146,tm:1628674952831,visitorId:"sdk12146"},echatId:185,et:"161",identityKey:"ua/1/b9d367a3-436f-485e-9083-85c416a4ed77",isForward:1,mid:161426,sendStatus:1,show:1,updateTime:1628674952325,visitorId:"sdk12146"}},{functionName:"forwardChatMessage",value:[{companyId:521704,createTime:1640937598893,data:{staffNickName:"客服",bin:28,mt:"640",relateId:0,vcs:1,mid:39559,rph:0,content:'大水比啊啊啊啊啊啊啊啊\n<video controls="true" id="myVideo" autoplay="" style="width: 700px;height:700px;" src="https://qnfile.echatsoft.com/a8015b56-f682-4ceb-a763-a459daa48e76">\n</video>',mst:2,companyId:521704,chatStaffId:126,tm:1640937598281,sendStatus:1,id:0,talkId:"5183",staffId:126,visitorId:"sdk365329"},echatId:334,isForward:1,mid:39559,mt:"640",sendStatus:0,show:1,updateTime:0,visitorId:"sdk365329"}]},{value:[{mt:"688",echatId:0,companyId:521704,show:1,visitorId:"sdk366194",sendStatus:1,data:{id:0,createType:1,bin:28,mid:41468,mt:"688",template:{detailList:[{id:280,label:"姓名",fieldId:1491,lan:"default",fieldType:1,setting:"[]",field:"name",type:1,formTemplateId:73,sort:1,companyId:521704,required:!1},{id:281,label:"性别",fieldId:1502,lan:"default",fieldType:1,setting:'[{"configs":[{"item":"男","sort":1,"value":"1"},{"item":"女","sort":2,"value":"2"}],"lan":"default"}]',field:"gender",type:4,formTemplateId:73,sort:2,companyId:521704,required:!1},{id:282,label:"邮箱",fieldId:1495,lan:"default",fieldType:1,setting:"[]",field:"email",type:1,formTemplateId:73,sort:3,companyId:521704,required:!1},{id:283,label:"手机",fieldId:1493,lan:"default",fieldType:1,setting:"[]",field:"phone",type:1,formTemplateId:73,sort:4,companyId:521704,required:!1},{id:284,label:"地址",fieldId:1497,lan:"default",fieldType:1,setting:"[]",field:"address",type:1,formTemplateId:73,sort:5,companyId:521704,required:!1},{id:285,label:"备注",fieldId:1498,lan:"default",fieldType:1,setting:"[]",field:"memo",type:2,formTemplateId:73,sort:6,companyId:521704,required:!1}],name:"默认表单",openType:1,iconUrl:"https://chats.rainbowred.com/config-v2/common/css/img/formIcon.png",createUserid:0,id:73,status:!0,modifyUserid:0,commitMsg:"表单已成功提交，请保持电话畅通，工作人员随时与您联系~",desc:"为了给您提供更好的服务，请填写以下信息内容~",companyId:521704},formUrl:"https://chats.rainbowred.com/visitor/common/form.html?domain=tprofile.rainbowred.com&sendId=d832b30843eb48518d41dce6200dab10&params=fvr7K0JLqIeP6HC8YIl4hyP%2FEsD4dkO%2FTXOsKoiK%2BYWRkA5IO8VZ%2FlkX28I%2FTKn92pEtMKPdhNyB%0AMaEuPJcG9ZMEm1JjhPyrxmnqYMKVDINT2WRTM7R2gyi4QWD9VYAhmDiuIHKxZfrZMbb7adEj0%2FBk%0AvcIClIFoUkQutm2%2Bfa01Xy08n1AJ1wc3TWqOVDgdwmNLhtW6mRWTQgiDIdJXiA%3D%3D",sendStatus:1,vcs:0,viptype:2,tm:1641873267207,talkId:"5617",vipid:"366194",visitorId:"sdk366194",staffId:125,sendId:"d832b30843eb48518d41dce6200dab10",rph:0,companyId:521704,mst:2},mid:41468,updateTime:0,isForward:0}],functionName:"forwardChatMessage"},{functionName:"forwardChatMessage",value:[{companyId:521741,createTime:1641893914357,data:{bin:28,companyId:521741,createType:1,formUrl:"https://yfbs.echatsoft.com/visitor/common/form.html?domain=yfbprofile.echatsoft.com&sendId=2bcd81250c9749c09da49a8902e41ed1¶ms=fvr7K0JLqIeP6HC8YIl4h8EItZnJ1c70TXOsKoiK%2BYWRkA5IO8VZ%2FlkX28I%2FTKn9lJVG60yGqBIS%0AHXts3pg7y%2FQOMXWDuKqU3keYT%2FHtCwmFGzmz3UAD9ii4QWD9VYAhqfNL3%2BTf76fZMbb7adEj0%2FBk%0AvcIClIFoUkQutm2%2Bfa01Xy08n1AJ16yrmgd2%2B5ehyljTHw0NHCdy80zRkGrlBA%3D%3D",id:0,mid:57392,mst:2,mt:"688",rph:0,sendId:"2bcd81250c9749c09da49a8902e41ed1",sendStatus:1,staffId:3200,talkId:"4395",template:{commitMsg:"表单已成功提交，请保持电话畅通，工作人员随时与您联系~",companyId:521741,createUserid:3199,desc:"为了给您提供更好的服务，请填写以下信息内容~",detailList:[{companyId:521741,field:"name",fieldId:633,fieldType:1,formTemplateId:3174,id:18876,label:"姓名",lan:"default",required:!1,setting:"[]",sort:1,type:1},{companyId:521741,field:"memo",fieldId:640,fieldType:1,formTemplateId:3174,id:18877,label:"备注",lan:"default",required:!1,setting:"[]",sort:2,type:2}],iconUrl:"http://yfbs.echatsoft.com/config-v2/common/css/img/formIcon.png",id:3174,modifyUserid:3199,name:"new表单",openType:1,status:!0},tm:1641893914357,vcs:0,vipid:"1259",viptype:2,visitorId:"sdk1259"},echatId:412,isForward:0,mid:57392,mt:"688",sendStatus:0,show:1,updateTime:1641893915215,visitorId:"sdk1259"}]}];t.default=a},222:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(18),n(27);var a=r(n(4)),o=r(n(32)),i=r(n(6)),s=r(n(52));function r(e){return e&&e.__esModule?e:{default:e}}var l=function(e){if(!e)return!1;var t,n,r=!1,l=parseInt(e.mt||e.et);switch(l){case 600:break;case 605:2==i.default.getStatusByKey("chatStatus")&&(i.default.setStatusByKey("visitorClose",1==e.closeRease),a.default.publish("chatEnded",e,i.default.getStatusData()),i.default.setStatusByKey("chatStatus",0));break;case 610:var c=e.canChatNow,d=e.status,u=e.chatStatus;i.default.setStatusData({canChatNow:c,status:d,chatStatus:u});break;case 105:case 130:case 161:case 641:case 642:case 647:case 658:case 655:case 680:case 688:case 959:case 10011:r=!0;break;case 864:case 865:case 866:r=!0,0==e.isForward&&(t=i.default.getStatusData()).talkId&&e.talkId==t.talkId&&2===t.chatStatus&&t.talkType==a.default.Constants.talkTypeChat&&a.default.publish("_addSendMsgNum",e);break;case 640:if(r=!0,0==e.isForward&&a.default.publish("clearMsgTyping",e),e.relateId){i.default.updateMsgByIndetity(e.relateId,{mt:647,content:lanRes.backMsgTip});var f=i.default.getMsgFromHistory(e.relateId);f&&s.default.replaceMsg(f.msg)}break;case 644:a.default.publish("getMsgTyping",e);break;case 648:2==(t=i.default.getStatusData()).chatStatus&&t.talkId==e.talkId&&a.default.publish("getPosMsg",e);break;case 646:break;case 649:a.default.publish("waitingChat",e);break;case 650:0==e.isForward&&(i.default.setStatusByKey("captChaToken",e.captChaToken),a.default.publish("refreshCode",e));break;case 651:break;case 652:console.log(e);break;case 670:a.default.publish("entryCallback",e);break;case 672:case 696:i.default.setVisitorInfo(e);break;case 673:e.talkId==i.default.getStatusByKey("talkId")&&0==e.isForward&&a.default.publish("inviteSatisfy",e);break;case 677:case 678:t={talkType:o.default.talkTypeLeave,chatStatus:2,staffId:"",talkId:e.talkId},i.default.setStatusData(t),a.default.publish("startLeave",e);break;case 697:t={talkType:o.default.talkTypeQueue,chatStatus:2,staffId:"",talkId:e.talkId},i.default.setStatusData(t),a.default.publish("startQueue",e);break;case 603:i.default.setStatusData({status:e.status});break;case 604:case 679:!function(e,t){var n,s=i.default.getStatusData(),r={talkId:e.talkId},l=2==s.chatStatus&&s.talkType==o.default.talkTypeChat,c=e.staffNickName,d=e.staffId,u=e.staffDetailInfo||{},f=u.staffHead,p=u.staffPhone;l||(r.talkType=o.default.talkTypeChat,r.chatStatus=2),e.staffId&&(r.staffId=e.staffId),i.default.setStatusData(r),l||a.default.publish("startChat",e),e.staffId&&e.staffDetailInfo&&((n={})[d]={staffNickName:c,staffHead:f,staffPhone:p,staffId:d},i.default.setStaffInfo(n)),604==t&&a.default.publish("updateChatStaffInfo")}(e,l);break;case 687:case 691:t={talkType:o.default.talkTypeRobot,chatStatus:2,staffId:"",talkId:e.talkId},i.default.setStatusData(t),a.default.publish("startRobot",e);break;case 684:case 685:a.default.publish("getNewUnreadMsgCount",e);break;case 689:n=i.default.getStatusByKey("staffId"),e.staffInfoList&&(e.staffInfoList.forEach((function(e){var t=e.staffId,o={};t==n&&a.default.publish("updateChatStaffInfo"),o[t]=e,i.default.setStaffInfo(o)})),s.default.updateMsgStaff());break;case 695:i.default.setConfig("config695",e),a.default.publish("displayRouter",e);break;case 876:a.default.publish("overLength",e);break;case 923:!function(e){var t=e.newVisitorId,n=e.oldVisitorId;a.default.publish("updateVisitorInfo",{visitorId:t,photo:e.metaDataInfo.photo}),n!=t&&i.default.setVisitorInfo({oldVisitorId:e.oldVisitorId,visitorId:t})}(e);break;case 928:break;case 12001:r=!0,a.default.publish("getMsgRobot",e);break;case 10001:r=!0,a.default.publish("updateChatStaffInfo");break;case 10021:a.default.changeToPlatform(e);break;default:r=!0,console.log("没有处理的消息，目前走了一下显示逻辑",e)}return r&&s.default.showMsg(e),r};t.default=l},223:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(42),n(18),n(66),n(10);var a=s(n(44)),o=s(n(4)),i=s(n(6));function s(e){return e&&e.__esModule?e:{default:e}}var r,l,c=a.default.callEchatNativeConnect,d=[],u=[],f={105:1,130:1,127:1},p={104:1,132:1},h={};r=function(e){var t,n,a=e?u:d;if(a.length>0)for(n=0;n<a.length&&(t=a[n])&&(t.sending||(t.sending=!0,t.data.isResend=1,l(t.data,t.cb,t,e)));n++);},l=function(e,t,n){var a=1==e.isSave,o=a?u:d;if(e.bridgeMsgId&&!n){var s=o.filter((function(t){return t.data.bridgeMsgId==e.bridgeMsgId}));if(s.length>0&&(n=s[0]),n&&n.sending&&n.data.isResend)return}var l=n?n.time:(new Date).getTime(),f=n||{data:e,cb:t,time:l,sending:!0};function m(){for(var e=o.length-1;e>-1;e--)if(o[e]&&o[e].time==l){o.splice(e,1);break}}return!n&&!p[e.et]&&o.push(f),function(e,t){e.bridgeMsgId=e.bridgeMsgId||i.default.getNextBridgeMsgId(),c("sendMessage",e),h[e.bridgeMsgId]=t}(e,(function(e){t&&t.apply(this,arguments),e.successful?(m(),setTimeout((function(e){r(a)}))):f.sending=!1})),!0},o.default.subscribe("clearSendingMsg",(function(e,t){var n,a,o=u;if(o.length>0){for(a=0;a<o.length;a++)(n=o[a]).cb&&n.cb({successful:!1,failure:{type:"new session"},autoResend:!1});o.length=0}}));var m={flashMsg:r,send:function(e,t,n){var a=i.default.getVisitorInfo();t.companyId=a.companyId,t.visitorId=a.visitorId,0!==t.isSave&&(t.isSave=f[t.et]?1:0),l(t,n,null,!0)},callback:function(e){var t=e.bridgeMsgId;h[t]&&h[t](e)}};t.default=m},224:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(44)),o=r(n(4)),i=n(13),s=r(n(6));function r(e){return e&&e.__esModule?e:{default:e}}var l,c=a.default.callEchatNative;l={closeChat:function(e){o.default.publish("visitorClose",1==e?1:0)},switchSoundTip:function(e){},triggerFile:function(e){o.default.publish("triggerFile",e)},voice:function(e){o.default.publish("recordEvent",e)},uploadType:function(e){if(e){var t=2,n=document.getElementById("uploadInput");"record"==e?t=4:"gallery"==e?t=2:"voice"==e&&(t=3),$(n).attr("filetype",t)}},location:function(e){var t=e.provinceName,n=void 0===t?"":t,a=e.cityName,i=void 0===a?"":a,s=e.adName,r=void 0===s?"":s,l=e.address,c=void 0===l?"":l,d={id:(new Date).getTime(),et:127,locationX:e.latitude,locationY:e.longitude,scale:parseInt(e.zoom||15),label:e.title,address:n+i+r+c};o.default.triggerEventOnPoint("_sendMsgLocation",d)},keyboardHeight:function(e){o.default.publish("keyboardHeight",e)},networkChangeStatus:function(e){var t=s.default.getDataByName("netConnected");e&&0==e.networkType?(0,i.networkStatusChange)(!1):t||c("checkNetworkStatus",{pingIp:void 0,url:void 0})},networkStatus:function(e){var t=e.isConnected,n=e.error,a=2==t,o=s.default.getDataByName("netConnected");if(1==n)return console.log("检查网络传参数错误");(0,i.networkStatusChange)(a),a&&!o&&!o&&c("checkWebsocketStatus")},websocketStatus:function(e){var t=e.type;s.default.setDataByName("websocketStatus",t),t==o.default.Constants.websocketConnecting?o.default.showTip("正在连接"):t==o.default.Constants.websocketConnected&&(0,i.networkStatusChange)(!0)},callbackOpenFile:function(e){"0"==e.status&&o.default.showTip("文件打开失败文件")},downloadProgress:function(e){o.default.publish("downloadEvent",e)}},a.default.initNativeAPI(l,"callEchatJs"),o.default.subscribe("__chatStatus",(function(e,t){})),o.default.subscribe("__evaluate",(function(e,t){c("visitorEvaluate",t)})),o.default.subscribe("_closeWin",(function(e,t){s.default.getStatusByKey("visitorClose")&&c("destoryView")})),o.default.subscribe("_changeCloseBtn",(function(e,t){c("changeCloseBtnStatus",t||"0")})),o.default.subscribe("__setTitle",(function(e,t){c("setTitle",t||" ")})),o.default.subscribe("_checkNetworkStatus",(function(e,t){c("checkNetworkStatus",{pingIp:void 0,url:void 0})})),o.default.subscribe("_checkWebsocketStatus",(function(e,t){c("checkWebsocketStatus")})),o.default.subscribe("__jumpToUrl",(function(e,t){c("jumpToUrl",t)})),o.default.subscribe("__openWebsocket",(function(e){c("openWebsocket")}));var d=l;t.default=d},32:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(45),n(47),n(3),n(49),n(37);var a={talkTypeChat:1,talkTypeQueue:2,talkTypeLeave:3,talkTypeRobot:5,websocketNotConnect:0,websocketConnecting:1,websocketConnected:2,websocketStoped:3,chatboxName:"sdkChatBoxInfo",chatboxRobotName:"robotSdkChatBox",contextPath:"/mychat/visitor",regFace:new RegExp("\ud83c[\udf00-\udfff]|\ud83d[\udc00-\ude4f]|\ud83d[\ude80-\udeff]|[#-®]|[‼-㊙]","g"),regEmo:new RegExp("\\[#[a-z0-9A-Z]+(_[a-z0-9A-Z]+)?#\\]","g"),regMail:/\b\w{1,30}([\.-]\w{1,30}){0,10}@\w{1,30}([\.-]\w{1,20}){0,10}(\.\w{1,20}){0,10}\b/g,regPhone:/([^\d]|\b)((\d{11})|((\d{7,8})|(\d{4}|\d{3})[\-\s](\d{7,8})|(\d{4}|\d{3})[\-\s](\d{7,8})[\-\s](\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})[\-\s](\d{4}|\d{3}|\d{2}|\d{1})))(?=[^\d]|\b)/gi,regLink:/((http|ftp|https):\/\/)(([\w\._\-]+\.[a-zA-Z]{2,6})|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,4})?(\/[\w,\&%_\!\*\(\)\'\;\:\@\=\+\.\/\[-~\-#\?]*)?/gi,iScrollParam:{preventDefault:!1,preventDefaultException:/^(A|PRE|INPUT|TEXTAREA|BUTTON|SELECT|LABEL)$/,tap:!1,click:!1,mouseWheel:!1,fadeScrollbars:!1},sendStatus:{error:0,success:1,notSend:2,sending:3},lastMsgRule:{0:"您有新的消息",604:"您的对话已接通",605:"您的对话已结束",621:"给您发送了一个信息填写邀请",622:"给您发送了一个信息填写邀请",640:"${content,0,30,1}",641:"[图片]",642:"[文件]",647:"${content,0,30,1}",648:"等待接入会话，排队位置:${position}",653:"[图片]",657:"[图文消息]",673:"请您对本次服务进行评价",674:"您有新的消息",675:"您有新的消息",676:"您有新的消息",10011:"[图文消息]",864:"${content,0,30,1}",865:"[图片]",866:"[文件]",680:"[链接]"},validRule:{email:{p:/^[\w\d_\-\.]+@.+[\.].+/gi,msg:lanRes.invildEmail,length:50},phone:{p:/^[0-9\-]{0,20}$/,msg:lanRes.invildPhone,length:20},age:{p:/^[1-9][\d]{0,2}$/gi,msg:lanRes.invildAge,length:3},qq:{p:/^[1-9][\d]+$/gi,msg:lanRes.invildQQ,length:50},date:{p:/^[\d]{4}[-\/][\d]{2}[-\/][\d]{1,2}/gi,msg:lanRes.invildDate,length:50},address:{length:255},name:{length:50},wechat:{length:50},nickName:{length:50},birthday:{length:20},content:{length:1e3},memo:{length:255},textarea:{length:500},text:{length:100},number:{p:/^\-?\d*$/,length:50}},ADParams:["companyId","visitorId","echatTag","lan","country","province","city","searcher","keyword","metaData","myData","referrer","firstUrl","chatPage","chatPageTitle","eventId","osName","staffId","staffName","staffPhoto","talkId","staffPhone","staffInfo"]};t.default=a},4:function(e,t,n){"use strict";n(38),n(26),n(50),n(27),n(51),Object.defineProperty(t,"__esModule",{value:!0}),t.checkFirstMsg=function(e){if(!e)return;try{e=JSON.parse(e)}catch(e){return}function t(e,t){return e&&(e+"").replace(/<(?:.|\s)*?>/gi,"").substring(0,t||100)}if("text"==e.msgType&&e.content)return{msgType:"text",content:t(e.content),translation:e.translation&&t(e.translation)};if("image"==e.msgType&&e.picUrl)return{msgType:"image",picUrl:e.picUrl,thumbUrl:e.thumbUrl||""};if("video"==e.msgType&&e.fileUrl)return{msgType:"video",fileUrl:e.fileUrl,fileSize:e.fileSize||0,fileName:e.fileName||"",thumbUrl:e.thumbUrl};if("file"==e.msgType&&e.fileUrl)return{msgType:"file",fileUrl:e.fileUrl,fileSize:e.fileSize||0,fileName:e.fileName||""}},t.default=void 0,t.isArray=y,n(18),n(3),n(63),n(9),n(42),n(45),n(47),n(49),n(37),n(20),n(108),n(28),n(31),n(133),n(10),n(65);var a=s(n(180)),o=s(n(32)),i=s(n(187));function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}window.$=a.default,window._$=function(e){return document.getElementById(e)},window._echat0={scrollToBottom:void 0,imgError:void 0,checkImg:function(e){if(window.hotcss){var t=window.hotcss.dpr,n=e.width,a=e.height,o=e.parentNode.clientHeight;e.parentNode.clientWidth/t>n&&o/t>a&&(e.style.width=2*n+"px")}}};var c,d,u,f,p,h,m,g={},v={demo:[{check:function(){},callback:function(){}}]};function y(e){return"[object Array]"===Object.prototype.toString.apply(e)}c={Constants:o.default,bot:/spider|bot/i.test(navigator.userAgent),EchatObjKeyMap:g,isMobile:!0,clickName:"touchend",SDKNative:!0,SDK:!0,dji:!1,mini:!1,windowType:void 0,needHttps:"https:"==location.protocol||"file:"==location.protocol?"https:":"",subMap:{},eventMap:{},replaceHtml:function(e){return e&&(e+"").replace(/<(?:.|\s)*?>/gi,"").substring(0,100)},addEventPoint:function(e,t){var n;if("function"==typeof t)return(n=v[e]||[]).push({once:!1,check:function(){return!0},callback:t}),void(v[e]=n);e&&"string"==typeof e&&t&&t.check&&"function"==typeof t.check&&(t.callback&&"function"!=typeof t.callback||(n=v[e]||[],!1!==t.once&&(t.once=!0),n.push(t),v[e]=n))},triggerEventOnPoint:function(e){var t,n=arguments,a=this,o=v[e];o&&0!=o.length&&(o=o.filter((function(e){var o=[];for(t=1;t<n.length;t++)o.push(n[t]);return!e.check||!e.check.apply(a,o)||(e.callback&&e.callback.apply(a,o),!e.once)})),v[e]=o)},subscriber:function(e){this.subMap={},this.eventMap={},g[e||this.KEY]=this,this.setSub=function(e){this.subMap[e]=e},this.removeSub=function(e){delete this.subMap["string"==typeof e?e:e.KEY]},this.publish=function(e){var t,n,a,o,i,s=this.subMap;for(n in s)if((a=g[n])&&a.eventMap&&a.eventMap[e]&&y(o=a.eventMap[e]))for(i=0;i<o.length;i++)t=o[i].apply(a,arguments);return t},this.subscribe=function(e,t){this.eventMap[e]?this.eventMap[e].push(t):this.eventMap[e]=[t]},this.unSubscribeAll=function(){this.eventMap={}},this.unSubscribe=function(e){if(y(e))for(var t=0;t<e.length;t++)delete this.eventMap[e[t]];else delete this.eventMap[e]}},isArray:y,getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=location.search.substr(1).match(t);if(null!=n)return decodeURIComponent(n[2])},escapeRegExp:(f=/[\\^$.*+?()[\]{}|]/g,p=new RegExp(f.source),function(e){return e&&p.test(e)?e.replace(f,"\\$&"):e}),addMapParams:function(e){var t,n="";for(t in e)n+="&"+t+"="+encodeURIComponent(e[t]||"");return n},addMapParams1:function(e){var t,n=[];for(t in e)n.push(t+"="+encodeURIComponent(e[t]||""));return n.join("&")},getQueryParams:function(e){var t,n,a,o,i,s={};for("string"!=typeof e&&(e=location.search),-1!=e.indexOf("#")&&(e=e.substring(0,e.indexOf("#"))),-1!=e.indexOf("?")&&(e=e.substring(e.indexOf("?")+1)),a=(t=e.split("&")).length,o=0;o<a;o++)t[o]&&(n=t[o].split("="))[0]&&n[1]&&(s[n[0]]=decodeURIComponent(n[1]));if(s.visEvt)try{(i=JSON.parse(s.visEvt))&&i.eventId&&(s.eventId=i.eventId,s.eventid=i.eventId)}catch(e){}return s},hasStorage:function(){var e;try{if(!window.localStorage)return!1;if(window.localStorage.setItem("echt_test_storage","ok"),!(e=window.localStorage.getItem("echt_test_storage")))return!1}catch(e){return!1}return e&&window.localStorage.removeItem("echt_test_storage"),!0}(),hasCookie:($.cookie("echt_test_cookie","ok"),!!$.cookie("echt_test_cookie")&&($.cookie("echt_test_cookie",null),!0)),getBackground:function(e,t){var n,a=[],o=parseInt(t||100)/100,i=(e||"rgb(255,255,255)").toLocaleLowerCase().trim();if(0==i.indexOf("rgb"))i=i.replace("rgb","rgba").replace(")",","+o+")");else if(0==i.indexOf("#")){for(i=i.replace("#","").split(""),n=0;n<i.length;n++)3==i.length?a.push(parseInt("0x"+i[n]+i[n])):n%2==0&&a.push(parseInt("0x"+i[n]+i[n+1]));a.push(o),i="rgba("+a.join()+")"}return i},init:function(){var e=this,t=this;this.queryParams=this.getQueryParams(),this.companyId=this.getQueryString("companyid"),$.store=this.hasStorage?function(e,t,n){return e?arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(t))||null==t)?(n=$.extend({},n),null==t&&(n.expires=-1),t=String(t),n.session?window.sessionStorage.setItem(e,t):window.localStorage.setItem(e,t),t):(n=t||{}).local?window.localStorage.getItem(e):n.session?window.sessionStorage.getItem(e):window.localStorage.getItem(e)||window.sessionStorage.getItem(e)||$.cookie(e):null}:$.cookie,this.checkDomain=function(e,t){function n(e){return e.replace(/^http[s]?:\/\//i,"")}if(!e||!t||!t.length)return!1;e=n(e);for(var a=0;a<t.length;a++)if(t[a]&&(e==n(t[a])||-1!=e.indexOf(t[a].replace(/[^\.]+./,""))))return!0;return!1};var n,a=navigator.userAgent.toLowerCase();function i(e,t){return e.type=="pointer"+t||e.type.toLowerCase()=="mspointer"+t||e.type=="mouse"+t}this.Browser={isMobile:/android|iphone|ipod|windowsphone|mobile/i.test(a),isWindows:/windows/i.test(a)||-1!=a.indexOf("win32"),isMac:-1!=a.indexOf("macintosh")||-1!=a.indexOf("mac os x")||-1!=window.navigator.platform.indexOf("Mac"),isIPhone:-1!=a.indexOf("iPhone"),isIOS:!!a.match(/iphone os\s(\d+)/),isAndorid:/android/i.test(a)},this.Browser.isIOS&&(this.Browser.osVersion=+/\d+/.exec(new RegExp("iphone os \\d+").exec(a)||"")),t.Browser.isPC=!this.Browser.isMobile,t.isMobile=this.Browser.isMobile,t.clickName=t.isMobile?"touchstart":"click",this.Device={OS:this.Browser.isAndorid?"android":this.Browser.isIPhone?"ios":this.Browser.isWindows?"windows":this.Browser.isMac?"osx":"other"},n=window.mobilePage||-1!=location.href.split("?")[0].indexOf("/visitor/mobile/")&&!g.outerId,t.Browser.isMobile||n||!t.Browser.isPC?t.Device.media=2:t.Device.media=1,this.iScrollParam=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({bounce:!this.Browser.isIOS||this.Browser.osVersion<14},o.default.iScrollParam),console.log("iScrollParam",this.iScrollParam,this.Browser.osVersion),this.hasTranslation=this.Browser.isMobile,this.setTransform=function(e,n){var a="translate("+e+"px,"+n+"px)";t.hasTranslation?$(this).css({"-webkit-transform":a,"-o-transfrom":a,"-ms-transform":a,"-moz-transform":a,transform:a}):$(this).css({left:e+"px",top:n+"px"})},d="getSelection"in window?function(){window.getSelection().removeAllRanges()}:function(){document.selection.empty()},this.pageSlide=function(e,n){$(e).attr("x","0"),$(document).on("mousedown touchstart",e,(function(e){if(!i(e=e||window.event,"down")||((a=e).type.indexOf("mouse")>-1||("touch"==a.pointerType||a.pointerType==a.MSPOINTER_TYPE_TOUCH)&&a.isPrimary)){var a,o,s,r,l=i(e,"down"),c={},u=0,f=$(this),p=this.parentNode.clientWidth,h=p/8,m=parseInt(f.attr("x")||this.offsetLeft)||0,g=this.clientWidth,v=-g+p-20;c.x2=void 0,c.y2=void 0,e=l?e:e.touches&&e.touches[0]||e,c.x1=e.clientX,c.y1=e.clientY,f.removeClass("transition"),o=function(e){e.cancelable=!0,e.preventDefault()},p=parseInt(g/parseInt(g/p)),document.body.addEventListener&&document.body.addEventListener("touchmove",o,{passive:!1}),s=function(e){if(f){e=l?e:e.touches&&e.touches[0]||e,c.x2=e.clientX,c.y2=e.clientY,u=c.x2-c.x1,c.y2-c.y1;var n=u+m;n>20?n=20:n<v&&(n=v),t.setTransform.call(f,n,0),f.attr("x2",n),d(),e.originalEvent&&(e=e.originalEvent),e.cancelable=!0,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}},r=function(e){if(d(),f){f.addClass("transition");var a,i=0;if(h<Math.abs(u)?u>=h&&m+p<=0?(t.setTransform.call(f,m+p,0),f.attr("x",m+p),i=-1):u<=-h&&m-p+g>p/10?(t.setTransform.call(f,m-p,0),f.attr("x",m-p),i=1):t.setTransform.call(f,m,0):t.setTransform.call(f,m,0),a=n&&n(i),$(document).off("mousemover mousemove touchmove pointermove",s).off("mouseup touchend pointerup",r),f=null,d(),!1===a)return e.stopPropagation&&e.stopPropagation,e.preventDefault&&e.preventDefault(),!1;document.body.removeEventListener&&document.body.removeEventListener("touchmove",o)}},$(document).on("mousemover mousemove touchmove pointermove",s).on("mouseup touchend pointerup",r)}}))},this.getCSSRule=function(e,t,n){if(n=n||window.document,e=e.toLowerCase(),n.styleSheets)for(var a=0;a<n.styleSheets.length;a++){var o=n.styleSheets[a],i=0,s=!1;do{if((s=o.cssRules?o.cssRules[i]:o.rules&&o.rules[i])&&s.selectorText&&s.selectorText.toLowerCase()==e)return"delete"==t?(o.cssRules?o.deleteRule(i):o.removeRule(i),!0):s;i++}while(s)}return!1},this.setCss=function(t,n){if(t&&n){var a=e.getCSSRule(t);if(a)if(e.isArray(n))for(var o=0;o<n.length;o++)n[o].value&&(a.style[n[o].attr]=n[o].value);else n.value&&(a.style[n.attr]=n.value)}},this.killCSSRule=function(e){return this.getCSSRule(e,"delete")},this.addCSSRule=function(e){return document.styleSheets&&(this.getCSSRule(e)||(document.styleSheets[0].addRule?document.styleSheets[0].addRule(e,null,0):document.styleSheets[0].insertRule(e+" { }",0))),this.getCSSRule(e)},this.getBackground=function(e,t){var n,a=[],o=parseInt(t||100)/100,i=(e||"rgb(255,255,255)").toLocaleLowerCase().trim();if(0==i.indexOf("rgb"))i=i.replace("rgb","rgba").replace(")",","+o+")");else if(0==i.indexOf("#")){for(i=i.replace("#","").split(""),n=0;n<i.length;n++)3==i.length?a.push(parseInt("0x"+i[n]+i[n])):n%2==0&&a.push(parseInt("0x"+i[n]+i[n+1]));a.push(o),i="rgba("+a.join()+")"}return i}},base64encode:function(e){var t,n,a,o,i,s,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(a=e.length,n=0,t="";n<a;){if(o=255&e.charCodeAt(n++),n==a){t+=r.charAt(o>>2),t+=r.charAt((3&o)<<4),t+="==";break}if(i=e.charCodeAt(n++),n==a){t+=r.charAt(o>>2),t+=r.charAt((3&o)<<4|(240&i)>>4),t+=r.charAt((15&i)<<2),t+="=";break}s=e.charCodeAt(n++),t+=r.charAt(o>>2),t+=r.charAt((3&o)<<4|(240&i)>>4),t+=r.charAt((15&i)<<2|(192&s)>>6),t+=r.charAt(63&s)}return t},checkHistoryTime:function(e){return(!u||e-u>55e3)&&(u=e,!0)},appendToListMsg:function(e,t){var n,a,o=document.createElement("ul"),i=_$("list_msg"),s=o.childNodes,r=0;if(o.innerHTML=e,t&&(n=_$("list_msg").childNodes[0]),n)for(r=s.length-1;a=s[r--];)1==a.nodeType&&(a=a.cloneNode(!0),i.insertBefore(a,n));else for(;a=s[r++];)1==a.nodeType&&(a=a.cloneNode(!0),i.appendChild(a));s=null,o=null},checkIpt:function(e,t,n,a){var i,s,r=!0,l=!1,c=o.default.validRule;if(1==e.nodeType?i=c[n]||c[e.type]:e.length>1&&e[0]&&(l=!0,e=e[0]),!t&&(e.className.indexOf("req")>-1||$(e).parents(".req").length)){r=!1;s="text"==e.type?lanRes.inputPlease.replace("${inputName}",e.getAttribute("lb")):lanRes.inputPleaseJa2.replace("${inputName}",l?$(e).parents(".entry2-typeline").attr("lb"):e.getAttribute("lb"))}else if(t&&i)if(i.length&&t.length>i.length){r=!1;s="age"==n?lanRes.ageOverLengthJa.replace("${age}",e.getAttribute("lb")):e.getAttribute("lb")+lanRes.overLength}else i.p&&!t.match(i.p)&&(r=!1,s=i.msg||lanRes.visitor170+e.getAttribute("lb"));return a?(a&&a(r),r&&e.style?this.hideTip():s&&this.showTip(s)):r&&e.style?(e.style.borderColor="#FFFFFF",this.hideTip()):(e.style.borderColor="#FF0000",s&&this.showTip(s)),r},HTMLDecode:function(e){var t,n=document.createElement("div");return null!=n.textContent?n.textContent=e:n.innerText=e,t=n.innerHTML,n=null,t}},h=null,m=!1,c.showTip=function(e,t){m||(m=!0,_$("leave_tip")||$("body").append('<div class="leave-tip tiphide" id="leave_tip"><div class="leave-tip-content"><div class="info-warn echat"></div><div class="info-con" id="leave_tip_con"></div></div></div>')),h&&clearTimeout(h),e&&(_$("leave_tip_con").innerHTML=e),_$("leave_tip").className="leave-tip leave-tip-"+(t||"warn"),h=setTimeout((function(){$("#leave_tip").addClass("tiphide")}),3e3)},c.hideTip=function(){this.tipTimer&&clearTimeout(this.tipTimer),$("#leave_tip").addClass("tiphide")},function(){var e=!1,t=c,n=t.clickName;function a(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}function o(){e=!0,$(".dialog").on(n,".dialog-close",(function(e){$(".dialog").remove(),t.publish("_dialogCanel"),a(e)})).on(n,".img-close",(function(e){$(".dialog").remove(),t.publish("_dialogCanel"),a(e)})).on(n,".dialog-cancel",(function(e){$(".dialog").remove(),t.publish("_dialogCanel"),a(e)})).on(n,".dialog-ok",(function(e){$(".dialog").remove(),t.publish("_dialogOk"),a(e)}))}c.showDialog=function(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=a.tip;function s(e){var a,o=$(".dialog").results,i=$(".dialog-ok").results[0],r=$(".dialog-cancel").results[0],l=$(".dialog-close").results[0];0==o.length?$("body").off(n,s):(a=e.srcElement||e.target,setTimeout((function(){i==a||$.fn.contains(i,a)?(t.publish("_dialogOk"),$(".dialog").remove()):(r==a||$.fn.contains(r,a)||l==a||$.fn.contains(l,a))&&(t.publish("_dialogCanel"),$(".dialog").remove())}),50))}$(".dialog").remove(),t.publish("_dialogCanel"),i&&(e='<div class="dialog dialog-hide"><div class="dialog-close"><i class="img-close"></i></div><div class="dialog-title">'+lanRes.tip+'</div><div class="dialog-content">'+i+'</div><div class="dialog-btns"><a class="dialog-btn dialog-ok bg0"><div class="bg0 fade-div"></div><span>'+(a.okTip||lanRes.okay)+"</span></a>"+(!1!==a.cancel?'<a class="dialog-btn dialog-cancel bg0 has-fade"><div class="bg0 fade-div"></div><span>'+lanRes.cancel+"</span></a>":"")+"</div></div>",$(_$("index")||"body").append(e),t.unSubscribe(["_dialogOk","_dialogCanel"]),t.subscribe("_dialogOk",(function(){$("body").off(n,s),a.ok&&a.ok(),t.unSubscribe(["_dialogOk","_dialogCanel"])})),t.subscribe("_dialogCanel",(function(){$("body").off(n,s),a.cancel&&a.cancel(),t.unSubscribe(["_dialogOk","_dialogCanel"])})),setTimeout((function(){o(),$("body").on(n,s),$(".dialog").removeClass("dialog-hide")}),10),t.publish("inputBlur",{from:"dialog"}))},c.showAlertDialog=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};$(".dialog").remove(),!e&&o();var i,s=a.tip;function r(e){var a=$(".dialog").results,o=$(".dialog-ok").results[0];0==a.length?$("body").off(n,r):setTimeout((function(){(o==e.target||$.fn.contains(o,e.target))&&(t.publish("_dialogOk"),$(".dialog").remove())}),50)}s&&(i='<div class="dialog dialog-hide"><div class="dialog-title">'+lanRes.tip+'</div><div class="dialog-content">'+s+'</div><div class="dialog-btns"><a class="dialog-btn dialog-ok bg0"><div class="bg0 fade-div"></div><span>'+(a.okTip||lanRes.okay)+"</span></a></div></div>",$("body").append(i),$("#mask").show(),t.unSubscribe("_dialogOk"),t.subscribe("_dialogOk",(function(){$("body").off(n,r),a.ok&&a.ok(),t.unSubscribe("_dialogOk"),$("#mask").hide()})),setTimeout((function(){$("body").on(n,r),$(".dialog").removeClass("dialog-hide")}),10))}}(),"undefined"==typeof console&&(window.console={log:function(e){}}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.toString().replace(/(^\s+)|(\s+$)/g,"")}),Date.prototype.format=function(e){var t,n={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(t in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[t]:("00"+n[t]).substr((""+n[t]).length)));return e},Function.prototype.before=function(e){var t=this;return function(){return!1!==e.apply(this,arguments)&&t.apply(this,arguments)}},Function.prototype.after=function(e){var t=this;return function(){var n=t.apply(this,arguments);return!1!==n&&(e.apply(this,arguments),n)}},Function.prototype.afterFilter=function(e){var t=this;return function(){var n=t.apply(this,arguments);return!1!==n&&(arguments[arguments.length]=n,arguments.length+=1,e.apply(this,arguments))}},c.init.call(c),Object.assign(c,i.default),c.subscriber.call(c,"util"),c.setSub("util"),c.setSub("handle"),c.setSub("connect");var b=c;t.default=b},44:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(39),n(65),n(26),n(67),n(18),n(90),n(68),n(91),n(92);var a=n(4);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,s={},r=1;function l(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e}function c(e,t,n,a){console.log(e+"：名字："+t+"：value：",n);try{var o={functionName:t,value:n||""};a&&"function"==typeof a&&(o.callback="callbackview_"+r,s[o.callback]=function(){console.log("callbackview_***"+o.callback,arguments),a.apply(a,arguments),window[o.callback]=null},r++),window.EchatJsBridge?window.EchatJsBridge&&EchatJsBridge[e](JSON.stringify(o)):window.webkit&&window.webkit.messageHandlers[e].postMessage(JSON.stringify(o))}catch(e){}}var d={initNativeAPI:function(e,t){window[t]||function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"callEchatJs";window[e]=function(t){try{var n,r,c,d;if(!(n="string"==typeof t?JSON.parse(t+""):t))return console.log("错误调用",arguments);c=l(n.value),r=n.functionName,c=n.value;try{console.log(r,c&&"object"==o(c)?JSON.stringify(c):c,"::",e)}catch(e){}if(!r||!s[r])return;if(i&&"forwardConfigMessage"!==r&&"forwardStaffInfo"!==r&&"nativeReady"!==r)if((0,a.isArray)(c)?d=c[0].companyId:"object"==o(c)&&(d=c),d&&i!=i)return;s[r](c)}catch(e){console.log(e)}}}(t),s=Object.assign(s,e)},callEchatNative:function(e,t,n){e&&("openUrl"==e&&(t.registerBridge||(t.registerBridge=7,t.isCanOtherHandle=1)),c("callEchatNative",e,t,n))},callEchatNativeConnect:function(e,t,n){e&&c("callEchatNativeConnect",e,t,n)},setCurrentCompanyId:function(e){i=e}};t.default=d},52:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(28),n(3),n(20),n(9),n(24),n(43),n(18),n(27),n(199);var a=c(n(4)),o=c(n(6)),i=n(13),s=c(n(53)),r=n(203),l=c(n(206));function c(e){return e&&e.__esModule?e:{default:e}}var d,u,f=window._echat0;function p(e,t){var n,a=(0,i.getMsgDomId)(e),o=_$(a);if(!o)return!1;if(t)return t(o,e);if(!(n=(0,r.getMsgContent)(e,e,[""])))return!1;var s=$(".msg-item",o);s.length||(s=$(".info-con",o)),s.length&&n!=s.results[0].innerHTML&&$(s).html(n);var l=h(e);return $(".msg-error",o).remove(),l&&$(".msg-con",o).append(l),!0}function h(e){var t=r.handleMap.getResendClass(e,e.et||e.mt);return t&&'<div class="msg-error '+t+'">&nbsp;</div>'}function m(e){var t=r.handleMap.file(e)||r.handleMap.location(e)?1:r.handleMap.img(e)||r.handleMap.video(e)?2:r.handleMap.voice(e)?3:0;return{itemCls:"clearfix msgli mode"+t+(t>1?" msg-medias":"")}}function g(e){return r.handleMap.staff[e.mt]||r.handleMap.sysToStaff(e)}function v(e,t){var n,s,l=e.mt||e.et,c=(0,i.getMsgDomId)(e);if(!r.handleMap.etmt[l])return!1;if(!t&&_$(c))return console.log("消息已经显示过了,走一下更新消息逻辑",e),161!=e.mt&&162!=e.mt&&163!=e.mt&&164!=e.mt||b(e),p(e),!1;if(n=['<li class="'],!(s=(0,r.getMsgContent)(e,n)))return!1;var d,u,f,v=r.handleMap.robotAnswer(e),y=r.handleMap.sysToRobot(e),I=r.handleMap.visitor[l]||r.handleMap.sysToVisitor(e),k=r.handleMap.sysMsg(e),S=g(e)||v||y,w=!1,T=e.tm||(new Date).getTime();return n=n.concat([m(e).itemCls,'" id="',c,'" >']),w=a.default.checkHistoryTime(T),S?u=function(e,t){var n=t?o.default.getRobotInfo():o.default.getStaff(e.chatStaffId||e.staffId);return{icon:'<div class="avatar-icon fl staff-icons"><img onerror="_echat0.imgError(this)" class="avatar-icon-img" src="'+n.img+'"/></div>',name:e.chatStaffNickName||n.name}}(e,v||y):I?u={icon:'<div class="avatar-icon fr"><img onerror="_echat0.imgError(this)" class="avatar-icon-img" src="'+o.default.getVisitorImg()+'"/></div>'}:k||(w=!1),w&&!t&&n.push('<div class="time-line"><div class="color1 tc">'+new Date(T).format("hh:mm")+"</div></div> "),o.default.getConfig("showAvatar")&&u&&u.icon&&n.push(u.icon),S?(n.push('<div class="msg msg-lf fl">'),n.push('<div class="msg-staff-name">'),n.push(u.name),n.push('</div><div class="msg-con radius4 fl bg1">'),n.push('<i class="msg-angle colorbg1"></i>'),n.push('<div class="msg-item">'),f="</div></div></div>"):I?(d=h(e),n.push('<div class="msg msg-rt fr">'),n.push('<div class="msg-con radius4 fr bg3">'),n.push('<i class="msg-angle colorbg3"></i>'),d&&n.push(d),n.push('<div class="msg-item">'),f="</div></div></div>"):k&&(n[0]=n[0]+"tc ",n.push('<div class="msg-info radius4">'),n.push('<div class="info-con">'),f="</div></div>"),n.push(s),f&&n.push(f),n.push("</li>"),n}function y(){f.scrollToBottom=s.default.refreshChatScroll,s.default.refreshAndRemain()}function b(e){p(e,(function(e,t){var n=$(".msg-preview-info",e),a=(0,r.getSendProgess)(t),o=h(t);a?n?$(".msg-preview-progress",e).html((t.progress||0)+"%"):$(e).append(a):n.remove(),$(".msg-error",e).remove(),o&&$(".msg-con",e).append(o)}))}f.scrollToBottom=s.default.scrollToBottom,f.imgError=(u=[],a.default.subscribe("changeNetStatus",(function(e,t){if(t){var n,a,o="";for(a=0;a<u.length;a++)o=u[a].src,u[a].src="",u[a].src=o;n=u[a-1],u=[],s.default.scrollToBottom(500),n&&$(n).on("load",(function e(){s.default.scrollToBottom(500),$(n).off(e)}))}})),function(e,t){if(!e.src||e.src.match(/^http/)){var n,a;u.push(e)}else{var i=(n=$(e).parents(".msgli").attr("id"),(a=o.default.getMsgFromHistory(n))&&a.msg);i&&(i.smallImg||i.remoteThumbnaiLPath)&&(e.src=i.smallImg||i.remoteThumbnaiLPath)}}),d={showMsg:function e(t){var n=v(t);if(n){var i=o.default.getDataByName("historyLastEchatId"),r=i&&o.default.getMsgFromHistory(i);r&&t.allExtra&&(t.allExtra.mid&&t.allExtra.mid<r.originData.mid||t.allExtra.echatId&&t.allExtra.echatId<r.originData.echatId)?(a.default.appendToListMsg(n.join(""),!0),y()):(a.default.appendToListMsg(n.join("")),t.allExtra&&!t.allExtra.echatId?y():(f.scrollToBottom=s.default.scrollToBottom,s.default.scrollToBottom(50))),"restartChat"!=t.id&&$(".btn-restart").length&&$("#restartChat").length&&($("#restartChat").remove(),e({id:"restartChat",mt:20,tm:(new Date).getTime(),content:'<span class="btn-restart">'+lanRes.toContinueChat+"</span>"}))}},updateMsg:p,replaceMsg:function(e){var t,n,a,o,s=(0,i.getMsgDomId)(e),r=_$(s);return!!r&&(!!(a=v(e,!0))&&(t=(a=a.join("")).match(/class="([^"]+)"/)[1],o=a.replace(/^<li[^>]+>/,"").replace(/<\/li>$/,""),(n=$(".time-line",r)).length&&(o='<div class="time-line">'+(n=n.results[0].innerHTML)+"</div>"+o),r.className=t,r.innerHTML=o,!0))},removeMsg:function(e){var t=(0,i.getMsgDomId)(e),n=_$(t);n&&($(n).remove(),s.default.refreshChatScroll())},getMsgDomId:i.getMsgDomId,updateMsgProgress:b,updateMsgStaff:function(){o.default.getMsgList.forEach((function(e){p(e.data,(function(e,t){if(g(t)){var n=t.chatStaffId||t.staffId,a=o.default.getStaff(n),i=$(".avatar-icon-img",e).attr("src"),s=$(".msg-staff-name",e).text();i!=a.img&&$(".avatar-icon-img",e).attr("src",a.img),s!=a.name&&$(".msg-staff-name",e).text(a.name)}}))}))}},(0,r.init)(p),l.default.init(d);var I=d;t.default=I},53:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(10);var a,o=r(n(200)),i=r(n(4)),s=n(13);function r(e){return e&&e.__esModule?e:{default:e}}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"content";if(!a[e]){if(!i.default.Browser.isIOS||i.default.Browser.osVersion<14)return $("#"+t).css("overflow","hidden"),void(a[e]=new o.default("#"+t,{zoom:!1,click:!0,movable:!1,tap:"click",bounceTime:300,disableTouch:!1,preventDefault:!1,preventDefaultException:/^(A|PRE|INPUT|TEXTAREA|BUTTON|SELECT|LABEL)$/}));document.addEventListener("touchmove",(function(e){return e.stopPropagation(),e.preventDefault(),!1}),!1),_$(t).style.overflowY="auto";var n={scrollTo:function(e,n,a){console.log("scrollto",e,n),_$(t).scrollTo(e,-n)},refresh:function(){}};Object.defineProperty(n,"maxScrollY",{enumerable:!1,configurable:!1,get:function(){return-_$(t).scrollHeight+_$(t).clientHeight}}),Object.defineProperty(n,"y",{enumerable:!1,configurable:!1,get:function(){return-_$(t).scrollTop}}),a[e]=n}}var c=a={init:function(){l("chatScroll","content")},initScroll:l,chatScroll:void 0,refreshChatScroll:function(){var e=a.chatScroll;e&&e.refresh()},scrollToElement:function(e,t){var n=a.chatScroll;n&&document.getElementById(e)&&(n.refresh(),setTimeout((function(){var t=document.getElementById(e),n=a.chatScroll,o=t.offsetTop,i=t.offsetHeight,s=document.getElementById("content").clientHeight,r=-n.y;n.refresh(),o>r&&r+s>o+i||n.scrollTo(0,-t.offsetTop+(s-i-20),!0)}),t||0))},scrollToBottom:function(e){var t=a.chatScroll;t&&(t.refresh(),setTimeout(a.imemediateToBottom,e||0))},refreshAndRemain:function(e){var t=a.chatScroll;t&&(t.refresh(),t.y===t.maxScrollY&&setTimeout(a.imemediateToBottom,e||0))},imemediateToBottom:(0,s.throttle)((function(){var e=a.chatScroll;e.refresh(),e.scrollTo(0,e.maxScrollY,!0)}),30)};t.default=c},6:function(e,t,n){"use strict";n(26),n(67),n(18),n(90),n(68),n(91),n(92),n(38),n(42),n(50),n(27),n(51),n(190),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(3),n(108),n(117),n(65),n(43),n(66),n(20);var a,o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==d(e)&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var r=o?Object.getOwnPropertyDescriptor(e,i):null;r&&(r.get||r.set)?Object.defineProperty(a,i,r):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(4)),i=(a=n(32))&&a.__esModule?a:{default:a};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u,f,p=0,h=(new Date).getTime()+"",m={configs:{locationBase:"https://chats.rainbowred.com",config600:{},config649:{},companyVersionType:!1,isVip:!1,busyCanSend:!0,showAvatar:!0,hasSearchInSameScreen:!1,hasInputAssociation:!1,inputMaxLength:2e3,maxRobotLength:100,pageTitle:"",customListConfig:"",urlListConfig:""},staffInfo:{},msgList:[],statusData:{fisrtChatstatus:-1,canChatNow:0,chatStatus:0,statusName:"",status:0,talkType:0,unreadCount:0,sendMsgNum:0,satisfySubmited:void 0,currentProcess:0,lastMsgTM:0,lasMid:0,isInWorkOrder:!1,isInEntryOrCode:!1,visitorClose:!1,visitorEntryInput:{},captChaToken:void 0},visitorInfo:(f=o.default.getQueryParams(location.search),f.companyId=Number(f.companyId),f.fm=(0,o.checkFirstMsg)(f.fm)||void 0,f),otherData:{emoCodeTolan:{},emoLanToCode:{},emoMap:null,netConnected:!0,websocketStatus:2,hasPreHistory:!0,historyLastEchatId:0,doms:{unread:[{name:"#leaveBar",removeCls:"hide",config:function(e){var t=m.statusData;t.isInWorkOrder?$("#leaveBar").html(lanRes.visitor186):2==t.status?$("#leaveBar").html(lanRes.leaveToLeaveBtn):$("#leaveBar").html(lanRes.leaveToChatBtn)}},{name:"#chatText",cls:"hide"}],queue:[{name:"html",removeCls:["entry2","page-leave"]},{name:"body",removeCls:["robot","entry2","page-leave"]},{name:"#leaveBar",cls:"hide"},{name:"#chatText",removeCls:"hide"},{name:"#textInput",attr:{placeholder:""},isHtml:!0,config:function(e){e.attr.placeholder=lanRes.inputPlaceholder2}},{name:"#robotToStaff",cls:"hide"},{name:".robot-staff",removeCls:["robot-staff"],show:!1},{name:".menu-emo",cls:"hide"},{name:".record-switch",cls:"hide"},{name:".tool-menu-item",cls:"hide"},{name:".url-list-item",cls:"hide"},{name:"#busyTipLine",cls:"hide",config:function(e){var t=u.getChatbox();t.busyNotAllowTips&&$("#busyTip").html(t.busyNotAllowTips)}},{name:"#inputSuggest",cls:"hide"},{name:"#inputLengthTip",cls:"hide"},{name:"#entry",cls:"hide"},{name:"#verify",cls:"hide"}],staff:[{name:"html",removeCls:["entry2","page-leave"]},{name:"body",removeCls:["robot","entry2","page-leave"]},{name:"#leaveBar",cls:"hide"},{name:"#chatText",removeCls:"hide"},{name:"#textInput",attr:{placeholder:""},isHtml:!0,config:function(e){e.attr.placeholder=lanRes.inputPlaceholder2}},{name:"#robotToStaff",cls:"hide"},{name:".robot-staff",removeCls:["robot-staff"],show:!1},{name:".menu-emo",removeCls:"hide"},{name:".record-switch",removeCls:"hide"},{name:".tool-menu-item",removeCls:"hide"},{name:".url-list-item",removeCls:"hide"},{name:"#busyTipLine",cls:"hide"},{name:"#inputSuggest",cls:"hide"},{name:"#inputLengthTip",cls:"hide"},{name:"#entry",cls:"hide"},{name:"#verify",cls:"hide"}],leave:[{name:"html",removeCls:["entry2","page-leave"]},{name:"body",removeCls:["robot","entry2","page-leave"]},{name:"#leaveBar",cls:"hide"},{name:"#chatText",removeCls:"hide"},{name:"#textInput",attr:{placeholder:""},isHtml:!0,config:function(e){e.attr.placeholder=lanRes.inputPlaceholder2}},{name:"#robotToStaff",cls:"hide"},{name:".robot-staff",removeCls:["robot-staff"],show:!1},{name:".menu-emo",removeCls:"hide"},{name:".record-switch",removeCls:"hide"},{name:".tool-menu-item",removeCls:"hide"},{name:".url-list-item",removeCls:"hide"},{name:".menu-satisfy",cls:"hide"},{name:".menu-phone",cls:"hide"},{name:"#busyTipLine",cls:"hide"},{name:"#inputSuggest",cls:"hide"},{name:"#inputLengthTip",cls:"hide"},{name:"#entry",cls:"hide"},{name:"#verify",cls:"hide"}],robot:[{name:"html",removeCls:["entry2","page-leave"]},{name:"body",cls:"robot"},{name:"#leaveBar",cls:"hide"},{name:"#chatText",removeCls:"hide"},{name:"#textInput",attr:{placeholder:""},isHtml:!1,config:function(e){var t=m.configs.config649;e.attr.placeholder=t.robotWordsInfo.inputBoxWords||lanRes.inputPlaceholder2}},{name:"#robotToStaff",config:function(){var e=m.configs.config649,t=m.statusData,n=u.getConfig("isVip")?e.sdkVipVisitorRobotConfig||e.webVipVisitorRobotConfig:e.sdkVisitorRobotConfig||e.webVisitorRobotConfig;1==t.status?$("#robotToStaffWord").html(e.robotWordsInfo.onlineButtonWords||lanRes.robotToStaff):$("#robotToStaffWord").html(e.robotWordsInfo.offlineButtonWords||lanRes.robotToStaff),$("#toHumanWords").html(e.robotWordsInfo.toHumanWords||""),"1"!=n.enableManualSwitch?$("#robotToStaff").addClass("limit-hide"):("1"==n.enableLeaveBtnWhenStaffOffline&&2==t.status||"1"==n.enableSwitchBtnWhenStaffOnline&&2!=t.status)&&$("#robotToStaff").removeClass("hide")}},{name:".robot-staff",show:!0},{name:".menu-emo",cls:"hide"},{name:".record-switch",cls:"hide"},{name:".tool-menu-item",cls:"hide"},{name:".url-list-item",removeCls:"hide"},{name:"#busyTipLine",cls:"hide"},{name:"#inputSuggest",cls:"hide"},{name:"#inputLengthTip",cls:"hide"},{name:"#entry",cls:"hide"},{name:"#verify",cls:"hide"}],reset:[{name:"html",removeCls:["entry2","page-leave"]},{name:"body",removeCls:["robot","entry2","page-leave"]},{name:"#leaveBar",cls:"hide"},{name:"#chatText",removeCls:["hide","recording"]},{name:"#textInput",attr:{placeholder:""},isHtml:!0,config:function(e){e.attr.placeholder=lanRes.inputPlaceholder2}},{name:"#robotToStaff",cls:"hide"},{name:".robot-staff",removeCls:["robot-staff"],show:!1},{name:".menu-emo",cls:"hide"},{name:".record-switch",cls:"hide"},{name:".tool-menu-item",cls:"hide"},{name:".url-list-item",cls:"hide"},{name:"#busyTipLine",cls:"hide"},{name:"#inputSuggest",cls:"hide"},{name:"#inputLengthTip",cls:"hide"},{name:"#entry",cls:"hide"},{name:"#verify",cls:"hide"}]}}};window.DataObject=m,window.Util=o.default,u={setConfig:function(e,t){var n=m.configs[e];n&&"object"==d(n)?m.configs[e]=Object.assign(n,t):m.configs[e]=t},setConfigs:function(e){var t,n;for(n in e)(t=m.configs[n])&&"object"==d(t)?m.configs[n]=Object.assign(t,e[n]):m.configs[n]=e[n]},getConfig:function(e){return m.configs[e]},getDataByName:function(e){return m.otherData[e]},setDataByName:function(e,t){m.otherData[e]=t},getVisitorInfo:function(e){return e?m.visitorInfo[e]:m.visitorInfo},setVisitorInfo:function(e){Object.assign(m.visitorInfo,e)},getStaffInfo:function(){return m.staffInfo},setStaffInfo:function(e){Object.assign(m.staffInfo,e)},getMsgList:function(){return m.msgList},getMsgListFirst:function(){var e=m.msgList[0];return e&&e.echatId?e:null},updateMsgList:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"push";if("replace"===t)m.msgList=e;else if("push"==t)o.default.isArray(e)?m.msgList=m.msgList.concat(e):m.msgList.push(e);else if("remove"==t){var n=u.getMsgFromHistory(e.id);n&&m.msgList.splice(n.index,1)}else"unshift"==t&&(o.default.isArray(e)?m.msgList=e.concat(m.msgList):m.msgList.unshift(e))},getStatusData:function(){return m.statusData},getStatusByKey:function(e){return m.statusData[e]},setStatusByKey:function(e,t){return m.statusData[e]=t},setStatusData:function(e){Object.assign(m.statusData,e)},getChatbox:function(){var e,t=m.statusData,n=t.chatStatus,a=t.talkType,o=m.configs.config649;return 2==n&&a==i.default.talkTypeRobot&&(e=o[i.default.chatboxRobotName]||o.robotPhoneChatBox),e||(e=o[i.default.chatboxName]||o.robotSdkChatBox),e},getStaff:function(e){e=e||m.statusData.staffId;var t=m.staffInfo[e]||{},n=m.configs.config649,a=n[i.default.chatboxName]||n[i.default.chatboxRobotName]||{};return m.staffInfo[e]||o.default.publish("sendMessage",{et:153,companyId:m.visitorInfo.companyId,staffIds:e+""}),{staffId:e,phone:t.staffPhone,img:t.staffHead||a.defaultStaffImg,name:t.staffNickName||lanRes.serviceStaff}},getVisitorImg:function(){var e=u.getChatbox();return m.configs.config600.photo||e.defaultVisitorImg},getRobotInfo:function(){var e=m.configs.config649,t=e.robotConfigInfo,n=e.robotExtInfo,a=e[i.default.chatboxRobotName];return t&&t.hasRobotDefImg&&(t.robotImg=a&&a.defaultStaffImg),{img:t&&t.robotImg||a&&a.defaultStaffImg,name:n&&n.nickName||"小洽"}},formatRouteList:function(){var e,t,n,a,o,i,s=m.configs.config695.routeEntranceInfo||m.configs.config695.routeEntranceInfoString,r=0,l={};if("string"==typeof s&&(s=JSON.parse(s),m.configs.config695.routeEntranceInfo=s),o="string"==typeof s.entranceDetails?JSON.parse(s.entranceDetails):s.entranceDetails,(i=s.routeStatusList)&&i.length)for(t=0;t<i.length;t++)l[i[t].routeId]=2!=i[t].routeStatus;for(e=0;e<o.length;e++)(a=o[e].routeId)&&(n=o[e],r++,l[a]?n.icon||(n.icon=n.offlineIcon):(n.icon=n.offlineIcon||n.icon,n.content=n.offlineContent||n.content));return!!r&&(s.entranceDetails=o,s)},getEntryInfo:function(e){var t;if(e=e||m.configs.config649,0==m.statusData.canChatNow)return(t=e.entranceInfo=e.entranceInfo||e.sdkEntranceInfo||e.mobileEntranceInfo)&&1==t.visitorInfoEnable&&(2!=m.statusData.status?1==t.enableOnline:1==t.enableOffline)&&t},getLeaveConfig:function(e){return(e=e||m.configs.config649).offlineBoxInfo||e.offlineSmallBoxInfo||e.mobileOfflineBoxInfo||e.sdkOfflineBoxInfo},getEvaluateAndLimit:function(){var e=m.configs.config649,t={limit:0,enable:!1,config:null},n=e.sdkEvaluateInfo||e.evaluateInfo||e.smallEvaluateInfo||e.mobileEvaluateInfo;return n?(t.enable="1"==n.enable,t.config=n,"1"==n.enableVisitorEvaluateLimit&&(t.limit=parseInt(n.allowEvaluateBaseWords||0)),t):t},checkMatchId:function(e,t){if(!t||!e)return!1;var n=e.data||e;return n.clientFileId==t||n.identityKey==t||n.fileIdentity==t||n.echatId==t||n.mid==t||n.id==t||n.bridgeMsgId==t||e.et&&e.id==t},getMsgFromHistory:function(e){var t,n,a,o=u.getMsgList();for(a=0;a<o.length;a++)if(u.checkMatchId(o[a],e)){t=o[a],n=a;break}return t?{index:n,msg:t.data||t,originData:t}:null},updateHistoryMsgExt:function(e,t,n){if(e&&t){var a,o=u.getMsgFromHistory(e);if(!o)return!1;(a=o.msg).allExtra?a.allExtra.h5Extra||(a.allExtra.h5Extra={}):a.allExtra={h5Extra:{}},a.allExtra.h5Extra[t]=n}},updateHistoryMsgNativeExt:function(e,t,n){if(e&&t){var a,o=u.getMsgFromHistory(e);if(!o)return!1;(a=o.msg).allExtra?a.allExtra.nativeExtra||(a.allExtra.nativeExtra={}):a.allExtra={nativeExtra:{}},a.allExtra.nativeExtra[t]=n}},updateMsgByIndetity:function(e,t){if(t&&e){var n=u.getMsgFromHistory(e);return!!n&&Object.assign(n.msg,t)}},getStatusConfig:function(e){var t=m.statusData,n=m.configs.config649;return 2!=t.chatStatus?void 0:t.talkType==i.default.talkTypeRobot?n.robotSdkChatBox:n.sdkChatBoxInfo},getApiDomain:function(){var e=m.visitorInfo;return e.apiServerDomain?"https://"+e.apiServerDomain:e.dataHost},getNextBridgeMsgId:function(){return h+ ++p}},function(){for(var e in u)e.match(/^get/)&&"getDataByName"!=e&&(u[e]=u[e].afterFilter((function(){var e=arguments[arguments.length-1];return"object"==d(e)&&e?o.default.isArray(e)?[].concat(e):l({},e):e})))}(),window.DataService=u;var g=u;t.default=g},93:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(18),n(27),n(24),n(3),n(9),n(10),n(117);var a=f(n(154)),o=f(n(210)),i=f(n(120)),s=f(n(53)),r=f(n(213)),l=f(n(214)),c=f(n(6)),d=f(n(4)),u=n(13);function f(e){return e&&e.__esModule?e:{default:e}}var p=i.default.checkMenuNums,h={networkDisconnected:1,innerADWrap:1,footer:{name:"#footer",bottom:0},inputSuggest:1,robotToStaff:1,busyTipLine:1,chatText:1,pre_his:1},m={removeCls:function(e,t){e&&(d.default.isArray(e)||(e=[e]),e&&e.length&&e.forEach((function(e){t.removeClass(e)})))},cls:function(e,t){t.addClass(e)},attr:function(e,t){for(var n in e)t.attr(n,e[n])},isHtml:function(e,t,n){"#textInput"==n.name&&e&&2!=a.default.editorType&&a.default.changeToIframe&&a.default.changeToIframe()},html:function(e,t){t.html(e)}},g=(0,u.throttle)((function(){var e=window.getComputedStyle(_$("footer")),t=_$("footer").clientHeight,n=parseInt(e.getPropertyValue("margin-bottom")||0),a="number"==typeof h.footer.bottom?h.footer.bottom:parseInt(e.getPropertyValue("bottom")||0),o=$("#innerADWrap").height()||0+$("#networkDisconnected").height()||0,i=s.default.chatScroll,r=i.y==i.maxScrollY;$("#container").css("padding-bottom",t+n+a+"px"),$("#content").css("height",o?"calc(100% - "+o+"px)":"100%"),i&&(i.refresh(),(i.y<i.maxScrollY||r)&&i.scrollTo(0,i.maxScrollY))}),100);function v(e){var t=!1;e.forEach((function(e){if(e.name){var n,a=$(e.name);if(e.config&&e.config(e),a.length){for(n in e)m[n]&&m[n](e[n],a,e);h[e.name.replace("#","")]&&(t=!0)}}})),t&&g()}function y(e){v(c.default.getDataByName("doms")[e])}d.default.subscribe("changeDom",(function(e,t){t&&("#footer"==t.name&&("number"==typeof t.bottom&&(h.footer.bottom=t.bottom||0),"number"==typeof t.scrollTime&&s.default.scrollToBottom(t.scrollTime)),d.default.isArray(t)||(t=[t]),v(t))}));var b={input:a.default,footer:o.default,scroll:s.default,init:function(){function e(e,t){y("staff")}r.default.init(),a.default.init(i.default),o.default.init(a.default),s.default.init(),l.default.init(),function(){var e=_$("textInput");function t(n){n.target!=e&&(e.blur(),document.removeEventListener("touchend",t,!1))}$("#textInput").on("focus",(function(){a.default.inputFocus=!0,i.default.hideMenus(),s.default.scrollToBottom(500),document.addEventListener("touchend",t,!1)})).on("blur",(function(e){a.default.inputFocus&&(a.default.inputFocus=!1,_$("footer").style.marginBottom="0px",document.body.scrollTop=0,d.default.publish("changeDom",{name:"#footer",bottom:0}))})).on("touchstart touchmove touchend",(function(e){e.stopPropagation()}))}(),setTimeout((function(){n.e(1).then(function(){n(225).default(),$("#emotion").on(d.default.clickName,".emoji",(function(e){var t=$(this).attr("code"),n=a.default.getInput().length+t.length+4,o=c.default.getConfig("inputMaxLength");o&&n>o||a.default.insertImg(t)}))}.bind(null,n)).catch(n.oe)}),10),y("reset"),p(),d.default.subscribe("setTheme",(function(e,t){var n,a=c.default.getChatbox(),o={toolEmoji:".menu-emo",toolFile:".menu-file",toolSatisfaction:".menu-satisfy",toolScreenshot:".menu-capture",toolTelephone:".menu-phone",toolCamera:".menu-camera",toolLocation:".menu-map",toolVoice:".record-switch"};for(n in o)Number(a[n])?$(o[n]).removeClass("style-tool-hide"):$(o[n]).addClass("style-tool-hide");p()})),d.default.subscribe("startLeave",(function(e){y("leave")})),d.default.subscribe("startQueue",(function(t,n){c.default.getConfig("busyCanSend")?e():y("queue"),$(".menu-satisfy").addClass("hide")})),d.default.subscribe("startChat",e),d.default.subscribe("updateChatStaffInfo",(function(){var e=c.default.getStaff();e&&e.phone?($(".menu-phone-a").attr("href","tel:"+e.phone),$(".menu-phone").removeClass("hide")):$(".menu-phone").addClass("hide"),$(".sa-avatar").html('<img src="'+e.img+'"/>'),d.default.publish("__setTitle",c.default.getStaff().name)})),d.default.subscribe("startRobot",(function(e,t){y("robot")})),d.default.subscribe("chatEnded",(function(e,t){y("reset"),p(),l.default.reset()})),d.default.subscribe("enterUnread",(function(e,t){y("unread")})),d.default.subscribe("leaveDisabled",(function(e,t){if(t){$("#mask").css({display:"block"}),$("#leaveDisabled").html('<div class="leave-disabled-tip" id="leavedisabledTip"><div class="leave-disabled-scroll">'+(t.disableTips||"服务不可用")+"</div></div>").show(),d.default.publish("__setTitle","");var n=window.innerHeight||document.body.clientHeight;.8*n<$(".leave-disabled-tip").height()+90&&($("#leaveDisabled").css({height:.8*n-90+"px"}),$(".leave-disabled-tip").css({height:.8*n-90+"px",position:"relative",overflow:"hidden"}),s.default.leaveDisabledScroll||(s.default.leaveDisabledScroll=s.default.initScroll("leaveDisabledScroll","leavedisabledTip")),setTimeout((function(){s.default.leaveDisabledScroll.refresh()}),600))}}))}};t.default=b}});